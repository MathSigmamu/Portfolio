YUI.add("tictac-att-filter",function(a){"use strict";function b(){return f()?!0:!1}function c(a,b,d){switch(a){case"xlsx":case"excel":case"msexcel":case"x-dos_ms_excel":case"x-excel":case"x-ms-excel":case"x-msexcel":case"x-xls":case"vnd.ms-excel":case"vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"vnd.openxmlformats-officedocument.spreadsheetml.template":case"vnd.ms-excel.sheet.macroEnabled.12":case"vnd.ms-excel.template.macroEnabled.12":return"xls";case"pptx":case"vnd.ms-powerpoint":case"vnd.openxmlformats-officedocument.presentationml.presentation":case"vnd.openxmlformats-officedocument.presentationml.template":case"vnd.openxmlformats-officedocument.presentationml.slideshow":return"ppt";case"docx":case"dot":case"microsoft_word":case"mswor2c sc2":case"msword":case"rtf":case"vnd.framemaker":case"vnd.ms-word":case"vnd.msword":case"winword":case"word":case"x-dot":case"x-fm":case"x-framemaker":case"x-maker":case"x-msw6":case"x-msword":case"x-rtf":case"x-soffice":case"text/richtext":case"text/rtf":case"text/vnd.graphviz":case"zz-winassoc-dot":case"vnd.openxmlformats-officedocument.wordprocessingml.document":case"vnd.ms-word.document.macroEnabled.12":case"text/plain":case"application/text":case"rfc822":case"plain":case"text":return"doc";case"x-zip-compressed":case"x-compressed":case"zip":return"zip";case"pdf":case"acrobat":case"x-pdf":case"vnd.pdf":case"text/pdf":case"text/x-pdf":return"pdf";default:return d?b?b:"file":c(b,b,!0)}return"file"}function d(a,b){var d,e=a.split(".");return e.length>1&&(d=e[e.length-1]),c(b,d)}function e(b){var c,d={zip:["thumbnail-fileicon-zip","icon-compressed"],pdf:["thumbnail-fileicon-pdf","icon-pdf"],ppt:["thumbnail-fileicon-ppt","icon-ppt"],doc:["thumbnail-fileicon-doc","icon-doc"],xls:["thumbnail-fileicon-xls","icon-spreadsheet"],mp3:["thumbnail-fileicon-mp3","icon-music","disable-preview"],attachment:["thumbnail-fileicon-attachment","icon-attachment-big","disable-preview"]};return a.common.Utils.features.enabled("zipPreviewr")||d.zip.push("disable-preview"),c=d[b]||d.attachment,c.push("icon","thumbnail-attach-icon","thumbnail-file-icon"),c.join(" ")}function f(){return a.UA.chrome>=15||a.UA.gecko>=6||a.UA.safari>0||a.UA.ie>=9}var g=10240,h={};b()&&(h=a.Array.hash(["pdf","xls","doc","ppt"])),a.namespace("Tictac.att").filter={map:c,getFileTypeIcon:e,attachment:function(b,c){var e=this,f={},g=3e3,i=3e3;if(e.filter(b)){if(f.disposition=b.disposition,f.size=b.size,f.filename=b.filename,f.pid=b.partId,f.type=b.type,f.tnefId=b.tnefId,f.downloadable=!0,f.documentId=b.documentId,f.getAttachmentUrl=b.downloadUrl,f.getAttachmentUrlV3=b.downloadUrlV3||b.downloadUrl,f.textExtractionUrl=b.textExtractionUrl,f.mimetype=b.type+"/"+b.subtype,a.Tictac.base.utils.getVal(a,"Tictac.dropbox")&&(f.shareable=!0),f.filetype=d(b.filename,b.subtype),b.hasOwnProperty("thumbnailurl")&&null!==b.thumbnailurl?(f.thumbnail=b.thumbnailurl,f.fullsize=f.thumbnail+"&w="+g+"&h="+i,f.viewable=!0):a.common.Utils.features.enabled("docPreview")&&(f.viewable=!0,f.isDoc=!0),f.filetype in h&&(f.viewable=!0,f.isDoc=!0),c)for(var j in c)c.hasOwnProperty(j)&&(f[j]=c[j]);return f}},attachments:function(b,c){var d,e=this,f=[];return a.each(b,function(a){d=e.attachment(a,c),d&&f.push(d)}),f},isInlineImage:function(a){var b="inline"===a.disposition||!!a.referencedInline,c="image"===a.type;return b&&c},filter:function(a){return a.disposition="image"===a.type&&a.referencedInline===!0?"inline":a.disposition,"image"!==a.type||"image"===a.type&&a.referencedInline===!0&&a.size>=g||"image"===a.type&&!a.referencedInline?a:void 0}}},"1.0.0",{requires:["cookie","mail-common-utils-features"]});YUI.add("tictac-attach-stats",function(a){"use strict";function b(a,b){a=a.toLowerCase(),b&&b.message&&(b.message=b.message.toLowerCase()),window.console&&window.console.log,f.stat(a,b)}var c={html5_tt_onfileselect:13,html5_tt_attachment_uploadcancelled:14,html5_tt_credentialsetfailedcallback:15,html5_tt_credentialsetsuccessful:16,html5_tt_credentialsetsuccessful_retry:17,html5_tt_credentialsetfailed:18,html5_tt_failure_uploaderror_io:19,html5_tt_no_cred:20,html5_tt_retry:21,html5_tt_success:22,html5_tt_failure:23,form_tt_onfileselect:24,form_tt_attachment_uploadcancelled:25,form_tt_attachuploadiframeerror:26,form_tt_abandon:27,form_tt_server_response:28,controller_uploaderror:29,view_upload_success:30,view_upload_failure:31,html_tt_credfetchsuccessdata:32,controller_uploadretrysuccess:33,toggleformactivated:34,download_error_json:35,download_error_general:36,download_success_error:37,download_success_errors:38,download_success_nourl:39,download_success_success:40,download_success_warning:41,download_success:42,controller_db_upload_start:43,controller_db_upload_success:44,controller_db_upload_failure:45,html5_tt_db_upload_try_failure:46,dropbox_saveto:56,enhancr_autolink_count:94,enhancr_card_added:95,enhancr_card_removed:96,enhancr_card_call_success:97,enhancr_card_call_fail:98,enhancr_fwd_or_reply:99,enhancr_promo_facebook:100,enhancr_promo_twitter:101,enhancr_promo_close_dialog:102,enhancr_promo_try_it:103,enhancr_monetizr_afid_exist:104,enhancr_monetizr_add_afid:105,enhancr_monetizr_domain_not_supported:106,enhancr_mrs_image_load:107,enhancr_mrs_image_load_fail:108},d={action:17,bucket:28,message:20,count:29,size:30},e={name:"attach",appId:"1000934436956",isSampled:0===Math.floor(100*Math.random()+0),actionEnums:c,customFieldEnums:d},f=new a.Tictac.base.Ywa(e);a.namespace("Tictac.attach").Stats={makeStatConf:function(){return{stat:b}}},a.namespace("Tictac.attach.Stats").stat=b,a.namespace("tictac.attach.Stats").stat=b},"1.0.0",{requires:["tictac-base-ywa"]});YUI.add("tictac-attach-utils",function(a){"use strict";var b=a.Array.hash(["uploadFileSizeError","uploadNoFileError","uploadAVCannotClean","uploadAVHasVirus","uploadInternalError","uploadMailboxError","uploadPartialFileError","uploadAuthError"]),c=a.Array.hash(["uploadAVInternalError","uploadAVError","uploadAVServerDown","uploadAVCleaned"]),d=a.Array.hash(["uploadAVNoVirus","uploadAVNotScannable"]),e=a.merge(b,d);a.namespace("Tictac.attach").Utils={configure:function(b,c){var d=!0;return a.each(c,function(c,e){a.Object.owns(b,e)||(d=!1,a.log("Invalid conf key: "+e))}),d?(a.mix(b,c,!0),!0):!1},trackClick:function(b,c){var d={action:b};c&&(d.append=c),a.fire("mt:click",d)},isSvrResponseRecognized:function(a){return!!e[a]},isSvrResponseWarning:function(a){return!!c[a]},isSvrResponseSuccess:function(a){return!!d[a]}},a.namespace("tictac.attach").Utils=a.Tictac.attach.Utils},"2.0",{requires:["node","json"]});YUI.add("tictac-attach-enhancr-autolink",function(a){"use strict";function b(){return window.getSelection().getRangeAt(0)}function c(a){switch(a.get("nodeType")){case Node.PROCESSING_INSTRUCTION_NODE:case Node.DOCUMENT_TYPE_NODE:return 0;case Node.TEXT_NODE:case Node.COMMENT_NODE:return a.get("length");default:return a.get("childNodes").size()}}function d(a){var b=a.get?a.get("nodeType"):a.nodeType;return b===Node.TEXT_NODE}function e(a,b){var d;return 0===c(a)||a.get("childNodes").isEmpty()?null:null!==(d=a.get("childNodes").item(b))?d:null!==(d=a.get("childNodes").item(b-1))?d:null}function f(a,b){var c=b(a,"a",!0);return c?c:!d(a)&&(c=a.one("a"))?c:null}function g(b,c,d,e){var f=document.createRange(),g=e;return f.setStart(b.getDOMNode(),c),f.setEnd(b.getDOMNode(),d),window.getSelection().removeAllRanges(),window.getSelection().addRange(f),0!==e.indexOf("http")&&(e="http://"+e),e=e.replace('"',"%22").replace("'","%27"),a.UA.ie&&a.UA.ie<11||a.UA.gecko?(f.deleteContents(),f.insertNode(a.Node.create('<a href="'+e+'">'+g+"</a>").getDOMNode())):document.execCommand("createlink",!1,e),f}function h(b,c){var f,g=a.Node(b.endContainer);return f=b.endOffset-1,a.UA.gecko&&(f=b.endOffset),g=e(g,f)||g,!a.UA.ie&&d(g)&&(g=g.previous()),c(g,"a",!0)}function i(i,m,n){function o(a,b,c){return a.ancestor(b,!!c,function(a){return a===n})}var p,q,r,s,t,u,v,w,x,y=b(),z=function(b){for(;b&&""===a.Lang.trim(b.get("text"));)b=b.get("previousSibling"),b&&d(b)&&(m=c(b));return b},A=function(b){var c=[",","?",";","!","."];return-1!==a.Array.indexOf(c,b)};if(null!==(q=e(i,m))&&(i=q,m=0),i=z(i)||i,p=f(i,o))return d(i)&&(y.endOffset===y.endContainer.length?(y.setStartAfter(p.getDOMNode()),y.collapse(!0),window.getSelection().addRange(y)):y.collapsed&&y.startOffset<1&&y.endOffset<1&&(y.setStartBefore(p.getDOMNode()),window.getSelection().addRange(y))),p;if(!d(i))return null;if(r=/[^\s]+[\s]*$/.exec(i.substringData(0,m)),!r)return null;if(s=r.index,t=r[0],u=l.test(t)?l.source:"^www\\."+k.source,!new RegExp(u,"i").test(t))return null;for(;!new RegExp(u+"$","i").test(i.substringData(s,m-s));)m--;for(v=i.substringData(s,m-s),w=v.length-1;w>=0&&A(v.charAt(w));)w--,m--;return v=w!==v.length-1?v.substring(0,w+1):v,x=g(i,s,m,v),a.Tictac.attach.Stats.stat("enhancr_autolink_count"),a.Tictac.attach.Utils.trackClick("enhancr_autolink_count"),p=h(x,o),j(p),p}function j(a){var b=document.createRange();b.setStartAfter(a.getDOMNode()),b.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(b)}var k=/([a-z0-9-]+\.)+([a-z]{2,4})(\/+[a-z0-9_.\:\;@-]*)*(\?[\&\%\|\+a-z0-9_=,\.\:\;-]*)?([\&\%\|\+&a-z0-9_=,\:\;\.-]*)([\!\#\/\&\%\|\+a-z0-9_=,\:\;\.-]*)}*/,l=/^(https?\:\/\/)[^\s]+/;a.Node.DOM_EVENTS.paste=1,a.Node.DOM_EVENTS.key.eventDef.KEY_MAP.space=32,a.Node.DOM_EVENTS.key.eventDef.KEY_MAP.enter=13,a.Node.prototype.substringData=function(){var a=this.getDOMNode();return a.substringData.apply(a,arguments)};var m=function(){this.triggers=this.constructor.TRIGGERS,m.superclass.constructor.apply(this,arguments)};a.extend(m,a.Plugin.Base,{_linkify:function(c){var d,e=b();this.get("linkingEnabled")&&(d=i(a.Node(e.startContainer),e.startOffset,this.container),d&&this._onLinkDetected(d,c))},_onKey:function(a){var b=this.triggers,c=13===a.keyCode?b.ENTER:b.SPACE;this._linkify(c)},_onPaste:function(){function b(){c._linkify(c.triggers.PASTE)}var c=this;c.pasteTimer=a.later(0,this,b)},_onLinkDetected:function(b,c){a.later(15,this,function(){this.editor.fire("link",{node:b,trigger:c})})},_afterEditorReady:function(){var b=this.listeners;this.editor=this.get("host"),this.container=this.editor.frame.get("container"),this.editor.publish("link",{emitFacade:!0}),this.editor.getInstance().EditorSelection.CURSOR='<br class="yui-cursor">',a.UA.ie>=9&&document.execCommand("AutoUrlDetect",!1,!1),b.push(this.container.on("key",a.bind(this._onKey,this),"press:space,enter")),b.push(this.container.on("paste",a.bind(this._onPaste,this)))},initializer:function(){var b=this,c=b.get("host");return b.listeners=[],c.get("isReady")?void b._afterEditorReady():void b.listeners.push(c.after("ready",a.bind(function(){b._afterEditorReady()})))},destructor:function(){var b=this;a.each(b.listeners,function(a){a.detach()}),b.pasteTimer&&b.pasteTimer.cancel()}},{NAME:"autolink",NS:"autolink",ATTRS:{host:{value:!1},linkingEnabled:{value:!0,validator:function(b){return a.Lang.isBoolean(b)}}}}),a.namespace("Tictac.attach.enhancr").AutolinkPlugin=m,m.TRIGGERS={PASTE:"paste",ENTER:"enter",SPACE:"space"}},"1.0.0",{requires:["tictac-attach-stats","tictac-attach-utils","base","plugin","event-custom","event-key","node-base"]});YUI.add("tictac-attach-enhancr-net",function(a){"use strict";function b(b,c){var d,g="/ws/comms/hlfs/",h=-1!==window.location.href.indexOf("enhancrbeta");h&&(g=g.replace(/hlfs/,"hlfs-beta")),d=[g,"?url="+encodeURIComponent(b),"&docproc=linkinfo","&proxyType=http","&clientid=mailc","&wssid="+a.common.net.SessionMgr.getWssid()].join(""),a.Tictac.base.BatchTransport.send({requests:[{id:"GetLinkInfo",uri:d,method:"GET",filters:{select:{imageURL:"$..image.url"}},suppressResponse:!1,requests:[{id:"GetSecureLink",uri:"/ws/v3/pac/url?wssid="+a.common.net.SessionMgr.getWssid(),method:"POST",payload:{urls:["$(imageURL)"]}}]}]},{success:function(a,b,d){var g=e(d,"GetLinkInfo.body.urldomain"),h=e(d,"GetLinkInfo.body.docproc"),i=e(h,"linkinfo"),j=e(i,"image.url"),k=e(d,"GetSecureLink.body.urls");i?(j&&k&&k[j]&&(i.image.url=k[j]),c.success(i,g)):(f("Did not receive a linkinfo object."),c.fail())},fail:function(){c.fail()}},{"HLFS_HeaderLine.Accept-Language":NeoConfig.lang||"en-US","HLFS_HeaderLine.LLF-Cache-Control":"max-stale=-1"})}function c(b,c,d){c=c||{};var e="/neo/linkEnhancr",g=[e,"?href="+encodeURIComponent(b),"&thumb="+c.thumbWidth+"x"+c.thumbHeight,"&wssid="+a.common.net.SessionMgr.getWssid()].join("");a.io(g,{method:"GET",on:{success:function(b,c){c=c||{};var e,g,h={};try{e=a.JSON.parse(c.response),g=e.urldomain,e&&e.linkinfo&&(h=e.linkinfo)}catch(i){e={},f("Could not parse JSON response from linkEnhancr")}d.success&&d.success(h,g)},failure:function(){d.fail&&d.fail()}}})}var d=a.Tictac.base.utils,e=d.getVal,f=d.log;a.namespace("Tictac.attach.enhancr").Net={getLinkEnhancements:b,getLinkEnhancements2:c}},"1.0.0",{requires:["common-net-sessionmgr","tictac-base-utils","tictac-base-mail-io","tictac-base-batch-transport"]});YUI.add("tictac-attach-rollups",function(a){a.namespace("Tictac.attach.rollups"),a.Tictac.attach.rollups.link_enhancr_onboarding_small_card=a.Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div style="width:450px; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" contenteditable="false" id="enhancrCard_0" class="link-enhancr-attachment link-enhancr-element"><table class="link-enhancr-element" cellspacing="0" cellpadding="0" style="width:450px; height:60px; position: relative; margin-top:5px; margin-bottom: 5px; display: block;" id="yui_3_13_0_ym1_1_1394599549111_3009"><tbody id="yui_3_13_0_ym1_1_1394599549111_3008"><tr class="link-enhancr-element"><td colspan="6" class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr><tr class="link-enhancr-element" id="yui_3_13_0_ym1_1_1394599549111_3007"><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" rowspan="2" style="vertical-align: middle; width: 58px; height: 58px; background-color: #000000;" id="yui_3_13_0_ym1_1_1394599549111_3020"><div class="link-enhancr-element" style="width: 58px;" align="center"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;"><img alt="image" src="http://l.yimg.com/bt/api/res/1.2/XzqRo0dnWcSFxFBuUh16Vw--/YXBwaWQ9eW5ld3M7cT04NTt3PTYwMA--/http://media.zenfs.com/en-US/blogs/compass/dhow.jpg" class="link-enhancr-thumbnail-image link-enhancr-element" width="58" height="35" style="display: block; margin: auto;"></a></div></td><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;" id="yui_3_13_0_ym1_1_1394599549111_3019"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" colspan="2" style="width: 100%; vertical-align: middle; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" id="yui_3_13_0_ym1_1_1394599549111_3006"><div class="link-enhancr-text-part link-enhancr-element" style="line-height:16.5px; background-color: #ffffff; height: 34px; width: 389px;" id="yui_3_13_0_ym1_1_1394599549111_3005"><div class="link-enhancr-element" style="word-wrap: break-word; padding: 5px 20px 0px 9px;" id="yui_3_13_0_ym1_1_1394599549111_3004"><span class="link-enhancr-element icon  icon-expand link-enhancr-toggle link-enhancr-toggle-onboarding" id="yui_3_13_0_ym1_1_1394599549111_3003"></span><span class="link-enhancr-element icon icon-close link-enhancr-delete"></span><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;" id="yui_3_13_0_ym1_1_1394599549111_3018"><span class="link-enhancr-element link-enhancr-card-title" style="margin: 0; font-weight: normal;font-size: 13px; line-height: 18px; max-height: 19px; color: #000000; overflow: hidden !important; display: inline-block;" id="yui_3_13_0_ym1_1_1394599549111_3017">Echoes of Sinbad the sailor: Flickr photo of the day</span></a><div style="font-size: 11px; line-height: 15px; color: #999999; max-height: 16px; margin-top: -2px; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';overflow: hidden;" class="link-enhancr-card-description link-enhancr-element" id="yui_3_13_0_ym1_1_1394599549111_3010">Since ancient times, Arab merchant dhows, carrying dates and fish, ha...</div></div></div></td><td class="link-enhancr-element" rowspan="2" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td></tr><tr id="yui_3_13_0_ym1_1_1394599549111_3014"><td class="link-enhancr-element" style="width: 100%; vertical-align: middle; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';" id="yui_3_13_0_ym1_1_1394599549111_3016"><div class="link-enhancr-element" style="padding: 1px 20px 1px 10px;" id="yui_3_13_0_ym1_1_1394599549111_3015"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-url link-enhancr-element" style="color: black; text-decoration: none !important;cursor:pointer !important;" target="_blank"><span class="link-enhancr-element link-enhancr-view-on" style="display: inline-block; line-height: 11px; max-width: 289px; min-width: 229px; overflow: hidden; max-height: 13px; word-break: break-all;" id="yui_3_13_0_ym1_1_1394599549111_3002"><span class="link-enhancr-element link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">View on <span style="font-weight: bold">travel.yahoo.com</span></span></span></a></div></td><td class="link-enhancr-element" style="vertical-align: middle; width: 100px; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';" id="yui_3_13_0_ym1_1_1394599549111_3013"><div class="link-enhancr-element link-enhancr-preview-wrapper" style="padding: 2px 20px 4px 0px;; max-width: 100px; min-width: 80px; overflow: hidden; text-align: right; line-height: 11px; max-height: 13px;" id="yui_3_13_0_ym1_1_1394599549111_3012"><span class="link-enhancr-element link-enhancr-preview-by link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;" id="yui_3_13_0_ym1_1_1394599549111_3011">Preview by Yahoo</span></div></td></tr><tr class="link-enhancr-element"><td class="link-enhancr-element" colspan="6" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr></tbody></table></div>'}),a.Tictac.attach.rollups.dragdrop=a.Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+="<div id='uploader-droparea' class='tictac-attach-droparea'><div>",(f=c.drag_here)?f=f.call(b,{hash:{},data:e}):(f=b.drag_here,f=typeof f===h?f.apply(b):f),g+=i(f)+"</div></div>"}),a.Tictac.attach.rollups.link_enhancr_onboarding_big_card=a.Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div style="width:450px; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" contenteditable="false" id="enhancrCard_0" class="link-enhancr-attachment link-enhancr-element link-enhancr-onboarding-big-card"><table class="link-enhancr-element" cellspacing="0" cellpadding="0" style="width:450px; height:170px; position: relative; margin-top:5px; margin-bottom: 5px; display: block;" id="yui_3_13_0_ym1_1_1394599549111_2978"><tbody id="yui_3_13_0_ym1_1_1394599549111_2977"><tr class="link-enhancr-element"><td colspan="6" class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr><tr class="link-enhancr-element" id="yui_3_13_0_ym1_1_1394599549111_2976"><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" rowspan="2" style="vertical-align: middle; width: 168px; height: 168px; background-color: #000000;"><div class="link-enhancr-element" style="width: 168px;" align="center"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;"><img alt="image" src="http://l.yimg.com/bt/api/res/1.2/XzqRo0dnWcSFxFBuUh16Vw--/YXBwaWQ9eW5ld3M7cT04NTt3PTYwMA--/http://media.zenfs.com/en-US/blogs/compass/dhow.jpg" class="link-enhancr-thumbnail-image link-enhancr-element" width="168" height="102" style="display: block; margin: auto;"></a></div></td><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" colspan="2" style="width: 100%; vertical-align: middle; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" id="yui_3_13_0_ym1_1_1394599549111_2975"><div class="link-enhancr-text-part link-enhancr-element" style="line-height:16.5px; background-color: #ffffff; height: 130px; width: 279px;" id="yui_3_13_0_ym1_1_1394599549111_2974"><div class="link-enhancr-element" style="word-wrap: break-word; padding: 7px 20px 0px 14px;" id="yui_3_13_0_ym1_1_1394599549111_2973"><span class="link-enhancr-element icon  icon-shrink link-enhancr-toggle link-enhancr-toggle-onboarding"></span><span class="link-enhancr-element icon icon-close link-enhancr-delete" id="yui_3_13_0_ym1_1_1394599549111_2972"></span><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;"><span class="link-enhancr-element link-enhancr-card-title" style="margin: 0; font-weight: normal;margin-bottom: 4px; font-size: 18px; line-height: 21px; max-height: 43px; color: #000000; overflow: hidden !important; display: inline-block;">Echoes of Sinbad the sailor: Flickr photo of the day</span></a><div style="font-size: 13px; line-height: 20px; color: #999999; max-height: 81px; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';overflow: hidden;" class="link-enhancr-card-description link-enhancr-element">Since ancient times, Arab merchant dhows, carrying dates and fish, have sailed down the Red Sea to the Indian Ocean (a voyage of over a thousand mile...</div></div></div></td><td class="link-enhancr-element" rowspan="2" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td></tr><tr><td class="link-enhancr-element" style="width: 100%; vertical-align: middle; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';"><div class="link-enhancr-element" style="padding: 7px 20px 9px 15px;"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-url link-enhancr-element" style="color: black; text-decoration: none !important;cursor:pointer !important;" target="_blank"><span class="link-enhancr-element link-enhancr-view-on" style="display: inline-block; line-height: 11px; max-width: 179px; min-width: 119px; overflow: hidden; max-height: 13px; word-break: break-all;" id="yui_3_13_0_ym1_1_1394599549111_2971"><span class="link-enhancr-element link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">View on <span style="font-weight: bold">travel.yahoo.com</span></span></span></a></div></td><td class="link-enhancr-element" style="vertical-align: middle; width: 100px; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';"><div class="link-enhancr-element link-enhancr-preview-wrapper" style="padding: 9px 20px 12px 0px; max-width: 100px; min-width: 80px; overflow: hidden; text-align: right; line-height: 11px; max-height: 13px;"><span class="link-enhancr-element link-enhancr-preview-by link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">Preview by Yahoo</span></div></td></tr><tr class="link-enhancr-element"><td class="link-enhancr-element" colspan="6" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr></tbody></table></div>'}),a.Tictac.attach.rollups.enhanced_card_article=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"richcompose-card"}function g(a,b){var d,e="";return(d=c.cardHeight)?d=d.call(a,{hash:{},data:b}):(d=a.cardHeight,d=typeof d===I?d.apply(a):d),e+=J(d)+"px"}function h(a,b){return"auto"}function i(a,b){return"8"}function j(a,b){return"7"}function k(a,b){var d,e="";return e+='<td class="link-enhancr-element link-enhancr-image-wrap" rowspan="5" style="vertical-align: middle; width: ',(d=c.imageSize)?d=d.call(a,{hash:{},data:b}):(d=a.imageSize,d=typeof d===I?d.apply(a):d),e+=J(d)+"px; height: ",(d=c.imageSize)?d=d.call(a,{hash:{},data:b}):(d=a.imageSize,d=typeof d===I?d.apply(a):d),e+=J(d)+'px; background-color: #000000;border-collapse: collapse;"><div class="link-enhancr-element" style="width: ',(d=c.imageSize)?d=d.call(a,{hash:{},data:b}):(d=a.imageSize,d=typeof d===I?d.apply(a):d),e+=J(d)+'px;" align="center"><a href="',(d=c.cardUrl)?d=d.call(a,{hash:{},data:b}):(d=a.cardUrl,d=typeof d===I?d.apply(a):d),e+=J(d)+'" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important;text-decoration:none; color: #000000 !important;"><img alt="image" src="',(d=c.image)?d=d.call(a,{hash:{},data:b}):(d=a.image,d=typeof d===I?d.apply(a):d),e+=J(d)+'" class="link-enhancr-thumbnail-image link-enhancr-element yahoo-ignore-inline-image" width="',(d=c.imageWidth)?d=d.call(a,{hash:{},data:b}):(d=a.imageWidth,d=typeof d===I?d.apply(a):d),e+=J(d)+'" height="',(d=c.imageHeight)?d=d.call(a,{hash:{},data:b}):(d=a.imageHeight,d=typeof d===I?d.apply(a):d),e+=J(d)+'" style="display: block; margin: auto;"></a></div></td><td rowspan="5" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5; font-size: 1pt;">&nbsp;</div></td>'}function l(a,b){return"14"}function m(a,b){return"9"}function n(a,b){return"6"}function o(a,b){return"5"}function p(a,b){var d,e="";return e+="height: ",(d=c.cardTextPartHeight)?d=d.call(a,{hash:{},data:b}):(d=a.cardTextPartHeight,d=typeof d===I?d.apply(a):d),e+=J(d)+"px;"}function q(a,b){return"icon-shrink"}function r(a,b){return"icon-expand"}function s(a,b){return"18px"}function t(a,b){return"13px"}function u(a,b){return"margin-bottom: 3px; font-size: 18px; line-height: 21px; max-height: 43px;"}function v(a,b){var d,e="";return e+="font-size: 13px; line-height: ",d=c.if.call(a,a.hasImage,{hash:{},inverse:K.program(36,x,b),fn:K.program(34,w,b),data:b}),(d||0===d)&&(e+=d),e+="px; max-height: 19px;"}function w(a,b){return"15"}function x(a,b){return"16"}function y(a,b){var d,e="";return e+='<div style="',d=c.if.call(a,a.useBigCard,{hash:{},inverse:K.program(41,A,b),fn:K.program(39,z,b),data:b}),(d||0===d)&&(e+=d),e+='overflow: hidden;" class="link-enhancr-card-description link-enhancr-element">',(d=c.description)?d=d.call(a,{hash:{},data:b}):(d=a.description,d=typeof d===I?d.apply(a):d),e+=J(d)+"</div>"}function z(a,b){return"font-size: 13px; line-height: 20px; color: #999999; max-height: 81px; font-family: 'Georgia', 'Times', 'Times New Roman', 'serif';"}function A(a,b){var d,e="";return e+="font-size: 11px; line-height: 15px; color: #999999; max-height: 16px; margin-top: ",d=c.if.call(a,a.hasImage,{hash:{},inverse:K.program(44,C,b),fn:K.program(42,B,b),data:b}),(d||0===d)&&(e+=d),e+="; font-family: 'Arial', 'Helvetica Neue', 'Helvetica', 'sans-serif';"}function B(a,b){return"-2px"}function C(a,b){return"1px"}function D(a,b){return"4"}function E(a,b){var d,e="";return e+='<span class="link-enhancr-video-width link-enhancr-element" title="',(d=c.videoWidth)?d=d.call(a,{hash:{},data:b}):(d=a.videoWidth,d=typeof d===I?d.apply(a):d),e+=J(d)+'"></span><span class="link-enhancr-video-height link-enhancr-element" title="',(d=c.videoHeight)?d=d.call(a,{hash:{},data:b}):(d=a.videoHeight,d=typeof d===I?d.apply(a):d),e+=J(d)+'"></span><span class="link-enhancr-video-src link-enhancr-element" title="',(d=c.videoSrc)?d=d.call(a,{hash:{},data:b}):(d=a.videoSrc,d=typeof d===I?d.apply(a):d),e+=J(d)+'"></span>'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var F,G,H="",I="function",J=this.escapeExpression,K=this,L=c.blockHelperMissing;return H+='<div style="width:',(F=c.cardWidth)?F=F.call(b,{hash:{},data:e}):(F=b.cardWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+"px; font-family: 'Georgia', 'Times', 'Times New Roman', 'serif';margin-top:5px; margin-bottom: 5px; background-color: #ffffff;\" contenteditable=\"false\" id=\"",(F=c.cardId)?F=F.call(b,{hash:{},data:e}):(F=b.cardId,F=typeof F===I?F.apply(b):F),H+=J(F)+'" class="link-enhancr-attachment link-enhancr-element ',F=c.if.call(b,b.richcompose,{hash:{},inverse:K.noop,fn:K.program(1,f,e),data:e}),(F||0===F)&&(H+=F),H+='"><table class="link-enhancr-element" cellspacing="0" cellpadding="0" border="0" style="width:',(F=c.cardWidth)?F=F.call(b,{hash:{},data:e}):(F=b.cardWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+"px; height:",F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(5,h,e),fn:K.program(3,g,e),data:e}),(F||0===F)&&(H+=F),H+='; position: relative; display: block;"><tr class="link-enhancr-element" class="link-enhancr-element"><td class="link-enhancr-element" colspan="',F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(9,j,e),fn:K.program(7,i,e),data:e}),(F||0===F)&&(H+=F),H+='"  style="height: 1px; background-color: #e5e5e5; font-size: 1px; border-collapse: collapse;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5; font-size: 1px; line-height:0px;">&nbsp;</div></td></tr><tr class="link-enhancr-element"><td rowspan="5" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5; font-size: 1pt; border-collapse: collapse;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5; font-size: 1pt;">&nbsp;</div></td>',G={hash:{},inverse:K.noop,fn:K.program(11,k,e),data:e},(F=c.hasImage)?F=F.call(b,G):(F=b.hasImage,F=typeof F===I?F.apply(b):F),c.hasImage||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='<td rowspan="5" class="link-enhancr-element" style="width: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(15,m,e),fn:K.program(13,l,e),data:e}),(F||0===F)&&(H+=F),H+='px; background-color: #ffffff; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="width: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(15,m,e),fn:K.program(13,l,e),data:e}),(F||0===F)&&(H+=F),H+="px; background-color: #ffffff; font-size: ",F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(15,m,e),fn:K.program(13,l,e),data:e}),(F||0===F)&&(H+=F),H+='pt;">&nbsp;</div></td><td colspan="2" class="link-enhancr-element" style="height: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(17,n,e),data:e}),(F||0===F)&&(H+=F),H+='px; background-color: #ffffff; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="height: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(17,n,e),data:e}),(F||0===F)&&(H+=F),H+="px; background-color: #ffffff; font-size: ",F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(17,n,e),data:e}),(F||0===F)&&(H+=F),H+='pt;">&nbsp;</div></td><td rowspan="5" class="link-enhancr-element" style="width: 20px; background-color: #ffffff; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="width: 20px; background-color: #ffffff; font-size: 20pt;">&nbsp;</div></td><td class="link-enhancr-element" rowspan="5" width="1" style="width: 1px; background-color: #e5e5e5; font-size: 1pt; border-collapse: collapse;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5; font-size: 1pt;">&nbsp;</div></td></tr><tr><td class="link-enhancr-element" colspan="2" style="width: 100%; vertical-align: middle; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';"><div class="link-enhancr-text-part link-enhancr-element" style="line-height:16.5px; background-color: #ffffff; ',G={hash:{},inverse:K.noop,fn:K.program(21,p,e),data:e},(F=c.hasImage)?F=F.call(b,G):(F=b.hasImage,F=typeof F===I?F.apply(b):F),c.hasImage||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+=" width: ",(F=c.cardTextPartWidth)?F=F.call(b,{hash:{},data:e}):(F=b.cardTextPartWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+'px;"><div class="link-enhancr-element" style="word-wrap: break-word; word-break: break-all;"><span class="link-enhancr-element icon  ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(25,r,e),fn:K.program(23,q,e),data:e}),(F||0===F)&&(H+=F),H+=' link-enhancr-toggle"></span><span class="link-enhancr-element icon icon-close link-enhancr-delete"></span><a href="',(F=c.cardUrl)?F=F.call(b,{hash:{},data:e}):(F=b.cardUrl,F=typeof F===I?F.apply(b):F),H+=J(F)+'" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important;text-decoration:none; color: #000000 !important; line-height: 100%; font-size: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(29,t,e),fn:K.program(27,s,e),data:e}),(F||0===F)&&(H+=F),H+='; display: block;"><span class="link-enhancr-element link-enhancr-card-title" style="margin: 0; font-weight: normal;',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(33,v,e),fn:K.program(31,u,e),data:e}),(F||0===F)&&(H+=F),H+=' color: #000000; overflow: hidden !important; display: inline-block;">',(F=c.title)?F=F.call(b,{hash:{},data:e}):(F=b.title,F=typeof F===I?F.apply(b):F),H+=J(F)+"</span></a>",G={hash:{},inverse:K.noop,fn:K.program(38,y,e),data:e},(F=c.hasDescription)?F=F.call(b,G):(F=b.hasDescription,F=typeof F===I?F.apply(b):F),c.hasDescription||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='</div></div></td></tr><tr><td colspan="2" class="link-enhancr-element" style="height: ',F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(17,n,e),fn:K.program(46,D,e),data:e}),(F||0===F)&&(H+=F),H+='px; background-color: #ffffff; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="height: ',F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(17,n,e),fn:K.program(46,D,e),data:e}),(F||0===F)&&(H+=F),H+="px; background-color: #ffffff; font-size: ",F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(17,n,e),fn:K.program(46,D,e),data:e}),(F||0===F)&&(H+=F),H+='pt;"></div></td></tr><tr><td class="link-enhancr-element" style="vertical-align: middle; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';"><div class="link-enhancr-element" style="font-size: 0pt;"><a href="',(F=c.cardUrl)?F=F.call(b,{hash:{},data:e}):(F=b.cardUrl,F=typeof F===I?F.apply(b):F),H+=J(F)+'" class="link-enhancr-card-url link-enhancr-element" style="color: black; text-decoration: none !important;text-decoration:none;cursor:pointer !important;" target="_blank"><span class="link-enhancr-element link-enhancr-view-on" style="display: inline-block; line-height: 11px; max-width: ',(F=c.cardViewOnMaxWidth)?F=F.call(b,{hash:{},data:e}):(F=b.cardViewOnMaxWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+"px; min-width: ",(F=c.cardViewOnMinWidth)?F=F.call(b,{hash:{},data:e}):(F=b.cardViewOnMinWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+'px; overflow: hidden; max-height: 13px; word-break: break-all;"><span class="link-enhancr-element link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">',(F=c.viewOnMarkup)?F=F.call(b,{hash:{},data:e}):(F=b.viewOnMarkup,F=typeof F===I?F.apply(b):F),(F||0===F)&&(H+=F),H+="</span></span></a>",G={hash:{},inverse:K.noop,fn:K.program(48,E,e),data:e},(F=c.hasVideoData)?F=F.call(b,G):(F=b.hasVideoData,F=typeof F===I?F.apply(b):F),c.hasVideoData||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='</div></td><td class="link-enhancr-element" style="vertical-align: middle; width: ',(F=c.previewByMaxWidth)?F=F.call(b,{hash:{},data:e}):(F=b.previewByMaxWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+"px; font-family: 'Arial', 'Helvetica Neue', 'Helvetica', 'sans-serif';\"><div class=\"link-enhancr-element link-enhancr-preview-wrapper\" style=\"max-width: ",(F=c.previewByMaxWidth)?F=F.call(b,{hash:{},data:e}):(F=b.previewByMaxWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+"px; min-width: ",(F=c.previewByMinWidth)?F=F.call(b,{hash:{},data:e}):(F=b.previewByMinWidth,F=typeof F===I?F.apply(b):F),H+=J(F)+'px; overflow: hidden; text-align: right; line-height: 11px; max-height: 13px; font-size: 0pt;"><span class="link-enhancr-element link-enhancr-preview-by link-enhancr-mobile-no-resize" style="line-height: 11px; vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">',(F=c.previewPart)?F=F.call(b,{hash:{},data:e}):(F=b.previewPart,F=typeof F===I?F.apply(b):F),(F||0===F)&&(H+=F),H+='</span></div></td></tr></tr><tr><td colspan="2" class="link-enhancr-element" style="height: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(15,m,e),data:e}),(F||0===F)&&(H+=F),H+='px; background-color: #ffffff; font-size: 0pt; border-collapse: collapse;"><div class="link-enhancr-element" style="height: ',F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(15,m,e),data:e}),(F||0===F)&&(H+=F),H+="px; background-color: #ffffff; font-size: ",F=c.if.call(b,b.useBigCard,{hash:{},inverse:K.program(19,o,e),fn:K.program(15,m,e),data:e}),(F||0===F)&&(H+=F),H+='pt;"></div></td></tr><tr class="link-enhancr-element" class="link-enhancr-element"><td class="link-enhancr-element" colspan="',F=c.if.call(b,b.hasImage,{hash:{},inverse:K.program(9,j,e),fn:K.program(7,i,e),data:e}),(F||0===F)&&(H+=F),H+='"  style="height: 1px; background-color: #e5e5e5; font-size: 1px; border-collapse: collapse;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5; font-size: 1px; line-height:0px">&nbsp;</div></td></tr></table></div>'}),a.Tictac.attach.rollups.link_enhancr_promo=a.Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'Now, when you share any link to a news story, image or video in Yahoo Mail, you will see a rich link preview appear within the body of your email.<br><br><a _moz_dirty="" href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" id="yui_3_13_0_ym1_1_1392854102955_12003">Echoes of Sinbad the sailor: Flickr photo of the day</a><div style="width:450px; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" contenteditable="false" id="enhancrCard_0" class="link-enhancr-attachment link-enhancr-element link-enhancr-onboarding-big-card"><table class="link-enhancr-element" cellspacing="0" cellpadding="0" style="width:450px; height:170px; position: relative; margin-top:5px; margin-bottom: 5px; display: block;" id="yui_3_13_0_ym1_1_1394599549111_2978"><tbody id="yui_3_13_0_ym1_1_1394599549111_2977"><tr class="link-enhancr-element"><td colspan="6" class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr><tr class="link-enhancr-element" id="yui_3_13_0_ym1_1_1394599549111_2976"><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" rowspan="2" style="vertical-align: middle; width: 168px; height: 168px; background-color: #000000;"><div class="link-enhancr-element" style="width: 168px;" align="center"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;"><img alt="image" src="http://l.yimg.com/bt/api/res/1.2/XzqRo0dnWcSFxFBuUh16Vw--/YXBwaWQ9eW5ld3M7cT04NTt3PTYwMA--/http://media.zenfs.com/en-US/blogs/compass/dhow.jpg" class="link-enhancr-thumbnail-image link-enhancr-element" width="168" height="102" style="display: block; margin: auto;"></a></div></td><td rowspan="2" class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td><td class="link-enhancr-element" colspan="2" style="width: 100%; vertical-align: middle; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';" id="yui_3_13_0_ym1_1_1394599549111_2975"><div class="link-enhancr-text-part link-enhancr-element" style="line-height:16.5px; background-color: #ffffff; height: 130px; width: 279px;" id="yui_3_13_0_ym1_1_1394599549111_2974"><div class="link-enhancr-element" style="word-wrap: break-word; padding: 7px 20px 0px 14px;" id="yui_3_13_0_ym1_1_1394599549111_2973"><span class="link-enhancr-element icon  icon-shrink link-enhancr-toggle link-enhancr-toggle-onboarding"></span><span class="link-enhancr-element icon icon-close link-enhancr-delete" id="yui_3_13_0_ym1_1_1394599549111_2972"></span><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-urlWrapper link-enhancr-element" style="text-decoration: none !important; color: #000000 !important;"><span class="link-enhancr-element link-enhancr-card-title" style="margin: 0; font-weight: normal;margin-bottom: 4px; font-size: 18px; line-height: 21px; max-height: 43px; color: #000000; overflow: hidden !important; display: inline-block;">Echoes of Sinbad the sailor: Flickr photo of the day</span></a><div style="font-size: 13px; line-height: 20px; color: #999999; max-height: 81px; font-family: \'Georgia\', \'Times\', \'Times New Roman\', \'serif\';overflow: hidden;" class="link-enhancr-card-description link-enhancr-element">Since ancient times, Arab merchant dhows, carrying dates and fish, have sailed down the Red Sea to the Indian Ocean (a voyage of over a thousand mile...</div></div></div></td><td class="link-enhancr-element" rowspan="2" style="width: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="width: 1px; background-color: #e5e5e5;"></div></td></tr><tr><td class="link-enhancr-element" style="width: 100%; vertical-align: middle; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';"><div class="link-enhancr-element" style="padding: 7px 20px 9px 15px;"><a href="http://travel.yahoo.com/blogs/compass/echoes-sinbad-sailor-flickr-photo-day-200611534.html" class="link-enhancr-card-url link-enhancr-element" style="color: black; text-decoration: none !important;cursor:pointer !important;" target="_blank"><span class="link-enhancr-element link-enhancr-view-on" style="display: inline-block; line-height: 11px; max-width: 179px; min-width: 119px; overflow: hidden; max-height: 13px; word-break: break-all;" id="yui_3_13_0_ym1_1_1394599549111_2971"><span class="link-enhancr-element link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">View on <span style="font-weight: bold">travel.yahoo.com</span></span></span></a></div></td><td class="link-enhancr-element" style="vertical-align: middle; width: 100px; font-family: \'Arial\', \'Helvetica Neue\', \'Helvetica\', \'sans-serif\';"><div class="link-enhancr-element link-enhancr-preview-wrapper" style="padding: 9px 20px 12px 0px; max-width: 100px; min-width: 80px; overflow: hidden; text-align: right; line-height: 11px; max-height: 13px;"><span class="link-enhancr-element link-enhancr-preview-by link-enhancr-mobile-no-resize" style="vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;">Preview by Yahoo</span></div></td></tr><tr class="link-enhancr-element"><td class="link-enhancr-element" colspan="6" style="height: 1px; background-color: #e5e5e5;"><div class="link-enhancr-element" style="height: 1px; background-color: #e5e5e5;"></div></td></tr></tbody></table></div><div>  <p id="link-enhancr-promo-email-try-pasting">    Try pasting another link to a story or even a video…    <p><span><br class="yui-cursor"></span></p>  </p></div><table><tbody><tr><td style="height:50px">    <span style="color: rgb(128, 128, 128);">      <font size="2">        P.S. Like what you see?  Share this story      </font>    </span>    <div contenteditable="false" style="vertical-align:middle; display:inline-block;">      <a class="enhancr-promo-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fyahoomail.tumblr.com%2Fpost%2F79395405926%2Fbringing-links-to-life-with-link-preview" target="_blank" style="text-decoration: none !important;cursor:pointer !important;">        <img src="https://s.yimg.com/nq/a/img/thm/fb_icon_02202014.png" alt="Share on facebook" width="30">      </a>      <a class="enhancr-promo-twitter" href="https://twitter.com/intent/tweet?text=Bringing%20Links%20to%20Life%20with%20Link%20Preview&url=http%3A%2F%2Fyahoomail.tumblr.com%2Fpost%2F79395405926%2Fbringing-links-to-life-with-link-preview" target="_blank" style="text-decoration: none !important;cursor:pointer !important;">        <img src="https://s.yimg.com/nq/a/img/thm/twitter_icon_02202014.png" alt="Share on twitter" width="30">      </a>    </div></td></tr></tbody></table>';
}),a.Tictac.attach.rollups.enhancr_card_onboarding=a.Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div id="enhancrCardOnboarding" class="convstooltip yui3-tooltips" style="width: 280px;">    <div class="tooltip-arrow-left">        <div class="inner-arrow"></div>    </div>    <div class="modal tooltips-text" style="width: 280px;">        <h2 class="modal-hd">            <span class="tutorial-btn close" title="close" style="top: 15px; right: 15px;"></span>        </h2>        <div class="modal-bd" style="padding-right: 30px;">            <div class="hd" style="line-height: 18px; font-size: 16px; font-weight: bold; color: #400090; margin-bottom: 10px;">                Sharing Links in Yahoo Mail just got better.            </div>            <div class="bd" style="margin-top: 10px; margin-bottom: 10px;">Preview links right within the message.</div>            <img class="ob-img" src="',(f=c.imgUrl)?f=f.call(b,{hash:{},data:e}):(f=b.imgUrl,f=typeof f===h?f.apply(b):f),g+=i(f)+'" width="230" />        </div>        <div class="modal-ft"> <span id="okayModalOverlay" class="btn left right default" data-action="ok"><a href="#">Try it!</a></span>  </div>    <div></div>'}),a.Tictac.attach.rollups.attachment_well=a.Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="attachments-well hidden compose-ignore" contenteditable="false"></div>'})},"1.0.0",{requires:["handlebars-base"]});YUI.add("comms-ui-envelope",function(B){var F=24,M=100,J=1000/F,G="progress-envelope",K=G+"-",C=["01","01","02","03","04","05","06","07","08","09","10","11","11","12","13","14","15","16","17","18","19","20","21","22","22","23","24","25","26","27","28","29","30","31","31","32","33","34","35","36","37","38","39","40","40","41","42","43","44","45","46","47","48","01","01","01","01","01","01"],A=0,H=C.length-1,L=K+C[A],D=F*M,I=0,E;E=function(N){var O=this;O.init();O.envelopeEl=B.Node.create('<div class="'+G+" "+O.prevClass+'"></div>');N.append(O.envelopeEl);};E.prototype={init:function(){var N=this;N.prevClass=L;N.frameIndex=A;N.isAnimating=false;N.framesAnimated=0;},start:function(){var O=this,N;if(O.isAnimating){return;}O.timer=B.later(J,null,function(){O.frameIndex++;if(O.frameIndex>H){O.frameIndex=A;}N=K+C[O.frameIndex];O.envelopeEl.replaceClass(O.prevClass,N);O.prevClass=N;O.framesAnimated++;if(O.framesAnimated%D===0){O.stop();}},{},true);O.isAnimating=true;},stop:function(){var N=this;if(N.timer){N.timer.cancel();N.envelopeEl.replaceClass(N.prevClass,L);N.init();}},destroy:function(){var N=this;N.stop();N.envelopeEl.remove(true);}};B.namespace("comms.ui");B.comms.ui.Envelope=E;B.namespace("mail.ui");B.mail.ui.Envelope=E;},"1.0.0",{requires:["env-indicator_css"]});YUI.add("tictac-attach-enhancr-card",function(a){"use strict";function b(){this.duration=0,this.start=function(){this.startTime=(new Date).getTime()},this.stop=function(){return this.endTime=(new Date).getTime(),this.duration=this.endTime-this.startTime,this.duration}}function c(b,c,d,e){var f,g,h,i=e.aTagNode,j=this;f=b,g="enhancrCard_"+x,x++,j.parentNode=c.cardParentNode,j.evtHandlers=[],j.url=b,j.tmStart=(new Date).getTime(),j.getType=function(){return e.cardType},h=i?i.get("text"):"",r.getVal(a,"Tictac.attach.enhancr.Monetizr.monetizeLink")&&(f=a.Tictac.attach.enhancr.Monetizr.monetizeLink(f)),!c.cardInfo.title||e.cardType!==y.HLFS||e.linkSource&&"link-editor"===e.linkSource||(i.set("text",c.cardInfo.title),r.getVal(a,"Tictac.attach.enhancr.Monetizr.monetizeLink")&&i.setAttribute("href",f)),l({scope:this,cardId:g,url:f,useBigCard:e.useBigCard,managerFn:d,isEnter:e.isEnter,aTagNode:i,cardInfo:c.cardInfo,urlDomain:c.urlDomain,originalLinkText:h})}function d(a,b,c){var d,e={},f=function(b,d,f,i){var k={};d=parseInt(d,10),f=parseInt(f,10),b.originImageWidth=d,b.originImageHeight=f,e=g(b,d,f),k=h(d,f),b.imageWidth=k.imageWidth,b.imageHeight=k.imageHeight,b.imageDetails=(i?"after":"before:")+a.imageWidth+"x"+a.imageHeight,j(b),c(b)},g=function(a){var b,c={};return b=z.CARD_WIDTH-(a.hasImage?(a.useBigCard?z.BIG_CARD_IM_WIDTH:z.SMALL_CARD_IM_WIDTH)+3*z.BORDER_WIDTH:2*z.BORDER_WIDTH)-(a.useBigCard?z.BIG_CARD_TEXT_PART_PADDING.left+z.BIG_CARD_TEXT_PART_PADDING.right:z.SMALL_CARD_TEXT_PART_PADDING.left+z.SMALL_CARD_TEXT_PART_PADDING.right),a.cardTextPartWidth=b,a.cardViewOnMaxWidth=b-z.PREVIEW_BY_MAX_WIDTH,a.cardViewOnMinWidth=a.cardViewOnMaxWidth-z.PREVIEW_BY_PADDING_RIGHT_COMPOSE,c=a.useBigCard?{width:z.BIG_CARD_IM_WIDTH,height:z.BIG_CARD_IM_HEIGHT}:{width:z.SMALL_CARD_IM_WIDTH,height:z.SMALL_CARD_IM_HEIGHT},a.cardTextPartHeight=a.useBigCard?z.BIG_CARD_IM_HEIGHT-z.BIG_CARD_VIEW_ON_PADDING.top-z.BIG_CARD_VIEW_ON_PADDING.bottom-z.BIG_CARD_VIEW_ON_HEIGHT-z.BIG_CARD_TEXT_PART_PADDING.top:z.SMALL_CARD_IM_HEIGHT-z.SMALL_CARD_VIEW_ON_HEIGHT-z.SMALL_CARD_VIEW_ON_PADDING.top-z.SMALL_CARD_VIEW_ON_PADDING.bottom-z.SMALL_CARD_TEXT_PART_PADDING.top,a.imageSize=a.useBigCard?z.BIG_CARD_IM_WIDTH:z.SMALL_CARD_IM_WIDTH,a.cardHeight=a.useBigCard?z.BIG_CARD_IM_PART_HEIGHT:z.SMALL_CARD_IM_PART_HEIGHT,c},h=function(a,b){var c,d;return d=e,a>d.width||b>d.height?(c=Math.max(a/d.width,b/d.height),a=Math.round(a/c),b=Math.round(b/c)):a<d.width&&b<d.height&&(c=Math.min(d.width/a,d.height/b),a=Math.round(a*c),b=Math.round(b*c)),{imageWidth:a,imageHeight:b}};a.imageHeight&&a.imageWidth?f(b,a.imageWidth,a.imageHeight,!1):(d=new Image,d.onload=function(){f(b,d.width,d.height,!0)},d.onerror=function(){b.hasImage=!1,j(b),c(b)},d.onabort=d.onerror,d.src=a.url)}function e(a,b){b=b||{};var c=new Image;c.onload=function(){b.success&&b.success({width:c.width,height:c.height})},c.onerror=function(){b.fail&&b.fail({})},c.onabort=c.onerror,c.src=a}function f(a){var c=new b,d="ORIGINAL_IMAGE:"+a;c.start(),e(a,{success:function(){v("enhancr_mrs_image_load",{count:c.stop(),message:d}),c.stop()},fail:function(){v("enhancr_mrs_image_load_fail",{count:c.stop(),message:d}),c.stop()}})}function g(b,c,e){var f,i,l,m,n,o,p,q,s,u,x,z,B=this,C=t.enhanced_card_article,D=a.merge(b,{richcompose:w.enabled("richcompose")}),E=C(D),F=a.Node.create(E),G=c.removeFn,H=c.insertHTML,I=c.isEnter,J=c.isEnter||B.getType()!==y.HLFS;if(e)B._cardNode.replace(F);else if(v("enhancr_card_added",{count:B.age(),message:D.imageDetails}),B.getType()===y.HLFS)n=c.parentNode,o=c.getLastCardNode(n,c.aTagNode),l=n===o,I&&p||o.next()&&"P"===o.next().get("tagName").toUpperCase()||(m=o.get("id"),f='<p id="'+m+'"><br/></p>',i=a.Node.create(f),o.insert(i,"after")),o.insert(F,"after");else{q=a.Node.create("<div></div>"),q.append(F);var K=F.getAttribute("id");H(q.get("innerHTML"),J),F=a.one("#"+K)}F.all(".link-enhancr-mobile-no-resize").setAttribute("style","vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;"),A&&(z=F.one(".link-enhancr-image-wrap"),z&&(z.addClass("enhancr-image-crop"),z.setStyle("backgroundColor","#ffffff"))),B.deleteHandler=function(b){b.halt(),c.aTagNode&&c.aTagNode.get("text")===D.originTitle&&(c.aTagNode.set("text",c.originalLinkText||D.cardUrl),r.getVal(a,"Tictac.attach.enhancr.Monetizr.monetizeLink")&&c.aTagNode.setAttribute("href",B.url)),G(B)},B._cardNode=F,B.toggleHandler=function(b){var e,f=D;b.halt(),f.useBigCard=!f.useBigCard,f.title=f.originTitle,f.description=f.originDescription,f.viewOnMarkup=a.Tictac.attach.strings.str_enhancr_card_view_on.replace("{{link}}",'<span style="font-weight: bold">'+a.Escape.html(f.originUrlDomain)+"</span>"),f.hasImage?(e={url:f.image,imageWidth:f.originImageWidth,imageHeight:f.originImageHeight},a.each(B.evtHandlers,function(a){a.detach()}),d(e,f,function(a){g.apply(B,[a,c,!0])})):(j(f),g.apply(B,[f,c,!0]))},h(B),u=F.one(".link-enhancr-card-title"),s=F.one(".link-enhancr-card-description"),x=F.one(".link-enhancr-view-on"),u&&k(u,!0),s&&k(s,!0),x&&k(x,!0,x.one(".link-enhancr-view-on-domain"))}function h(b){if(b._cardNode){if(a.each(b.evtHandlers,function(a){a.detach()}),b.toggleHandler){var c=b._cardNode.one(".link-enhancr-toggle");c&&b.evtHandlers.push(c.once("click",b.toggleHandler))}if(b.deleteHandler){var d=b._cardNode.one(".link-enhancr-delete");d&&b.evtHandlers.push(d.once("click",b.deleteHandler))}}}function i(a,b){return a&&a.length>b&&(a=a.substring(0,b),a+="..."),a}function j(a){var b=a.useBigCard?a.hasImage?56:100:a.hasImage?58:67,c=a.useBigCard?a.hasImage?164:281:a.hasImage?79:90,d=a.title,e=a.description;b&&d&&(a.title=i(d,b)),c&&e&&(a.description=i(e,c))}function k(a,b,c){var d,e=!1,f=a.get("clientHeight"),g=c?c:a;if(a.get("scrollHeight")-f>5)for(e=!0,d=g.getContent();a.get("scrollHeight")-f>5&&d.length>0;)d=d.slice(0,-1),g.setHTML(d);e&&b&&(d=d.substring(0,d.length-3)+"...",g.setHTML(d))}function l(b){var c,e,f=b.scope,h=b.cardInfo,i=b.url,k=b.urlDomain?b.urlDomain:"",l=b.cardId,m=h.image,n=h.video,o=h.type,p={parentNode:f.parentNode,removeFn:b.managerFn.remove,getLastCardNode:b.managerFn.getLastCardNode,insertHTML:b.managerFn.insertHTML,isEnter:b.isEnter,aTagNode:b.aTagNode,originalLinkText:b.originalLinkText},q=a.Tictac.attach.strings.str_enhancr_card_view_on.replace("{{link}}",'<span style="font-weight: bold" class="link-enhancr-view-on-domain">'+a.Escape.html(k)+"</span>"),r={previewPart:h.previewPart,cardId:l,title:h.title,originTitle:h.title,cardUrl:i,hasImage:!!m.url,image:m.url,useBigCard:b.useBigCard,hasDescription:!!h.description,description:h.description,originDescription:h.description,cardWidth:z.CARD_WIDTH,cardTableWidth:z.CARD_WIDTH-2*z.BORDER_WIDTH,cardTextPartWidth:z.CARD_WIDTH-2*z.BORDER_WIDTH-(b.useBigCard?z.BIG_CARD_TEXT_PART_PADDING.left+z.BIG_CARD_TEXT_PART_PADDING.right:z.SMALL_CARD_TEXT_PART_PADDING.left+z.SMALL_CARD_TEXT_PART_PADDING.right),originUrlDomain:k,viewOnMarkup:q,hasVideoData:!1,type:o,useImageCard:"image"===o?!0:!1,previewByMaxWidth:z.PREVIEW_BY_MAX_WIDTH,previewByMinWidth:z.PREVIEW_BY_MIN_WIDTH};r.cardViewOnMaxWidth=r.cardTextPartWidth-z.PREVIEW_BY_MAX_WIDTH,r.cardViewOnMinWidth=r.cardViewOnMaxWidth-z.PREVIEW_BY_PADDING_RIGHT_COMPOSE,"video"===o&&n.html&&(c=a.Node.create(n.html),r.videoWidth=c.get("width"),r.videoHeight=c.get("height"),r.videoSrc=c.get("src"),r.hasVideoData=!0),r.hasImage?(e={url:m.url,imageWidth:m.width,imageHeight:m.height},d(e,r,function(a){g.apply(f,[a,p])})):(j(r),g.apply(f,[r,p]))}function m(a){var b=a.type,c=a.image.url;return"image"===b||"video"===b?!!c:"article"===b?c?!(!a.title&&!a.description):!(!a.title||!a.description):!1}function n(a,b){var c;if(a)return c=a.get("className")&&a.get("className").indexOf("link-enhancr-element")>=0?a.ancestor("div.link-enhancr-attachment",!0):a.ancestor(function(a){return"block"===a.getStyle("display")||a.get("id")===b.get("id")},!0),c.get("id")===b.get("id")&&s("Should not get the RTE container. There is a Problem."),c.get("className").indexOf("yahoo_quoted")>=0&&(c=a),c}function o(a,b){var c=a.ancestor(".link-enhancr-attachment",!1,function(a){return a===b});return!!c}function p(a,c,d){function e(a,b){var e=m(a),g=z.BIG_CARD_IM_WIDTH+"x"+z.BIG_CARD_IM_HEIGHT;e&&(A&&a.thumbnails&&a.thumbnails[g]&&(a.originalImage=a.image,a.image=a.thumbnails[g],f(a.thumbnails[g].url)),c({cardInfo:a,urlDomain:b})),v("enhancr_card_call_success",{count:h.stop()}),d(e)}function g(){s("Getting Link Info Failed"),v("enhancr_card_call_fail",{count:h.stop()}),d(!1)}var h=new b;h.start(),A?u.getLinkEnhancements2(a,{thumbWidth:z.BIG_CARD_IM_WIDTH,thumbHeight:z.BIG_CARD_IM_HEIGHT},{success:e,fail:g}):u.getLinkEnhancements(a,{success:e,fail:g})}function q(b){var c=b.hasClass("link-enhancr-onboarding-big-card");c?b.replace(a.Node.create(t.link_enhancr_onboarding_small_card())):b.replace(a.Node.create(t.link_enhancr_onboarding_big_card()))}var r=a.Tictac.base.utils,s=r.log,t=a.Tictac.attach.rollups,u=a.Tictac.attach.enhancr.Net,v=a.Tictac.attach.Stats.stat,w=a.common.Utils.features,x=0,y={DROPBOX:"dropbox",FLICKR:"flickr",HLFS:"platform-card"},z={CARD_WIDTH:450,BIG_CARD_IM_PART_HEIGHT:170,SMALL_CARD_IM_PART_HEIGHT:60,BIG_CARD_IM_WIDTH:168,BIG_CARD_IM_HEIGHT:168,SMALL_CARD_IM_WIDTH:58,SMALL_CARD_IM_HEIGHT:58,BORDER_WIDTH:1,SMALL_CARD_VIEW_ON_HEIGHT:13,BIG_CARD_VIEW_ON_HEIGHT:14,PREVIEW_BY_MAX_WIDTH:100,PREVIEW_BY_MIN_WIDTH:80,PREVIEW_BY_PADDING_RIGHT_COMPOSE:60,BIG_CARD_VIEW_ON_PADDING:{top:4,bottom:9},SMALL_CARD_VIEW_ON_PADDING:{top:4,bottom:5},BIG_CARD_TEXT_PART_PADDING:{top:6,right:20,left:14},SMALL_CARD_TEXT_PART_PADDING:{top:5,right:20,left:9}},A=w.enabled("enhancrImageCrop");a.mix(c.prototype,{deleteCard:function(){var b=this;b._cardNode&&b._cardNode.remove(!0),a.each(b.evtHandlers,function(a){a.detach()})},age:function(){var a=(new Date).getTime()-this.tmStart;return 50*Math.round(a/50)}}),a.augment(c.prototype,a.EventTarget);var B=function(){B.superclass.constructor.apply(this,arguments)};a.extend(B,a.Plugin.Base,{initializer:function(){function b(a,b,d){var e,h={remove:B,getLastCardNode:E,insertHTML:function(a,b){var c=g.rte,d="<p><br></p>",e=c.getPluginByName("rte-caret-plugin");e.restoreCaret(),b&&(a=d+a+d),c.pushButton("insertHtml",a)}};return m++,d.useBigCard=!0,b.cardInfo.previewPart=z,e=new c(a,b,h,d),f.push(e),g.fire("cardAdded"),e}var d,e=this,f=[],g=e.get("host"),i=g.frame.get("container"),j=g.get("toolbarNode"),k=j?j.one("#enhancr-spinner"):null,l=k?new a.comms.ui.Envelope(k):null,m=0,r=[],t=[],u={},w={},x=0,z=a.Tictac.attach.strings.str_enhancr_card_preview_by,A="Yahoo",B=function(b){var c=a.Array.indexOf(f,b);b.deleteCard(),f.splice(c,1),m--,v("enhancr_card_removed")},C=function(){a.each(f,function(a){a._cardNode.ancestor()||B(a)},this)},D=function(a){return u[a]?!1:(u[a]=!0,x++,!0)},E=function(b,c){var d,e=c.ancestor(function(a){return a.get("id")===i.get("id")||a.ancestor()&&"block"===a.ancestor().getStyle("display")},!0),f=null,g=function(b){return a.Lang.trim(b),0!==b.indexOf("http")&&(b="http://"+b),b},h=function(a){var b,c,d,e,h,i=a.all("a");for("A"===a.get("tagName").toUpperCase()&&i.push(a),b=i.size(),c=b-1;c>=0;c--)if(d=i.item(c),e=d.get("id"),h=g(d.getAttribute("href")),u[h]&&u[h][e])return f=u[h][e],!0;return!1},j=function(a){var b=a.previous(function(a){return h(a)});return!b};return j(c)&&e.previous(function(a){return h(a)}),f&&(d=f._cardNode,d&&d.next()&&(b=d.next())),b.get("id")===i.get("id")?c:b},F=function(){var b="div[class*='link-enhancr-attachment'][id*='enhancrCard_']",c=i.all(b);c.size()&&e._set("hadCardsInOriginal",!0),a.each(c,function(b){var c,d="a[class*='link-enhancr-card-urlWrapper']",e=b.one(d),f=b.one("img[class*='link-enhancr-thumbnail-image']"),g=b.one("div[class*='link-enhancr-preview-by']"),h=b.one("span[class*='link-enhancr-card-config']"),i=b.one("a"),j=b.all("span[class*='link-enhancr-mobile-no-resize']");j.setAttribute("style","vertical-align:middle; font-size: 9px; line-height: 11px; color: #999999; -moz-text-size-adjust: none; -ms-text-size-adjust: none; -webkit-text-size-adjust:none; text-size-adjust:none;"),h&&h.get("title")&&(c=a.Tictac.base.utils.parseJSON(h.get("title"))),e&&(e.setAttribute("class","link-enhancr-card-urlWrapper link-enhancr-element"),e.setAttribute("style","text-decoration: none !important; color: #000000 !important;")),f&&f.setAttribute("class","link-enhancr-thumbnail-image link-enhancr-element"),g&&g.setAttribute("class","link-enhancr-preview-by link-enhancr-element"),b.setAttribute("contenteditable",!1),i&&i.setAttribute("contenteditable",!1)})};z=z.replace("{{img}}",A),r.push(g.once("renderComplete",F)),r.push(g.on("nodeChange",function(a){a.changedNode&&a.changedNode.get("id")!==i.get("id")&&(d=a.changedNode)})),r.push(i.on("click",function(a){var b,c=a.target,d=c.get("className"),e=c.ancestor('a[class*="link-enhancr-card-url"]',!0,function(a){return a===i});/\w*link-enhancr-delete\w*/.test(c.get("className"))?(a.halt(),b=c.ancestor('div[class*="link-enhancr-attachment"]',!1,function(a){return a===i}),b&&(b.remove(!0),g.fire("cardAdded"))):/\w*link-enhancr-toggle-onboarding\w*/.test(c.get("className"))?(a.halt(),b=c.ancestor('div[class*="link-enhancr-attachment"]',!1,function(a){return a===i}),b&&q(b)):d.indexOf("link-enhancr-element")>=0&&(!e||e.get("className").indexOf("link-enhancr-card-urlWrapper")>=0)?a.halt():d.indexOf("enhancr-promo-facebook")>=0?v("enhancr_promo_facebook"):d.indexOf("enhancr-promo-twitter")>=0&&v("enhancr_promo_twitter")})),e.loadingSpinner=l,r.push(e.on("destroy",function(){a.each(f,function(a){a.deleteCard()}),f=[],m=0,a.each(t,function(a){a.cancel()}),a.each(r,function(a){a.detach()})})),r.push(g.on("cardify",function(c,d){var e,f={isEnter:!1,aTagNode:null,cardType:d};a.each(c.details[0],function(a){e=a.cardInfo.url,b(e,a,f)})})),r.push(g.on("link",function(c){if(NeoConfig.linkEnhancrEnabled&&!e.get("disabled")){var d,f=c.node,g=n(f,i),h=a.Lang.trim(f.getAttribute("href")),k=c.trigger===a.Tictac.attach.enhancr.AutolinkPlugin.TRIGGERS.ENTER,q=c.linkSource,r=f.get("id")?f.get("id"):f.generateID(),t=j?j.one("#enhancr-spinner"):null,v=j?j.one(".save-draft-msg"):null,z=function(c){if(i&&i.getDOMNode()){var d,e=a.mix(c,{cardParentNode:g});d=b(h,e,{linkSource:q,isEnter:k,aTagNode:f,cardType:y.HLFS}),w[r]=d,u[h]=w}},A=function(a){x>0&&x--,t&&0===x&&(t.addClass("hidden"),l.stop(),v.show()),a||(m--,delete u[h])},B=/^[a-zA-Z0-9]+\:/;C(),B.test(h)&&(d=h.match(B)[0],"http:"!==d&&"https:"!==d)||D(h)&&!o(f,i)&&(t&&t.hasClass("hidden")&&(v.hide(),l.start(),t.removeClass("hidden")),s(h),p(h,z,A))}})),r.push(g.on("loadstate",function(){for(var a=0;a<f.length;a++){var b=f[a];if(b._cardNode){var c=b._cardNode.getAttribute("id"),d=i.one("#"+c);d&&d!==b._cardNode&&(b._cardNode=d,h(b))}}})),e._getCardList=function(){return f}},destructor:function(){this.fire("destroy")},destroySpinner:function(){this.loadingSpinner&&this.loadingSpinner.destroy()}},{NAME:"cards",NS:"cards",ATTRS:{host:{value:!1},hadCardsInOriginal:{readOnly:!0,value:!1,validator:function(b){return a.Lang.isBoolean(b)}},disabled:{value:!1,validator:function(b){return a.Lang.isBoolean(b)},getter:function(){var b=a.Tictac.base.mailpreferences.get("enhancrLinkPreviewEnabled")||"1";return"-1"===b?!0:!1}}}}),a.namespace("Tictac.attach.enhancr").CardPlugin=B,a.namespace("Tictac.attach.enhancr").Card=c,c.Types=y},"1.0.0",{requires:["tictac-attach-enhancr-net","tictac-attach-stats","tictac-base-mailpreferences","tictac-base-utils","array-extras","escape","querystring-stringify-simple","base","tictac-attach-rollups","event-custom","mail-common-utils-features","comms-ui-envelope"]});YUI.add("tictac-attach-neo",function(a){"use strict";function b(){return-1!==NeoConfig.attachmentServer.indexOf("-attach")&&-1===NeoConfig.attachmentServer.indexOf("cnh")&&-1===NeoConfig.attachmentServer.indexOf("cnb")}function c(){var a;return a=b()?"https://":NeoConfig.launch_protocol,a+=NeoConfig.attachmentServer+"/",a+=NeoConfig.isFullSSL&&!NeoConfig.isAttachSSL?window.location.host:[strings.str_cfg_base_intl,".",NeoConfig.farm,".mail.yahoo.","jp"===NeoConfig.intl?"co.jp":"com"].join(""),a+="/ya/upload_with_cred?output=xml"}a.namespace("Tictac.attach").Neo={neoConfig:NeoConfig,makeHTML5UploaderConf:function(){var a={UPLOAD_URL_BASE:c(),LAUNCH_PROTOCOL:location.protocol+"//",uploader:{multipleFiles:!0,simLimit:1}};return a},alert:function(b,c,d){var e=a.ui.Templates,f=a.common.Utils.substitute;a.use("common-ui-dialog-helper","_shared_module_offscreen_bin_modal_btn_ok",function(a){a.common.ui.DialogHelper.custom({hd:b,bd:c,ft:f(e._shared_module_offscreen_bin_modal_btn_ok.base,0,0,0,strings,e)},{ok:{handler:d},cancel:{handler:d}})})},dialog:function(b,c,d){a.use("common-ui-dialog-helper",function(a){a.common.ui.DialogHelper.confirm({hd:b,bd:c},d)})}},a.namespace("tictac.attach").Neo=a.Tictac.attach.Neo},"1.0.0",{requires:[]});YUI.add("tictac-attach-model-attachment",function(a){"use strict";function b(b,d){var h=this,i=["fid","mid","partId","tnef","disposition","displayable"],j=/[\w\W]+\\([^\\]+)$/;h.id=b,e(d.filename,"filename required"),h.rawFilename=(d.filename||"").replace(j,"$1"),h.filename=a.Escape.html(h.rawFilename),h.thumbnail=d.thumbnail||"",h.size=d.size||0,h.mimetype=d.type&&d.subtype?d.type+"/"+d.subtype:"",h.type=d.type||"",h.referencedInline=d.referencedInline||!1,h.diskfilename=d.diskfilename||"",h.uploadState=d.uploadState||"queued",h.hasProgress=!!d.hasProgress,h.retryCount=0,h.uploadStartTime=0,e(c(h.uploadState),"illegal upload state:"+h.uploadState),h.reason=d.reason||"",h.progress=d.progress||0,d.original&&(e(g.keys(d.original).length===i.length,"Attachment original didn't include all members"),f.each(i,function(a){e(g.owns(d.original,a),"Attachment original missing key: "+a)}),h.original=d.original),d.dropbox&&("undefined"==typeof d.dropbox.alf&&(d.dropbox.alf=!1),h.dropbox=d.dropbox)}function c(a){return!!d[a]}var d=a.Array.hash(["queued","started","failed","success"]),e=a.Tictac.base.utils.verify,f=a.Array,g=a.Object;b.prototype={setUploadState:function(a,b){var d=this;b=b||"",e(c(a),"illegal upload state: "+a),d.uploadState=a,d.reason=b},isUploadValid:function(){var a=this;return"success"===a.uploadState},isVirusFree:function(){var a=this;return!("uploadAVCannotClean"===a.reason||"uploadAVHasVirus"===a.reason)},isDropbox:function(){return!!this.dropbox},isUploadDone:function(){var a=this;return"success"===a.uploadState||"failed"===a.uploadState},isInline:function(){return this.isImage()&&(this.referencedInline===!0||"inline"===this.disposition||this.original&&"inline"===this.original.disposition)},setMimeType:function(a){var b,c=this;a=a||"",a.toLowerCase(),b=a.split("/"),c.mimetype=a,c.type=a.split("/")[0]},isImage:function(){return"image"===this.type},updateMid:function(a){var b=this;b.original&&"Draft"===b.original.fid&&(b.original.mid=a)}},a.namespace("Tictac.attach.model"),a.Tictac.attach.model.Attachment=b,a.namespace("tictac.attach.model").Attachment=b},"1.0.0",{requires:["tictac-base-utils","tictac-attach-utils","escape"]});YUI.add("tictac-attach-model-attachments",function(a){"use strict";function b(){var a=this;return a.map={},a.quotaViolation={},a.evts=[a.publish("added"),a.publish("updated"),a.publish("deleted"),a.publish("emptied"),a.publish("failures"),a.publish("quota",{emitFacade:!0}),a.publish("commit")],a}var c=a.Tictac.attach.model.Attachment,d=a.Tictac.base.utils.verify,e=a.Tictac.base.utils.log,f=a.Tictac.attach.Utils.isSvrResponseWarning,g=0,h={MAX_BYTES:26214400,MAX_COUNT:25};b.prototype={cleanup:function(){a.each(this.evts,function(a){a.detachAll()})},checkId:function(a){return this.map.hasOwnProperty(a)},sizeInBytes:function(b){return a.Array.reduce(a.Object.values(this.map),0,function(a,c){return!b&&c.isDropbox()?a:a+c.size})},count:function(b){return b=b||function(a){return!a.isDropbox()},a.Array.reduce(a.Object.values(this.map),0,function(a,c){return a+(b(c)?1:0)})},numFailures:function(){return a.Array.reduce(a.Object.values(this.map),0,function(a,b){return a+("failed"===b.uploadState?1:0)})},numFailuresAndWarnings:function(){return a.Array.reduce(a.Object.values(this.map),0,function(a,b){return a+("failed"===b.uploadState||f(b.reason)?1:0)})},areSendable:function(){return!a.Array.some(a.Object.values(this.map),function(a){return"success"!==a.uploadState})},areAnyUploading:function(){return a.Array.some(a.Object.values(this.map),function(a){return"started"===a.uploadState||"queued"===a.uploadState})},areAnyInfected:function(){return a.Array.some(a.Object.values(this.map),function(a){return!a.isVirusFree()})},areAllWarningOrSuccess:function(){return a.Array.every(a.Object.values(this.map),function(a){return"success"===a.uploadState||f(a.reason)})},areAllUploadsDone:function(){return!a.Array.some(a.Object.values(this.map),function(a){return!a.isUploadDone()})},precheckQuota:function(a,b,c){var d=this,e={};return d.sizeInBytes()+b>h.MAX_BYTES&&(e.size=!0),d.count()+a>h.MAX_COUNT&&(e.count=!0),e.count||e.size?(c||d.fireQuotaViolation(e),!0):!1},willFit:function(a){return!this.precheckQuota(0,a,!0)},add:function(a,b){var d,e,f=this;return g+=1,d="ATT_"+g,e=new c(d,a),f.map[d]=e,f.fire("added",e,b),b||f.fire("commit"),f.checkQuota(),d},get:function(a){var b=this;if(b.checkId(a))return b.map[a];throw["Bad attachment id (",a,"), deleted?"].join("")},getAll:function(b,c){var d=a.Object.values(this.map);return b||(d=a.Array.filter(d,function(a){return!a.isDropbox()})),c&&(d=a.Array.filter(d,function(a){return!a.isInline()})),d.sort(function(a,b){var c=parseInt(a.id.substr(4),10),d=parseInt(b.id.substr(4),10);return c-d})},order:function(b){var c,e=this.getAll();return d(this.checkId(b),"id not valid in order: "+b),a.Array.some(e,function(a,d){return a.id!==b?!1:(c=d,!0)}),c},del:function(a,b){var c=this,d=c.get(a);delete c.map[a],c.fire("deleted",d),b||c.fire("commit"),c.count()||c.fire("emptied"),c.checkQuota(),c.fire("failures",c.numFailuresAndWarnings())},commit:function(){this.fire("commit")},delDownToQuota:function(){var a,b=this,c=b.getAll();for(a=c.length-1;a>=0;a-=1){if(!b.isQuotaViolated())return;b.del(c[a].id)}},isQuotaViolated:function(){var a=this;return a.quotaViolation.size||a.quotaViolation.count},setUploadState:function(a,b){var c,d=this;return d.checkId(a)?(c=d.get(a),c.setUploadState(b.state,b.reason),d.fire("updated",c),b.squelchCommit||d.fire("commit"),d.checkQuota(),void("started"!==b.state&&d.fire("failures",d.numFailuresAndWarnings()))):void e("aborting setUploadState on "+a)},set:function(b,c,e){var f=this,g=f.get(b);d(a.Object.owns(g,c),"Invalid field:"+c),g[c]=e,f.fire("updated",g)},findDropbox:function(b){var c=this,d=null,e=c.getAll(!0);return a.Array.some(e,function(a){return a.isDropbox()&&a.dropbox.link===b.link?(d=a,!0):!1}),d},fireQuotaViolation:function(a){this.fire("quota",{violation:a})},updateMid:function(b){a.each(this.map,function(a){a.updateMid(b)})}},a.mix(b.prototype,{checkQuota:function(){var a=this,b={};a.sizeInBytes()>h.MAX_BYTES&&(b.size=!0),a.count()>h.MAX_COUNT&&(b.count=!0),(a.quotaViolation.size!==b.size||a.quotaViolation.count!==b.count)&&(a.quotaViolation=b,a.fireQuotaViolation(b))}}),a.namespace("Tictac.attach.model").Attachments=b,a.namespace("Tictac.attach.model.Attachments").conf=h,a.namespace("tictac.attach.model").Attachments=b,a.namespace("tictac.attach.model.Attachments").conf=h,a.augment(b,a.EventTarget,!0,null,{prefix:"attachments"})},"1.0.0",{requires:["array-extras","event-custom","tictac-base-utils","tictac-attach-model-attachment","tictac-attach-utils","tictac-att-filter"]});YUI.add("tictac-att-rollups",function(a){a.namespace("Tictac.att.rollups"),a.Tictac.att.rollups.tray=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"hidden"}function g(a,b){return"bidi"}function h(a,b){return"att-collapsed"}function i(a,b){return"att-compose"}function j(a,b){var d,e,g="";return g+='        <li role="presentation" tabindex="0" aria-label="',(d=c.tray_count)?d=d.call(a,{hash:{},data:b}):(d=a.tray_count,d=typeof d===J?d.apply(a):d),g+=K(d)+'" class="tictac-att-header-count ',e={hash:{},inverse:I.noop,fn:I.program(1,f,b),data:b},(d=c.is_single)?d=d.call(a,e):(d=a.is_single,d=typeof d===J?d.apply(a):d),c.is_single||(d=L.call(a,d,e)),(d||0===d)&&(g+=d),g+='">',(d=c.tray_count)?d=d.call(a,{hash:{},data:b}):(d=a.tray_count,d=typeof d===J?d.apply(a):d),g+=K(d)+"</li>        ",e={hash:{},inverse:I.noop,fn:I.program(10,k,b),data:b},(d=c.has_viewable)?d=d.call(a,e):(d=a.has_viewable,d=typeof d===J?d.apply(a):d),c.has_viewable||(d=L.call(a,d,e)),(d||0===d)&&(g+=d),g+="                ",d=c.unless.call(a,a.is_single,{hash:{},inverse:I.noop,fn:I.program(13,m,b),data:b}),(d||0===d)&&(g+=d),g+="    "}function k(a,b){var d,e="";return e+="            ",d=c.unless.call(a,a.is_single,{hash:{},inverse:I.noop,fn:I.program(11,l,b),data:b}),(d||0===d)&&(e+=d),e+="        "}function l(a,b){return'                <li class="tictac-att-header-view"><a href="#" aria-hidden="true" title="Click to view all attachments in slideshow">View all</a></li>            '}function m(a,b){return'            <li class="tictac-att-header-save-comp" role="presentation"><a tabindex="-1" href="#" role="presentation"><span role="button" tabindex="0" aria-label="Download all" class="tictac-att-header-save-message">Download all</span><i tabindex="0" role="menu" aria-label="More saving option" class="icon icon-chevron-down"></i></a></li>        '}function n(a,b){var d,e="";return e+='        <li class="tictac-att-header-count">',(d=c.tray_count)?d=d.call(a,{hash:{},data:b}):(d=a.tray_count,d=typeof d===J?d.apply(a):d),e+=K(d)+'</li>        <li class="tictac-att-header-size" data-hidden="true" data-display="error">',(d=c.tray_size)?d=d.call(a,{hash:{},data:b}):(d=a.tray_size,d=typeof d===J?d.apply(a):d),(d||0===d)&&(e+=d),e+='</li>        <li class="tictac-att-header-remove-all" data-display="error"><a role="button" aria-lable="Remove all" tabindex="0" title="Remove all" href="#">Remove all</a></li>    '}function o(a,b){var d,e,f="";return f+="        ",e={hash:{},inverse:I.noop,fn:I.program(18,p,b),data:b},(d=c.att_thumbnails)?d=d.call(a,e):(d=a.att_thumbnails,d=typeof d===J?d.apply(a):d),c.att_thumbnails||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+="      "}function p(a,b){var d,e,f="";return f+='            <li tabindex="-1" aria-selected="false" role="presentation" class="tictac-att-viewer tictac-att-thumb ',e={hash:{},inverse:I.noop,fn:I.program(19,q,b),data:b},(d=c.has_thumbnail)?d=d.call(a,e):(d=a.has_thumbnail,d=typeof d===J?d.apply(a):d),c.has_thumbnail||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" doc-preview-att ",e={hash:{},inverse:I.noop,fn:I.program(21,r,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_remove)?d=d.call(a,e):(d=a.has_remove,d=typeof d===J?d.apply(a):d),c.has_remove||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_cancel)?d=d.call(a,e):(d=a.has_cancel,d=typeof d===J?d.apply(a):d),c.has_cancel||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===J?d.apply(a):d),f+=K(d)+'" data-type="',(d=c.filetype)?d=d.call(a,{hash:{},data:b}):(d=a.filetype,d=typeof d===J?d.apply(a):d),f+=K(d)+'" title="',(d=c.filename)?d=d.call(a,{hash:{},data:b}):(d=a.filename,d=typeof d===J?d.apply(a):d),f+=K(d)+" (",(d=c.filesize)?d=d.call(a,{hash:{},data:b}):(d=a.filesize,d=typeof d===J?d.apply(a):d),f+=K(d)+')" aria-label="',(d=c.filename)?d=d.call(a,{hash:{},data:b}):(d=a.filename,d=typeof d===J?d.apply(a):d),f+=K(d)+'">    <div class="',(d=c.file_icon_class)?d=d.call(a,{hash:{},data:b}):(d=a.file_icon_class,d=typeof d===J?d.apply(a):d),f+=K(d)+'">        <span class="disable-txt">No<br>preview</span>    </div>    ',e={hash:{},inverse:I.noop,fn:I.program(25,t,b),data:b},(d=c.has_save_options)?d=d.call(a,e):(d=a.has_save_options,d=typeof d===J?d.apply(a):d),c.has_save_options||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+="    ",e={hash:{},inverse:I.noop,fn:I.program(27,u,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='        <div class="tictac-att-hover-remove tictac-att-remove" data-action="remove" role="button" aria-label="Remove selected" tabindex="-1"></div>    <div class="filename">        <span class="basename-cover"><span class="basename">',(d=c.filename_without_extension)?d=d.call(a,{hash:{},data:b}):(d=a.filename_without_extension,d=typeof d===J?d.apply(a):d),f+=K(d)+'</span></span>        <span class="fileextn">',(d=c.file_extension)?d=d.call(a,{hash:{},data:b}):(d=a.file_extension,d=typeof d===J?d.apply(a):d),f+=K(d)+"</span>    </div></li>        "}function q(a,b){return"has-thumb"}function r(a,b){var d;return(d=c.error_class)?d=d.call(a,{hash:{},data:b}):(d=a.error_class,d=typeof d===J?d.apply(a):d),K(d)}function s(a,b){return"att-removable"}function t(a,b){return'    <div class="tictac-att-photo-overlay">            <a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon"><span class="download-txt">Download</span><i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>        </div>    '}function u(a,b){var d,e="";return e+='        <div class="tictac-att-thumb-error-state" title="',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===J?d.apply(a):d),e+=K(d)+'"></div>    '}function v(a,b){var d,e,f="";return f+="        ",e={hash:{},inverse:I.noop,fn:I.program(30,w,b),data:b},(d=c.att_thumbnails)?d=d.call(a,e):(d=a.att_thumbnails,d=typeof d===J?d.apply(a):d),c.att_thumbnails||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+="      "}function w(a,b){var d,e,f="";return f+='            <li tabindex="-1" aria-selected="false" role="presentation" class="tictac-att-viewer tictac-att-thumb ',e={hash:{},inverse:I.noop,fn:I.program(19,q,b),data:b},(d=c.has_thumbnail)?d=d.call(a,e):(d=a.has_thumbnail,d=typeof d===J?d.apply(a):d),c.has_thumbnail||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(21,r,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_remove)?d=d.call(a,e):(d=a.has_remove,d=typeof d===J?d.apply(a):d),c.has_remove||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_cancel)?d=d.call(a,e):(d=a.has_cancel,d=typeof d===J?d.apply(a):d),c.has_cancel||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='" ',e={hash:{},inverse:I.noop,fn:I.program(31,x,b),data:b},(d=c.has_thumbnail)?d=d.call(a,e):(d=a.has_thumbnail,d=typeof d===J?d.apply(a):d),c.has_thumbnail||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=' data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===J?d.apply(a):d),f+=K(d)+'" data-type="',(d=c.filetype)?d=d.call(a,{hash:{},data:b}):(d=a.filetype,d=typeof d===J?d.apply(a):d),f+=K(d)+'" title="',(d=c.filename)?d=d.call(a,{hash:{},data:b}):(d=a.filename,d=typeof d===J?d.apply(a):d),f+=K(d)+" (",(d=c.filesize)?d=d.call(a,{hash:{},data:b}):(d=a.filesize,d=typeof d===J?d.apply(a):d),f+=K(d)+')" aria-label="',(d=c.filename)?d=d.call(a,{hash:{},data:b}):(d=a.filename,d=typeof d===J?d.apply(a):d),f+=K(d)+'">    ',e={hash:{},inverse:I.noop,fn:I.program(33,y,b),data:b},(d=c.has_save_options)?d=d.call(a,e):(d=a.has_save_options,d=typeof d===J?d.apply(a):d),c.has_save_options||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+="    ",e={hash:{},inverse:I.noop,fn:I.program(27,u,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='        <div class="tictac-att-hover-remove tictac-att-remove" data-action="remove" role="button" aria-label="Remove selected" tabindex="-1"></div></li>        '}function x(a,b){return'style="background-image: url(https://s.yimg.com/tq/att/150126155129/img/default-at.png);" '}function y(a,b){return'    <div class="tictac-att-photo-overlay">        <a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon">Download<i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>    </div>    '}function z(a,b){var d,e,f="";return f+='        <li tabindex="-1" role="presentation" class="tictac-att-other ',e={hash:{},inverse:I.noop,fn:I.program(21,r,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_remove)?d=d.call(a,e):(d=a.has_remove,d=typeof d===J?d.apply(a):d),c.has_remove||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+=" ",e={hash:{},inverse:I.noop,fn:I.program(23,s,b),data:b},(d=c.has_cancel)?d=d.call(a,e):(d=a.has_cancel,d=typeof d===J?d.apply(a):d),c.has_cancel||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===J?d.apply(a):d),f+=K(d)+'" data-type="',(d=c.filetype)?d=d.call(a,{hash:{},data:b}):(d=a.filetype,d=typeof d===J?d.apply(a):d),f+=K(d)+'" title="',(d=c.filename)?d=d.call(a,{hash:{},data:b}):(d=a.filename,d=typeof d===J?d.apply(a):d),f+=K(d)+" (",(d=c.filesize)?d=d.call(a,{hash:{},data:b}):(d=a.filesize,d=typeof d===J?d.apply(a):d),f+=K(d)+')">',e={hash:{},inverse:I.noop,fn:I.program(36,A,b),data:b},(d=c.has_error)?d=d.call(a,e):(d=a.has_error,d=typeof d===J?d.apply(a):d),c.has_error||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='<div class="tictac-att-other-filename ',e={hash:{},inverse:I.noop,fn:I.program(38,B,b),data:b},(d=c.has_view)?d=d.call(a,e):(d=a.has_view,d=typeof d===J?d.apply(a):d),c.has_view||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='"><div class="tictac-filename-without-type">',(d=c.filename_without_extension)?d=d.call(a,{hash:{},data:b}):(d=a.filename_without_extension,d=typeof d===J?d.apply(a):d),f+=K(d)+"</div><div>",(d=c.file_extension)?d=d.call(a,{hash:{},data:b}):(d=a.file_extension,d=typeof d===J?d.apply(a):d),f+=K(d)+'</div></div><div class="tictac-att-other-save-btn">    ',e={hash:{},inverse:I.noop,fn:I.program(40,C,b),data:b},(d=c.has_save_options)?d=d.call(a,e):(d=a.has_save_options,d=typeof d===J?d.apply(a):d),c.has_save_options||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),e={hash:{},inverse:I.noop,fn:I.program(42,D,b),data:b},(d=c.has_remove)?d=d.call(a,e):(d=a.has_remove,d=typeof d===J?d.apply(a):d),c.has_remove||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+="    ",e={hash:{},inverse:I.noop,fn:I.program(44,E,b),data:b},(d=c.has_view)?d=d.call(a,e):(d=a.has_view,d=typeof d===J?d.apply(a):d),c.has_view||(d=L.call(a,d,e)),(d||0===d)&&(f+=d),f+='</div><a href="#" role="button" aria-label="Remove selected" tabindex="-1" class="tictac-att-cancel-file-uploading tictac-att-remove hidden" data-action="remove"></a></li>      '}function A(a,b){var d,e="";return e+='<div class="tictac-att-thumb-error-state" title="',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===J?d.apply(a):d),e+=K(d)+'"></div>'}function B(a,b){return"tictac-att-viewer tictac-att-other-view"}function C(a,b){return'<a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon">Download<i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>    '}function D(a,b){return'<a href="#" aria-label="Remove selected" tabindex="-1" class="tictac-att-remove" data-action="remove">Remove</a>'}function E(a,b){return'        <a href="#" tabindex="-1" data-action="view-att" class="tictac-att-viewer" title="Click to view attachment in slideshow" aria-hidden="true">View</a>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var F,G,H="",I=this,J="function",K=this.escapeExpression,L=c.blockHelperMissing;return H+='<div class="tictac-att white ',G={hash:{},inverse:I.program(1,f,e),fn:I.noop,data:e},(F=c.show_tray)?F=F.call(b,G):(F=b.show_tray,F=typeof F===J?F.apply(b):F),c.show_tray||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+=" ",G={hash:{},inverse:I.noop,fn:I.program(3,g,e),data:e},(F=c.isRTL)?F=F.call(b,G):(F=b.isRTL,F=typeof F===J?F.apply(b):F),c.isRTL||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+=" ",G={hash:{},inverse:I.noop,fn:I.program(5,h,e),data:e},(F=c.is_collapsed)?F=F.call(b,G):(F=b.is_collapsed,F=typeof F===J?F.apply(b):F),c.is_collapsed||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+=" ",G={hash:{},inverse:I.noop,fn:I.program(1,f,e),data:e},(F=c.is_hidden)?F=F.call(b,G):(F=b.is_hidden,F=typeof F===J?F.apply(b):F),c.is_hidden||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+=" ",G={hash:{},inverse:I.noop,fn:I.program(7,i,e),data:e},(F=c.is_compose)?F=F.call(b,G):(F=b.is_compose,F=typeof F===J?F.apply(b):F),c.is_compose||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='">  <ul class="tictac-att-header cf" role="presentation">    <li class="tictac-att-header-spinner" role="presentation"></li>    <li class="tictac-att-header-error" role="presentation"></li>    ',G={hash:{},inverse:I.noop,fn:I.program(9,j,e),data:e},(F=c.is_read)?F=F.call(b,G):(F=b.is_read,F=typeof F===J?F.apply(b):F),c.is_read||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+="    ",G={hash:{},inverse:I.noop,fn:I.program(15,n,e),data:e},(F=c.is_compose)?F=F.call(b,G):(F=b.is_compose,F=typeof F===J?F.apply(b):F),c.is_compose||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='  </ul>  <div class="tictac-att-thumb-cover">    <div class="tictac-att-scroll-left"><div></div></div>    <div class="tictac-att-scroll-right"><div></div></div>    <ul class="tictac-att-thumb-flow cf" role="menu">      ',G={hash:{},inverse:I.noop,fn:I.program(17,o,e),data:e},(F=c.hasDocPreview)?F=F.call(b,G):(F=b.hasDocPreview,F=typeof F===J?F.apply(b):F),c.hasDocPreview||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+="      ",G={hash:{},inverse:I.program(29,v,e),fn:I.noop,data:e},(F=c.hasDocPreview)?F=F.call(b,G):(F=b.hasDocPreview,F=typeof F===J?F.apply(b):F),c.hasDocPreview||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+='    </ul>  </div>  <div class="tictac-att-files-cover"><ul class="tictac-att-thumb-flow" role="menu">      ',G={hash:{},inverse:I.noop,fn:I.program(35,z,e),data:e},(F=c.files)?F=F.call(b,G):(F=b.files,F=typeof F===J?F.apply(b):F),c.files||(F=L.call(b,F,G)),(F||0===F)&&(H+=F),H+="    </ul>    </div></div>"}),a.Tictac.att.rollups.attachment=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"has-thumb"}function g(a,b){var d;return(d=c.error_class)?d=d.call(a,{hash:{},data:b}):(d=a.error_class,d=typeof d===o?d.apply(a):d),p(d)}function h(a,b){return"att-removable"}function i(a,b){return'style="background-image: url(https://s.yimg.com/tq/att/150126155129/img/default-at.png);" '}function j(a,b){return'    <div class="tictac-att-photo-overlay">        <a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon">Download<i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>    </div>    '}function k(a,b){var d,e="";return e+='        <div class="tictac-att-thumb-error-state" title="',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===o?d.apply(a):d),e+=p(d)+'"></div>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n="",o="function",p=this.escapeExpression,q=this,r=c.blockHelperMissing;return n+='<li tabindex="-1" aria-selected="false" role="presentation" class="tictac-att-viewer tictac-att-thumb ',m={hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e},(l=c.has_thumbnail)?l=l.call(b,m):(l=b.has_thumbnail,l=typeof l===o?l.apply(b):l),c.has_thumbnail||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+=" ",m={hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e},(l=c.has_error)?l=l.call(b,m):(l=b.has_error,l=typeof l===o?l.apply(b):l),c.has_error||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+=" ",m={hash:{},inverse:q.noop,fn:q.program(5,h,e),data:e},(l=c.has_remove)?l=l.call(b,m):(l=b.has_remove,l=typeof l===o?l.apply(b):l),c.has_remove||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+=" ",m={hash:{},inverse:q.noop,fn:q.program(5,h,e),data:e},(l=c.has_cancel)?l=l.call(b,m):(l=b.has_cancel,l=typeof l===o?l.apply(b):l),c.has_cancel||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+='" ',m={hash:{},inverse:q.noop,fn:q.program(7,i,e),data:e},(l=c.has_thumbnail)?l=l.call(b,m):(l=b.has_thumbnail,l=typeof l===o?l.apply(b):l),c.has_thumbnail||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+=' data-id="',(l=c.aid)?l=l.call(b,{hash:{},data:e}):(l=b.aid,l=typeof l===o?l.apply(b):l),n+=p(l)+'" data-type="',(l=c.filetype)?l=l.call(b,{hash:{},data:e}):(l=b.filetype,l=typeof l===o?l.apply(b):l),n+=p(l)+'" title="',(l=c.filename)?l=l.call(b,{hash:{},data:e}):(l=b.filename,l=typeof l===o?l.apply(b):l),n+=p(l)+" (",(l=c.filesize)?l=l.call(b,{hash:{},data:e}):(l=b.filesize,l=typeof l===o?l.apply(b):l),n+=p(l)+')" aria-label="',(l=c.filename)?l=l.call(b,{hash:{},data:e}):(l=b.filename,l=typeof l===o?l.apply(b):l),n+=p(l)+'">    ',m={hash:{},inverse:q.noop,fn:q.program(9,j,e),data:e},(l=c.has_save_options)?l=l.call(b,m):(l=b.has_save_options,l=typeof l===o?l.apply(b):l),c.has_save_options||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+="    ",m={hash:{},inverse:q.noop,fn:q.program(11,k,e),data:e},(l=c.has_error)?l=l.call(b,m):(l=b.has_error,l=typeof l===o?l.apply(b):l),c.has_error||(l=r.call(b,l,m)),(l||0===l)&&(n+=l),n+='        <div class="tictac-att-hover-remove tictac-att-remove" data-action="remove" role="button" aria-label="Remove selected" tabindex="-1"></div></li>'}),a.Tictac.att.rollups.slideshowmenu=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="download:single">        <a href="#">Save to my computer</a></li>    '}function g(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="dropbox:single">        <a href="#">Save to Dropbox</a></li>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k=this,l="function",m=c.blockHelperMissing;return j+='<ul class="tictac-att-attachment-menu-fileaction">    ',i={hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e},(h=c.save_to_computer)?h=h.call(b,i):(h=b.save_to_computer,h=typeof h===l?h.apply(b):h),c.save_to_computer||(h=m.call(b,h,i)),(h||0===h)&&(j+=h),j+="    ",i={hash:{},inverse:k.noop,fn:k.program(3,g,e),data:e},(h=c.save_to_dropbox)?h=h.call(b,i):(h=b.save_to_dropbox,h=typeof h===l?h.apply(b):h),c.save_to_dropbox||(h=m.call(b,h,i)),(h||0===h)&&(j+=h),j+="</ul>"}),a.Tictac.att.rollups.slideshow=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"bidi"}function g(a,b){return'            <span class="tictac-att-ss-topbar-download tictac-att-ss-download-icon linkSpan" title="Save to">            </span>            <span class="tictac-att-ss-topbar-scanning">Scanning an attachment...</span>            <span class="tictac-att-ss-topbar-error">An error occurred while downloading.</span>            '}function h(a,b){var d,e="";return e+="    ",d=c.if.call(a,a.isDoc,{hash:{},inverse:u.program(8,j,b),fn:u.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e}function i(a,b){var d,e="";return e+='    <li class="tictac-att-ss-document" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===s?d.apply(a):d),e+=t(d)+'" style="">    </li>    '}function j(a,b){var d,e="";return e+='    <li class="tictac-att-ss-image" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===s?d.apply(a):d),e+=t(d)+'" style="">        </span>    </li>    '}function k(a,b){return"hidden"}function l(a,b){return"Next"}function m(a,b){return"Previous"}function n(a,b){return"has-thumb"}function o(a,b){var d,e="";return e+="style=\"background-image: url('",(d=c.thumbnailurl)?d=d.call(a,{hash:{},data:b}):(d=a.thumbnailurl,d=typeof d===s?d.apply(a):d),e+=t(d)+"')\" "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r="",s="function",t=this.escapeExpression,u=this,v=c.blockHelperMissing;return r+=' <div class="tictac-att-slideshow ',q={hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">    <div class="tictac-att-ss-topbar cf">        <div class="tictac-att-ss-topbar-left">            <span class="tictac-att-ss-topbar-filename"></span>                                    ',q={hash:{},inverse:u.program(3,g,e),fn:u.noop,data:e},(p=c.disableDownload)?p=p.call(b,q):(p=b.disableDownload,p=typeof p===s?p.apply(b):p),c.disableDownload||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='            <div class="tictac-att-ss-docview-toolbar">                <span class="tictac-att-ss-docview-zoom-out tictac-att-ss-ctrl-group linkSpan" title="Zoom Out"></span>                <span class="tictac-att-ss-docview-zoom-in linkSpan" title="Zoom In"></span>                <span class="tictac-att-ss-docview-page-prev tictac-att-ss-ctrl-group linkSpan" title="Previous"></span>                <span class="tictac-att-ss-docview-page-current"></span>                <span class="tictac-att-ss-docview-page-next linkSpan" title="Next"></span>            </div>        </div>        <div class="tictac-att-ss-topbar-right">            <span class="tictac-att-ss-close linkSpan" title="Close"></span>        </div>    </div>    <ul class="tictac-att-slideshow-thumbs">        ',q={hash:{},inverse:u.noop,fn:u.program(5,h,e),data:e},(p=c.attachments)?p=p.call(b,q):(p=b.attachments,p=typeof p===s?p.apply(b):p),c.attachments||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='    </ul>    <div class="tictac-att-ss-state">        <span class="tictac-att-ss-state-loading">        </span>        <span class="tictac-att-ss-state-loading-message">',(p=c.message)?p=p.call(b,{hash:{},data:e}):(p=b.message,p=typeof p===s?p.apply(b):p),r+=t(p)+'</span>        <div class="tictac-att-ss-state-error">            <span class="tictac-att-ss-state-error-msg">Sorry, we are unable to display this attachment.</span>            <span class="tictac-att-ss-state-error-retry">Try again.</span>        </div>    </div>    <div class="tictac-att-ss-controls ',q={hash:{},inverse:u.noop,fn:u.program(10,k,e),data:e},(p=c.is_single)?p=p.call(b,q):(p=b.is_single,p=typeof p===s?p.apply(b):p),c.is_single||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">        <span class="tictac-att-ss-controls-prev" title="',q={hash:{},inverse:u.noop,fn:u.program(12,l,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),q={hash:{},inverse:u.program(14,m,e),fn:u.noop,data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">            <span class="tictac-att-ss-controls-prev-icon">                <span></span>            </span>        </span>        <span class="tictac-att-ss-controls-next" title="',q={hash:{},inverse:u.noop,fn:u.program(14,m,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),q={hash:{},inverse:u.program(12,l,e),fn:u.noop,data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">            <span class="tictac-att-ss-controls-next-icon">                <span></span>            </span>        </span>    </div>    <div class="tictac-att-ss-footer ',q={hash:{},inverse:u.noop,fn:u.program(10,k,e),data:e},(p=c.is_hidden)?p=p.call(b,q):(p=b.is_hidden,p=typeof p===s?p.apply(b):p),c.is_hidden||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">        <div class="tictac-att-ss-photo ',q={hash:{},inverse:u.noop,fn:u.program(16,n,e),data:e},(p=c.has_thumbnail)?p=p.call(b,q):(p=b.has_thumbnail,p=typeof p===s?p.apply(b):p),c.has_thumbnail||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='" ',q={hash:{},inverse:u.noop,fn:u.program(18,o,e),data:e},(p=c.has_thumbnail)?p=p.call(b,q):(p=b.has_thumbnail,p=typeof p===s?p.apply(b):p),c.has_thumbnail||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='>        </div>        <div class="tictac-att-ss-from-folder-date">            <div class="tictac-att-ss-from">                <p>',(p=c.fromName)?p=p.call(b,{hash:{},data:e}):(p=b.fromName,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>            <div class="tictac-att-ss-folderdate second-line">                <p>',(p=c.folderDate)?p=p.call(b,{hash:{},data:e}):(p=b.folderDate,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>        </div>        <div class="tictac-att-ss-subject-snippet">            <div class="tictac-att-ss-subject">                <p>',(p=c.subject)?p=p.call(b,{hash:{},data:e}):(p=b.subject,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>            <div class="tictac-att-ss-snippet second-line">                <p>',(p=c.snippet)?p=p.call(b,{hash:{},data:e}):(p=b.snippet,p=typeof p===s?p.apply(b):p),r+=t(p)+"</p>            </div>        </div>    </div></div>"}),a.Tictac.att.rollups.slideshow_infinite=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"bidi"}function g(a,b){return'            <span class="tictac-att-ss-topbar-divider">|</span>            <span class="linkSpan tictac-att-ss-topbar-download-single">                Download            </span>            <span class="tictac-att-ss-topbar-download icon icon-chevron-down" title="Save to">            </span>            <span class="tictac-att-ss-topbar-scanning">Scanning an attachment...</span>            <span class="tictac-att-ss-topbar-error">An error occurred while downloading.</span>            '}function h(a,b){var d,e="";return e+="    ",d=c.if.call(a,a.isDoc,{hash:{},inverse:u.program(8,j,b),fn:u.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e}function i(a,b){var d,e="";return e+='    <li class="tictac-att-ss-document" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===s?d.apply(a):d),e+=t(d)+'" style="">    </li>    '}function j(a,b){var d,e="";return e+='    <li class="tictac-att-ss-image" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===s?d.apply(a):d),e+=t(d)+'" style="">        </span>    </li>    '}function k(a,b){return"hidden"}function l(a,b){return"Next"}function m(a,b){return"Previous"}function n(a,b){return"has-thumb"}function o(a,b){var d,e="";return e+="style=\"background-image: url('",(d=c.thumbnailurl)?d=d.call(a,{hash:{},data:b}):(d=a.thumbnailurl,d=typeof d===s?d.apply(a):d),e+=t(d)+"')\" "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r="",s="function",t=this.escapeExpression,u=this,v=c.blockHelperMissing;return r+=' <div class="tictac-att-slideshow ',q={hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">    <div class="tictac-att-ss-topbar cf">        <div class="tictac-att-ss-topbar-left">            <span class="tictac-att-ss-topbar-filename"></span>                                    ',q={hash:{},inverse:u.program(3,g,e),fn:u.noop,data:e},(p=c.disableDownload)?p=p.call(b,q):(p=b.disableDownload,p=typeof p===s?p.apply(b):p),c.disableDownload||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='            <div class="tictac-att-ss-docview-toolbar">                <span class="tictac-att-ss-docview-zoom-out tictac-att-ss-ctrl-group linkSpan" title="Zoom Out"></span>                <span class="tictac-att-ss-docview-zoom-in linkSpan" title="Zoom In"></span>                <span class="tictac-att-ss-docview-page-current"></span>            </div>        </div>        <div class="tictac-att-ss-topbar-right">            <span class="tictac-att-ss-close linkSpan" title="Close"></span>        </div>    </div>    <ul class="tictac-att-slideshow-thumbs">        ',q={hash:{},inverse:u.noop,fn:u.program(5,h,e),data:e},(p=c.attachments)?p=p.call(b,q):(p=b.attachments,p=typeof p===s?p.apply(b):p),c.attachments||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='    </ul>    <div class="tictac-att-ss-state">        <span class="tictac-att-ss-state-loading">        </span>        <span class="tictac-att-ss-state-loading-message">',(p=c.message)?p=p.call(b,{hash:{},data:e}):(p=b.message,p=typeof p===s?p.apply(b):p),r+=t(p)+'</span>        <div class="tictac-att-ss-state-error">            <span class="tictac-att-ss-state-error-msg">Sorry, we are unable to display this attachment.</span>            <span class="tictac-att-ss-state-error-retry">Try again.</span>        </div>    </div>    <div class="tictac-att-ss-controls ',q={hash:{},inverse:u.noop,fn:u.program(10,k,e),data:e},(p=c.is_single)?p=p.call(b,q):(p=b.is_single,p=typeof p===s?p.apply(b):p),c.is_single||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">        <span class="tictac-att-ss-controls-prev" title="',q={hash:{},inverse:u.noop,fn:u.program(12,l,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),q={hash:{},inverse:u.program(14,m,e),fn:u.noop,data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">            <span class="tictac-att-ss-controls-prev-icon">                <span></span>            </span>        </span>        <span class="tictac-att-ss-controls-next" title="',q={hash:{},inverse:u.noop,fn:u.program(14,m,e),data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),q={hash:{},inverse:u.program(12,l,e),fn:u.noop,data:e},(p=c.isRTL)?p=p.call(b,q):(p=b.isRTL,p=typeof p===s?p.apply(b):p),c.isRTL||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">            <span class="tictac-att-ss-controls-next-icon">                <span></span>            </span>        </span>    </div>    <div class="tictac-att-ss-footer ',q={hash:{},inverse:u.noop,fn:u.program(10,k,e),data:e},(p=c.is_hidden)?p=p.call(b,q):(p=b.is_hidden,p=typeof p===s?p.apply(b):p),c.is_hidden||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='">        <div class="tictac-att-ss-photo ',q={hash:{},inverse:u.noop,fn:u.program(16,n,e),data:e},(p=c.has_thumbnail)?p=p.call(b,q):(p=b.has_thumbnail,p=typeof p===s?p.apply(b):p),c.has_thumbnail||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='" ',q={hash:{},inverse:u.noop,fn:u.program(18,o,e),data:e},(p=c.has_thumbnail)?p=p.call(b,q):(p=b.has_thumbnail,p=typeof p===s?p.apply(b):p),c.has_thumbnail||(p=v.call(b,p,q)),(p||0===p)&&(r+=p),r+='>        </div>        <div class="tictac-att-ss-from-folder-date">            <div class="tictac-att-ss-from">                <p>',(p=c.fromName)?p=p.call(b,{hash:{},data:e}):(p=b.fromName,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>            <div class="tictac-att-ss-folderdate second-line">                <p>',(p=c.folderDate)?p=p.call(b,{hash:{},data:e}):(p=b.folderDate,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>        </div>        <div class="tictac-att-ss-subject-snippet">            <div class="tictac-att-ss-subject">                <p>',(p=c.subject)?p=p.call(b,{hash:{},data:e}):(p=b.subject,p=typeof p===s?p.apply(b):p),r+=t(p)+'</p>            </div>            <div class="tictac-att-ss-snippet second-line">                <p>',
(p=c.snippet)?p=p.call(b,{hash:{},data:e}):(p=b.snippet,p=typeof p===s?p.apply(b):p),r+=t(p)+"</p>            </div>        </div>    </div></div>"}),a.Tictac.att.rollups.error=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return'<a href="#" class="tictac-att-error-dismiss">Dismiss</a>'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<span class="',(g=c.error_class)?g=g.call(b,{hash:{},data:e}):(g=b.error_class,g=typeof g===i?g.apply(b):g),h+=j(g)+'">',(g=c.error_message)?g=g.call(b,{hash:{},data:e}):(g=b.error_message,g=typeof g===i?g.apply(b):g),h+=j(g)+" ",g=c.if.call(b,b.show_dismiss,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+="</span>"}),a.Tictac.att.rollups.docview=a.Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div class="tictac-att-ss-docview-wrapper" style="position: relative; width: 600px; height: 600px; float: left; border: 1px solid #efefef">    <div id="tictac-att-ss-docview-doc-',(f=c.docid)?f=f.call(b,{hash:{},data:e}):(f=b.docid,f=typeof f===h?f.apply(b):f),g+=i(f)+'" style="width: 600px; height: 600px;"></div></div>'}),a.Tictac.att.rollups.slideshowattachment=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="    ",d=c.if.call(a,a.isDoc,{hash:{},inverse:m.program(4,h,b),fn:m.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e}function g(a,b){var d,e="";return e+='    <li class="tictac-att-ss-document" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===k?d.apply(a):d),e+=l(d)+'" style="">    </li>    '}function h(a,b){var d,e="";return e+='    <li class="tictac-att-ss-image" data-id="',(d=c.aid)?d=d.call(a,{hash:{},data:b}):(d=a.aid,d=typeof d===k?d.apply(a):d),e+=l(d)+'" style="">        </span>    </li>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k="function",l=this.escapeExpression,m=this,n=c.blockHelperMissing;return j={hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e},(i=c.attachments)?i=i.call(b,j):(i=b.attachments,i=typeof i===k?i.apply(b):i),c.attachments||(i=n.call(b,i,j)),i||0===i?i:""}),a.Tictac.att.rollups.fileattachment=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d;return(d=c.error_class)?d=d.call(a,{hash:{},data:b}):(d=a.error_class,d=typeof d===p?d.apply(a):d),q(d)}function g(a,b){return"att-removable"}function h(a,b){var d,e="";return e+='<div class="tictac-att-thumb-error-state" title="',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===p?d.apply(a):d),e+=q(d)+'"></div>'}function i(a,b){return"tictac-att-viewer tictac-att-other-view"}function j(a,b){return'<a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon">Download<i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>    '}function k(a,b){return'<a href="#" aria-label="Remove selected" tabindex="-1" class="tictac-att-remove" data-action="remove">Remove</a>'}function l(a,b){return'        <a href="#" tabindex="-1" data-action="view-att" class="tictac-att-viewer" title="Click to view attachment in slideshow" aria-hidden="true">View</a>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o="",p="function",q=this.escapeExpression,r=this,s=c.blockHelperMissing;return o+='<li tabindex="-1" role="presentation" class="tictac-att-other ',n={hash:{},inverse:r.noop,fn:r.program(1,f,e),data:e},(m=c.has_error)?m=m.call(b,n):(m=b.has_error,m=typeof m===p?m.apply(b):m),c.has_error||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+=" ",n={hash:{},inverse:r.noop,fn:r.program(3,g,e),data:e},(m=c.has_remove)?m=m.call(b,n):(m=b.has_remove,m=typeof m===p?m.apply(b):m),c.has_remove||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+=" ",n={hash:{},inverse:r.noop,fn:r.program(3,g,e),data:e},(m=c.has_cancel)?m=m.call(b,n):(m=b.has_cancel,m=typeof m===p?m.apply(b):m),c.has_cancel||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+='" data-id="',(m=c.aid)?m=m.call(b,{hash:{},data:e}):(m=b.aid,m=typeof m===p?m.apply(b):m),o+=q(m)+'" data-type="',(m=c.filetype)?m=m.call(b,{hash:{},data:e}):(m=b.filetype,m=typeof m===p?m.apply(b):m),o+=q(m)+'" title="',(m=c.filename)?m=m.call(b,{hash:{},data:e}):(m=b.filename,m=typeof m===p?m.apply(b):m),o+=q(m)+" (",(m=c.filesize)?m=m.call(b,{hash:{},data:e}):(m=b.filesize,m=typeof m===p?m.apply(b):m),o+=q(m)+')">',n={hash:{},inverse:r.noop,fn:r.program(5,h,e),data:e},(m=c.has_error)?m=m.call(b,n):(m=b.has_error,m=typeof m===p?m.apply(b):m),c.has_error||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+='<div class="tictac-att-other-filename ',n={hash:{},inverse:r.noop,fn:r.program(7,i,e),data:e},(m=c.has_view)?m=m.call(b,n):(m=b.has_view,m=typeof m===p?m.apply(b):m),c.has_view||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+='"><div class="tictac-filename-without-type">',(m=c.filename_without_extension)?m=m.call(b,{hash:{},data:e}):(m=b.filename_without_extension,m=typeof m===p?m.apply(b):m),o+=q(m)+"</div><div>",(m=c.file_extension)?m=m.call(b,{hash:{},data:e}):(m=b.file_extension,m=typeof m===p?m.apply(b):m),o+=q(m)+'</div></div><div class="tictac-att-other-save-btn">    ',n={hash:{},inverse:r.noop,fn:r.program(9,j,e),data:e},(m=c.has_save_options)?m=m.call(b,n):(m=b.has_save_options,m=typeof m===p?m.apply(b):m),c.has_save_options||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),n={hash:{},inverse:r.noop,fn:r.program(11,k,e),data:e},(m=c.has_remove)?m=m.call(b,n):(m=b.has_remove,m=typeof m===p?m.apply(b):m),c.has_remove||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+="    ",n={hash:{},inverse:r.noop,fn:r.program(13,l,e),data:e},(m=c.has_view)?m=m.call(b,n):(m=b.has_view,m=typeof m===p?m.apply(b):m),c.has_view||(m=s.call(b,m,n)),(m||0===m)&&(o+=m),o+='</div><a href="#" role="button" aria-label="Remove selected" tabindex="-1" class="tictac-att-cancel-file-uploading tictac-att-remove hidden" data-action="remove"></a></li>'}),a.Tictac.att.rollups.overlay=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='    <li class="tictac-att-filemeta disabled" data-action="none">      <a href="#">        <span class="',(d=c.error_class)?d=d.call(a,{hash:{},data:b}):(d=a.error_class,d=typeof d===r?d.apply(a):d),e+=s(d)+'">',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===r?d.apply(a):d),e+=s(d)+"</span>      </a>    </li>    "}function g(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="remove"><a href="#">Cancel</a></li>    '}function h(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="view"><a href="#">View</a></li>    '}function i(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="download"><a href="#">Save to my computer</a></li>    '}function j(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="save_dropbox"><a href="#">Save to Dropbox</a></li>    '}function k(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="save_flickr"><a href="#">Save to Flickr</a></li>    '}function l(a,b){var d,e="";return e+='    <li class="tictac-att-attachment-menu-action"        data-action="edit"><a href="#">',(d=c.str_tictac_att_edit_file)?d=d.call(a,{hash:{},data:b}):(d=a.str_tictac_att_edit_file,d=typeof d===r?d.apply(a):d),e+=s(d)+"</a></li>    "}function m(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="remove"><a href="#">Remove</a></li>    '}function n(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="retry"><a href="#">Retry</a></li>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q="",r="function",s=this.escapeExpression,t=this,u=c.blockHelperMissing;return q+='<div class="tictac-att-attachment-menu">  <ul class="tictac-att-attachment-menu-filemeta">    ',p={hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e},(o=c.has_error)?o=o.call(b,p):(o=b.has_error,o=typeof o===r?o.apply(b):o),c.has_error||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+='    <li class="tictac-att-filemeta disabled" data-action="none">      <a href="#">        <span>&lrm;',(o=c.filename)?o=o.call(b,{hash:{},data:e}):(o=b.filename,o=typeof o===r?o.apply(b):o),q+=s(o)+" (",(o=c.filesize)?o=o.call(b,{hash:{},data:e}):(o=b.filesize,o=typeof o===r?o.apply(b):o),(o||0===o)&&(q+=o),q+=')</span>      </a>    </li>  </ul>  <ul class="tictac-att-attachment-menu-fileaction">    ',p={hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e},(o=c.has_cancel)?o=o.call(b,p):(o=b.has_cancel,o=typeof o===r?o.apply(b):o),c.has_cancel||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e},(o=c.has_view)?o=o.call(b,p):(o=b.has_view,o=typeof o===r?o.apply(b):o),c.has_view||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(7,i,e),data:e},(o=c.save_to_computer)?o=o.call(b,p):(o=b.save_to_computer,o=typeof o===r?o.apply(b):o),c.save_to_computer||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(9,j,e),data:e},(o=c.save_to_dropbox)?o=o.call(b,p):(o=b.save_to_dropbox,o=typeof o===r?o.apply(b):o),c.save_to_dropbox||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(11,k,e),data:e},(o=c.save_to_flickr)?o=o.call(b,p):(o=b.save_to_flickr,o=typeof o===r?o.apply(b):o),c.save_to_flickr||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(13,l,e),data:e},(o=c.has_edit)?o=o.call(b,p):(o=b.has_edit,o=typeof o===r?o.apply(b):o),c.has_edit||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(15,m,e),data:e},(o=c.has_remove)?o=o.call(b,p):(o=b.has_remove,o=typeof o===r?o.apply(b):o),c.has_remove||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="    ",p={hash:{},inverse:t.noop,fn:t.program(17,n,e),data:e},(o=c.has_retry)?o=o.call(b,p):(o=b.has_retry,o=typeof o===r?o.apply(b):o),c.has_retry||(o=u.call(b,o,p)),(o||0===o)&&(q+=o),q+="  </ul></div>"}),a.Tictac.att.rollups.downloadmenu=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+="    ",e={hash:{},inverse:s.noop,fn:s.program(2,g,b),data:b},(d=c.save_to_computer)?d=d.call(a,e):(d=a.save_to_computer,d=typeof d===t?d.apply(a):d),c.save_to_computer||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    ",e={hash:{},inverse:s.noop,fn:s.program(4,h,b),data:b},(d=c.save_to_dropbox)?d=d.call(a,e):(d=a.save_to_dropbox,d=typeof d===t?d.apply(a):d),c.save_to_dropbox||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    "}function g(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="download_all"><a href="#">Save all to my computer</a></li>    '}function h(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="save_dropbox_all"><a href="#">Save all to Dropbox</a></li>    '}function i(a,b){var d,e,f="";return f+="    ",e={hash:{},inverse:s.noop,fn:s.program(7,j,b),data:b},(d=c.save_to_computer)?d=d.call(a,e):(d=a.save_to_computer,d=typeof d===t?d.apply(a):d),c.save_to_computer||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    ",e={hash:{},inverse:s.noop,fn:s.program(9,k,b),data:b},(d=c.save_to_dropbox)?d=d.call(a,e):(d=a.save_to_dropbox,d=typeof d===t?d.apply(a):d),c.save_to_dropbox||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    "}function j(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="download"><a href="#">Save to my computer</a></li>    '}function k(a,b){return'    <li class="tictac-att-attachment-menu-action"        data-action="save_dropbox"><a href="#">Save to Dropbox</a></li>    '}function l(a,b){var d,e,f="";return f+="    ",e={hash:{},inverse:s.noop,fn:s.program(12,m,b),data:b},(d=c.menuItems)?d=d.call(a,e):(d=a.menuItems,d=typeof d===t?d.apply(a):d),c.menuItems||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    "}function m(a,b){var d,e="";return e+='    <li class="tictac-att-attachment-menu-action" data-action="',(d=c.actionAll)?d=d.call(a,{hash:{},data:b}):(d=a.actionAll,d=typeof d===t?d.apply(a):d),e+=v(d)+'"><a href="#">',(d=c.strMenuAll)?d=d.call(a,{hash:{},data:b}):(d=a.strMenuAll,d=typeof d===t?d.apply(a):d),e+=v(d)+"</a></li>    "}function n(a,b){var d,e,f="";return f+="    ",e={hash:{},inverse:s.noop,fn:s.program(15,o,b),data:b},(d=c.menuItems)?d=d.call(a,e):(d=a.menuItems,d=typeof d===t?d.apply(a):d),c.menuItems||(d=u.call(a,d,e)),(d||0===d)&&(f+=d),f+="    "}function o(a,b){var d,e="";return e+='    <li class="tictac-att-attachment-menu-action" data-action="',(d=c.action)?d=d.call(a,{hash:{},data:b}):(d=a.action,d=typeof d===t?d.apply(a):d),e+=v(d)+'"><a href="#">',(d=c.strMenu)?d=d.call(a,{hash:{},data:b}):(d=a.strMenu,d=typeof d===t?d.apply(a):d),e+=v(d)+"</a></li>    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r="",s=this,t="function",u=c.blockHelperMissing,v=this.escapeExpression;return r+='<ul class="tictac-att-attachment-menu-fileaction">    ',q={hash:{},inverse:s.noop,fn:s.program(1,f,e),data:e},(p=c.multiple_files)?p=p.call(b,q):(p=b.multiple_files,p=typeof p===t?p.apply(b):p),c.multiple_files||(p=u.call(b,p,q)),(p||0===p)&&(r+=p),r+="    ",q={hash:{},inverse:s.program(6,i,e),fn:s.noop,data:e},(p=c.multiple_files)?p=p.call(b,q):(p=b.multiple_files,p=typeof p===t?p.apply(b):p),c.multiple_files||(p=u.call(b,p,q)),(p||0===p)&&(r+=p),r+="            ",q={hash:{},inverse:s.noop,fn:s.program(11,l,e),data:e},(p=c.multiple_files)?p=p.call(b,q):(p=b.multiple_files,p=typeof p===t?p.apply(b):p),c.multiple_files||(p=u.call(b,p,q)),(p||0===p)&&(r+=p),r+="    ",q={hash:{},inverse:s.program(14,n,e),fn:s.noop,data:e},(p=c.multiple_files)?p=p.call(b,q):(p=b.multiple_files,p=typeof p===t?p.apply(b):p),c.multiple_files||(p=u.call(b,p,q)),(p||0===p)&&(r+=p),r+="</ul>"}),a.Tictac.att.rollups.attachment_preview=a.Handlebars.template(function(a,b,c,d,e){function f(a,b){return"has-thumb"}function g(a,b){var d;return(d=c.error_class)?d=d.call(a,{hash:{},data:b}):(d=a.error_class,d=typeof d===n?d.apply(a):d),o(d)}function h(a,b){return"att-removable"}function i(a,b){return'    <div class="tictac-att-photo-overlay">            <a tabindex="-1" role="button" aria-label="Download" href="#" data-action="save-att" class="tictac-att-show-dd-icon"><span class="download-txt">Download</span><i class="icon icon-chevron-down tictac-att-thumb-save-options" tabindex="-1" role="menu" aria-label="More save options"></i></a>        </div>    '}function j(a,b){var d,e="";return e+='        <div class="tictac-att-thumb-error-state" title="',(d=c.error_message)?d=d.call(a,{hash:{},data:b}):(d=a.error_message,d=typeof d===n?d.apply(a):d),e+=o(d)+'"></div>    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m="",n="function",o=this.escapeExpression,p=this,q=c.blockHelperMissing;return m+='<li tabindex="-1" aria-selected="false" role="presentation" class="tictac-att-viewer tictac-att-thumb ',l={hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e},(k=c.has_thumbnail)?k=k.call(b,l):(k=b.has_thumbnail,k=typeof k===n?k.apply(b):k),c.has_thumbnail||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+=" doc-preview-att ",l={hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e},(k=c.has_error)?k=k.call(b,l):(k=b.has_error,k=typeof k===n?k.apply(b):k),c.has_error||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+=" ",l={hash:{},inverse:p.noop,fn:p.program(5,h,e),data:e},(k=c.has_remove)?k=k.call(b,l):(k=b.has_remove,k=typeof k===n?k.apply(b):k),c.has_remove||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+=" ",l={hash:{},inverse:p.noop,fn:p.program(5,h,e),data:e},(k=c.has_cancel)?k=k.call(b,l):(k=b.has_cancel,k=typeof k===n?k.apply(b):k),c.has_cancel||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+='" data-id="',(k=c.aid)?k=k.call(b,{hash:{},data:e}):(k=b.aid,k=typeof k===n?k.apply(b):k),m+=o(k)+'" data-type="',(k=c.filetype)?k=k.call(b,{hash:{},data:e}):(k=b.filetype,k=typeof k===n?k.apply(b):k),m+=o(k)+'" title="',(k=c.filename)?k=k.call(b,{hash:{},data:e}):(k=b.filename,k=typeof k===n?k.apply(b):k),m+=o(k)+" (",(k=c.filesize)?k=k.call(b,{hash:{},data:e}):(k=b.filesize,k=typeof k===n?k.apply(b):k),m+=o(k)+')" aria-label="',(k=c.filename)?k=k.call(b,{hash:{},data:e}):(k=b.filename,k=typeof k===n?k.apply(b):k),m+=o(k)+'">    <div class="',(k=c.file_icon_class)?k=k.call(b,{hash:{},data:e}):(k=b.file_icon_class,k=typeof k===n?k.apply(b):k),m+=o(k)+'">        <span class="disable-txt">No<br>preview</span>    </div>    ',l={hash:{},inverse:p.noop,fn:p.program(7,i,e),data:e},(k=c.has_save_options)?k=k.call(b,l):(k=b.has_save_options,k=typeof k===n?k.apply(b):k),c.has_save_options||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+="    ",l={hash:{},inverse:p.noop,fn:p.program(9,j,e),data:e},(k=c.has_error)?k=k.call(b,l):(k=b.has_error,k=typeof k===n?k.apply(b):k),c.has_error||(k=q.call(b,k,l)),(k||0===k)&&(m+=k),m+='        <div class="tictac-att-hover-remove tictac-att-remove" data-action="remove" role="button" aria-label="Remove selected" tabindex="-1"></div>    <div class="filename">        <span class="basename-cover"><span class="basename">',(k=c.filename_without_extension)?k=k.call(b,{hash:{},data:e}):(k=b.filename_without_extension,k=typeof k===n?k.apply(b):k),m+=o(k)+'</span></span>        <span class="fileextn">',(k=c.file_extension)?k=k.call(b,{hash:{},data:e}):(k=b.file_extension,k=typeof k===n?k.apply(b):k),m+=o(k)+"</span>    </div></li>"}),a.Tictac.att.rollups.dragdrop=a.Handlebars.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"<div id='uploader-droparea' class='tictac-att-compose-droparea'><div>Drag and drop attachments here</div></div>"})},"1.0.0",{requires:["handlebars-base"]});YUI.add("tictac-att-strings",function(a){a.namespace("Tictac.att").strings={str_generating_message:"Generating preview...",str_jump_page_hint:"Enter page number",str_tictac_att_attachment_plural:"{{num}} Attachments",str_tictac_att_attachments:"Attachments",str_tictac_att_attachment_singular:"1 Attachment",str_tictac_att_compose_generic_error:"An error occurred while uploading this file.",str_tictac_att_compose_generic_warning:"A warning occurred while uploading this file.",str_tictac_att_compose_header_size:"{{size}} of {{max_size}}",str_tictac_att_compose_named_virus_cleaned:"Norton AntiVirus found and cleaned a virus [{{virus_name}}]. This file can be sent.",str_tictac_att_compose_named_virus_not_cleaned:"Norton AntiVirus found a virus [{{virus_name}}] that could not be cleaned. This file will not be sent.",str_tictac_att_compose_no_send_plural:"{{num}} errors occurred while uploading.",str_tictac_att_compose_no_send_singular:"An error occurred while uploading.",str_tictac_att_compose_password_protected:"Norton AntiVirus was unable to scan this file. This file may be password protected. It will be sent.",str_tictac_att_compose_virus_cleaned:"Norton AntiVirus found and cleaned a virus. This file can be sent.",str_tictac_att_compose_virus_not_cleaned:"Norton AntiVirus found a virus that could not be cleaned. This file will not be sent.",str_tictac_att_compose_warning_plural:"{{num}} warnings occurred while uploading.",str_tictac_att_compose_warning_singular:"A warning occurred while uploading.",str_tictac_att_download_password_protection:"Norton AntiVirus was unable to scan this file. This file may be password protected. It was downloaded.",str_tictac_att_download_retry_network_error:"A network error occurred during download. Please check your connection and try again.",str_tictac_att_download_server_error:"A problem occurred while downloading your attachment. Please try again.",str_tictac_att_download_virus_detected_cleaned:"Norton AntiVirus detected and cleaned a virus. This file was downloaded.",str_tictac_att_download_virus_error:"We detected a virus in your attachment. It cannot be downloaded.",str_tictac_att_download_virus_named_detected_cleaned:"Norton AntiVirus detected and cleaned a virus [{{virus_name}}]. This file was downloaded.",str_tictac_att_download_virus_named_not_downloadable:"Norton AntiVirus detected a virus [{{virus_name}}]. This file was not downloaded.",str_tictac_att_download_virus_not_downloadable:"Norton AntiVirus detected a virus. This file was not downloaded.",str_tictac_att_download_virus_scan_incomplete:"An error occurred during virus scanning. Please try again.",str_tictac_att_file_download_fail_plural:"{{num}} errors occurred while downloading.",str_tictac_att_file_download_fail_singular:"An error occurred while downloading.",str_tictac_att_file_download_success_plural:"{{num}} files were downloaded.",str_tictac_att_file_download_success_singular:"A file was downloaded.",str_tictac_att_file_remove_all:"Remove all",str_tictac_att_header_save_all:"Download all",str_tictac_att_header_save_all_to_computer:"Save all to my computer",str_tictac_att_header_save_single:"Download attachment",str_tictac_att_norton_no_trans:"Norton AntiVirus",str_tictac_att_password_error:"Sorry, we are unable to display password-protected documents.",str_tictac_att_preview_session_expired:"Sorry, document preview session has expired.",str_tictac_att_scanning_attachments:"Scanning attachments...",str_tictac_att_size_bytes:"{{size}} B",str_tictac_att_size_gb:"{{size}} GB",str_tictac_att_size_kb:"{{size}} KB",str_tictac_att_size_mb:"{{size}} MB",str_tictac_att_slideshow_count:"{{pos}} of {{total}}",str_tictac_att_spinner_savingToCloud_plural:"Saving to Dropbox...",str_tictac_att_spinner_savingToCloud_singular:"Saving to Dropbox...",str_tictac_att_spinner_scanning_plural:"Scanning {{num}} attachments...",str_tictac_att_spinner_scanning_singular:"Scanning an attachment...",str_tictac_att_spinner_uploading_plural:"Adding attachments...",str_tictac_att_spinner_uploading_singular:"Adding an attachment...",str_tictac_att_state_error:"Sorry, we are unable to display this attachment.",last:null}},"1.0.0");YUI.add("tictac-att-slider",function(a){"use strict";function b(b){function c(){function a(a){var b,c,h,i=-1;return"left"===a&&(i=1),b=e.sliderConfig.slideCount*(e.sliderConfig.imgWidth+e.sliderConfig.imgMargin),c=parseInt(g.getStyle(f),10)+b*i,h=-1*(g.get("clientWidth")-d.get("clientWidth")+e.sliderConfig.scrollMargin),c>e.sliderConfig.scrollMargin?c=e.sliderConfig.scrollMargin:h>c&&(c=h),(c===h||c===e.sliderConfig.scrollMargin)&&(m=!1,l=!1),c}function b(){e.checkOverflow(),j&&h.removeEventListener(j,b),m||g.removeClass("scrolling")}function c(){m&&window.setTimeout(c,e.sliderConfig.slideTime-50),j&&h.addEventListener(j,b),e.sliderConfig.node.setStyle(f,a(k)),j||window.setTimeout(e.checkOverflow,0)}var d=e.sliderConfig.container,g=e.sliderConfig.node,h=g.getDOMNode(),k="right",l=!1,m=!1,n=d.all(".tictac-att-scroll-left, .tictac-att-scroll-right");e._events.push(n.on("mousedown",function(a){var b=a.target;k=b.hasClass(i)||b.ancestor("div").hasClass(i)?"left":"right",l=!0,m=!1,window.setTimeout(function(){l&&(g.addClass("scrolling"),m=!0,window.setTimeout(c,e.sliderConfig.slideTime-50))},200)}),n.on("mouseup",function(){l=!1,m?(g.removeClass("scrolling"),m=!1):(j&&h.addEventListener(j,b),e.sliderConfig.node.setStyle(f,a(k)),j||window.setTimeout(e.checkOverflow,0))}))}var d,e=this,f="marginLeft",g="tictac-att-overflow-left",h="tictac-att-overflow-right",i="tictac-att-scroll-left",j=a.Tictac.base.utils.transitionEndEventName();e._events=[],e.sliderConfig={container:null,node:null,scrollMargin:0,imgWidth:72,imgMargin:10,slideCount:3,clickTime:250,slideTime:150};for(d in b)b.hasOwnProperty(d)&&(e.sliderConfig[d]=b[d]);a.Tictac.base.isRTL&&(f="marginRight",g="tictac-att-overflow-right",h="tictac-att-overflow-left",i="tictac-att-scroll-right"),e.checkOverflow=function(a){var b,c,d,i,j=e.sliderConfig.container,k=e.sliderConfig.node,l=e.sliderConfig.scrollMargin;if(k.getDOMNode()){if(d=k.get("clientWidth"),b=j.get("clientWidth"),i=Math.round(parseInt(k.getStyle(f),10)),c=-1*(d-b+e.sliderConfig.scrollMargin),!a&&c>0&&l>i)return k.setStyle(f,l),e.checkOverflow(!0);if(!a&&c>i&&d+l>b)return k.setStyle(f,c),e.checkOverflow(!0);i<e.sliderConfig.scrollMargin?j.addClass(g):j.removeClass(g),d+2*e.sliderConfig.scrollMargin>b&&i>c?j.addClass(h):j.removeClass(h)}},c(),e.checkOverflow(),e.update=function(a){var b;for(b in a)a.hasOwnProperty(b)&&(e.sliderConfig[b]=a[b])},e.destroy=function(){a.Array.each(e._events,function(a){a.detach()})}}a.namespace("Tictac.att").Slider=b},"1.0.0",{requires:["tictac-base","tictac-base-utils"]});YUI.add("tictac-att-attachment-menu",function(a){"use strict";function b(){b.superclass.constructor.apply(this,arguments)}function c(a){return"."+d+b.NAME+(a?"-"+a:"")}var d="tictac-att-";b.NAME="attachment-menu",b.ATTRS={attachments:{validator:a.Lang.isObject,value:null}},a.extend(b,a.Widget,{bindUI:function(){function b(a){i=!0,f.fadeMenuTimeout&&(clearTimeout(f.fadeMenuTimeout),f.fadeMenuTimeout=null),f.hoverInTimeout&&clearTimeout(f.hoverInTimeout),f.hoverInTimeout=setTimeout(function(){i&&f._show(a)},500)}function d(a){i=!1,f.fadeMenuTimeout=setTimeout(function(){f.hide(a),f.fadeMenuTimeout=null},500)}function e(a){f.hide(a)}var f=this,g=f.get("contentBox"),h=g&&g.ancestor("#msg-preview",!0),i=!1;g&&(g.delegate&&g.delegate("hover",b,d,".tictac-att-thumb",f),f.evtHandles.push(a.delegate("mouseenter",b,a.one("body"),c(),f)),f.evtHandles.push(a.delegate("mouseleave",d,a.one("body"),c(),f)),h&&h.on("scroll",e))},destructor:function(){var b=this,c=b.get("contentBox");c&&c.detach&&(c.detach("hover",b._show,b),c.detach("hover",b.hide,b)),a.Array.each(b.evtHandles,function(a){a.detach()})},hide:function(a){var b=this,c=a.relatedTarget;b._menu&&b._menu.node&&!b._menu.node.contains(c)&&b._uiRemoveMenu()},initializer:function(){this.evtHandles=[]},isVisible:function(){var a=this;return a._isVisible||!1},allowSimClick:function(){this._menu.node._node.click()},_getAttachmentObject:function(a){var b=this.get("attachments"),c=null;return b&&b.get&&(c=b.get(a)),c},_getMenuContent:function(b){var c="";return b&&b.getFileName&&(c=a.Tictac.att.rollups.overlay(b.getObject())),c},_show:function(a){var b,c,d,e=a.currentTarget,f=this;e&&e.test("li")&&(b=e.getAttribute("data-id"),c=f._getAttachmentObject(b),c&&(d=f._getMenuContent(c),f._attachmentObj=c,f._node=e,f._uiShowMenu(e,d),e.addClass("att-active"),f._activeNode=e))},_uiRemoveMenu:function(){var b=this,c=a.common.ui.MenuHelper;b._menu&&b._menu.node&&(b._menu.context.unplug(c),b._menu.node.remove(),b._menu.context=b._menu.node=null,b._activeNode&&b._activeNode.removeClass("att-active"))},_uiShowMenu:function(b,c){var d=this,e=a.common.ui.MenuHelper;b&&c&&(d._uiRemoveMenu(),d._menu={},d._menu.context=b,d._menu.node=a.Node.create(c),a.one("body").append(d._menu.node),e.create(b,{menu:d._menu.node},function(){d._menu.node.on("menuSelected",function(a){d.fire("item-selected",{action:a.dataAction,attachment:d._attachmentObj,node:d._activeNode})})}))},_menu:null}),a.namespace("Tictac.att").AttachmentMenu=b},"1.0.0",{requires:["common-ui-menu-helper","event-hover","node-base","widget"]});YUI.add("tictac-att-attachmentview",function(a){"use strict";var b={showError:function(b,c){var d,e=this;d=a.Tictac.att.attError(b,c&&c>1?{num:c}:null),e.notify(d.message,{fmt:d.cssClass,autoDismiss:!1})},hideError:function(a){var b=this;return b._showError(!1),void 0!==a?(a.halt(),!1):!0},notify:function(b,c){var d=this,e=d._getErrorNode(),f=a.Tictac.att.rollups.error,g=e.getData("noticeId");c=c||{},c.fmt=c.fmt||"has-info",c.autoDismiss=a.Object.owns(c,"autoDismiss")?c.autoDismiss:!0,a.Tictac.base.utils.log("Download notify: "+b),e.setContent(f({error_message:b,error_class:c.fmt,show_dismiss:!c.autoDismiss})),g=(g||1)+1,e.setData("noticeId",g),d._stopSpinning(),d._showError(!0),c.autoDismiss&&a.later(4e3,d,function(a){e.getData("noticeId")===g&&a===b&&d.hideError()},b)},_getSpinnerMsg:function(b,c){var d,e=a.Tictac.att.strings;return d=1===c[b]?"_singular":"_plural",a.Tictac.base.utils.subs(e["str_tictac_att_spinner_"+b+d],"num",c[b])},_updateSpinner:function(){var b,c,d=this,e=d._getArray();b=a.Array.reduce(e,{savingToCloud:0,uploading:0,scanning:0},function(b,c){return a.each(b,function(a,d){c.get(d)&&(b[d]=a+1)}),b}),a.some(["savingToCloud","uploading","scanning"],function(a){return b[a]?(d.hideError(),d._startSpinning(),c=d._getSpinnerMsg(a,b),d._spinner.setContent(c),d._spinner.setAttribute("aria-label",c),d._spinner.setAttribute("tabindex",-1),d._spinner.focus(),!0):!1})||(d._spinner.setContent(""),d._spinner.removeAttribute("aria-label"),d._spinner.removeAttribute("tabindex"),d._stopSpinning(!0))},_updateStatus:function(b,c,d){var e=this,f=e._getCollection();a.Array.each(b,function(a){var b=f.get(a);f&&b.set(c,d)}),e._updateSpinner()},setStatus:function(a,b){this._updateStatus(a,b,!0)},clearStatus:function(a,b){this._updateStatus(a,b,!1)}};a.namespace("Tictac.att").AttachmentView=b});YUI.add("tictac-att-attachment-tray",function(a){"use strict";function b(){b.superclass.constructor.apply(this,arguments)}var c=a.Tictac.base.isRTL;b.NAME="attachment-tray",b.ATTRS={attachments:{validator:a.Lang.isObject,value:null},slideDuration:{value:.25},thumbSize:{value:150},thumbMargin:{value:10},defaultHeight:{value:"136px"},count:{value:0},imageCount:{value:0},size:{value:0},isRead:{value:!1},isCompose:{value:!1},hidden:{value:!1},composeMaxSize:{value:26214400},composeMaxCount:{value:50},instanceId:{value:"tray"}},b.getPrettySize=function(b,c){var d=a.Tictac.base.utils.getPrettySize(b,c);return a.Tictac.base.utils.subs(a.Tictac.att.strings[d.label],"size",d.value)},a.extend(b,a.Widget,{renderUI:function(){var b,c=this,d=c.get("contentBox"),e=a.common.Utils.features.enabled("docPreview"),f=e?c.get("attachments").getPreviewableArray():c.get("attachments").getImageArray();d.append(a.Tictac.att.rollups.tray(c._getBaseMarkup())),f.length&&(b=d.all(".tictac-att-thumb-cover ul.tictac-att-thumb-flow li"),a.each(f,function(a,c){var d=new Image;d.onload=function(){b.item(c).setStyle("backgroundImage",'url("'+a.thumbnail+'")')},d.src=a.thumbnail})),c._tray=d.one(".tictac-att"),c._spinner=c._tray.one(".tictac-att-header-spinner"),c._resizeThumbList(),e&&c._fixFilenameOverflow()},bindUI:function(){var b,c,d,e,f=this,g=f.get("boundingBox"),h=a.Tictac.att.rollups,i=a.common.ui.MenuHelper,j=a.Node.create('<div class="tictac-att-attachment-menu optionMenu"></div>'),k=a.Node.create('<div class="tictac-att-attachment-menu optionMenu"></div>'),l=function(a){return"click"===a.type||"keydown"===a.type&&13===a.keyCode},m=function(a,b){a.setAttribute("tabindex",b),a.all("a").setAttribute("tabindex",b),a.one("i.icon-chevron-down ").setAttribute("tabindex",b)};a.one("body").append(j),a.one("body").append(k),f._menuNodeSaveTo=j,f._menuNodeSaveAllTo=k,f._events=f._events||[],f._events.push(g.delegate(["click","keydown"],function(a){var c=a.currentTarget.ancestor(".tictac-att-thumb")||a.currentTarget.ancestor(".tictac-att-other")||a.currentTarget.ancestor(".tictac-att").one(".tictac-att-other")||a.currentTarget.ancestor(".tictac-att").one(".tictac-att-thumb"),e=c.getData("id"),g=f.get("attachments").get(e);if(l(a))return d=g.getObject(),d.menuItems=f._getRegisteredSaveMenus(g),j.setHTML(h.downloadmenu(d)),i.create(a.currentTarget,{menu:j},function(){b=j.on("menuSelected",function(a){f.fire("menu-item-selected",{action:a.dataAction,attachment:g,node:c})})}),a.halt(),!1},".tictac-att-thumb-save-options")),f._events.push(g.delegate(["click","keydown"],function(a){var b=a.currentTarget.ancestor(".tictac-att-thumb")||a.currentTarget.ancestor(".tictac-att-other")||a.currentTarget.ancestor(".tictac-att").one(".tictac-att-other")||a.currentTarget.ancestor(".tictac-att").one(".tictac-att-thumb"),c=b.getData("id"),d=f.get("attachments").get(c);l(a)&&(f.fire("menu-item-selected",{action:"download",attachment:d,node:b}),a.halt())},'a[data-action="save-att"]')),f._events.push(g.delegate(["click","keydown"],function(b){function d(){var d=e.getVal(a,"Tictac.dropbox.controller");k.setHTML(h.downloadmenu({save_to_computer:!0,save_to_dropbox:!!d,multiple_files:!0,menuItems:f._getRegisteredSaveMenus(f.get("attachments").getArray())})),i.create(b.currentTarget,{menu:k},function(){c=k.on("menuSelected",function(a){f.fire(a.dataAction)})})}var e=a.Tictac.base.utils;if(l(b))return b.target.hasClass("icon-chevron-down")?e.hasTictacModule("tictac-dropbox")?a.use("tictac-dropbox-controller",function(){d()}):d():f.fire("download_all"),b.halt(),!1},".tictac-att-header-save-comp")),f._events.push(g.delegate(["click","keydown"],function(a){if(l(a)){a.halt();var b=a.currentTarget.getData("action"),c=a.currentTarget.ancestor(".tictac-att-thumb")||a.currentTarget.ancestor(".tictac-att-other"),d=c.getData("id"),e=f.get("attachments").get(d);return f.fire("menu-item-selected",{action:b,attachment:e,node:c}),!1}},".tictac-att-remove",f)),f._events.push(g.delegate("click",f._removeAll,".tictac-att-header-remove-all",f)),f._events.push(g.delegate("click",f._viewAll,".tictac-att-header-view",f)),f._events.push(g.delegate("click",f.hideError,".tictac-att-error-dismiss",f)),f._events.push(a.on("windowresize",function(){f._uiUpdateTray()})),f._events.push(g.delegate("click",function(){f.fire("norton")},".tictac-att-norton-logo")),f._events.push(g.delegate(["focus","blur"],function(a){var b=a.target,c=b.ancestor(".tictac-att-photo-overlay"),d=b.ancestor("li"),e=d.hasClass("att-removable")?d.one(".tictac-att-hover-remove.tictac-att-remove"):null,f="blur"===a.type;if(c){if(f&&b.menu&&"none"!==b.menu.getMenuNode().getStyle("display"))return;c.setStyle("height",f?"0":"2rem")}e&&(e.setStyle("height",f?"0":"15px"),e.setStyle("width",f?"0":"15px"))},".tictac-att-photo-overlay .tictac-att-show-dd-icon,.tictac-att-photo-overlay .tiact-att-thumb-save-options")),f._events.push(g.delegate(["focus","blur"],function(a){var b=a.target,c=b.ancestor("li"),d=c.one(".tictac-att-photo-overlay"),e="blur"===a.type;d&&d.setStyle("height",e?"0":"2rem"),b.setStyle("height","0"),b.setStyle("width","0")},".tictac-att-hover-remove.tictac-att-remove")),f._events.push(g.delegate("keydown",function(a){var b,c=a.currentTarget,d=a.keyCode,e=!1,f=c.ancestor("div");(38===d||40===d)&&(a.halt(),e=38===d,b=e?c.previous(".tictac-att-thumb-flow li"):c.next(".tictac-att-thumb-flow li"),b||(!e&&f.hasClass("tictac-att-thumb-cover")?b=f.next(".tictac-att-files-cover").one("ul li"):e&&f.hasClass("tictac-att-files-cover")&&(b=f.previous(".tictac-att-thumb-cover").one("ul li:last-child"))),b&&(m(c,-1),c.hasClass("att-removable")&&c.one(".tictac-att-remove").setAttribute("tabindex",-1),m(b,0),b.hasClass("att-removable")&&b.one(".tictac-att-remove").setAttribute("tabindex",0),b.focus()))},".tictac-att-thumb-flow li")),e=f._tray.one(".tictac-att-thumb-cover .tictac-att-thumb-flow li")||f._tray.one(".tictac-att-files-cover .tictac-att-thumb-flow li"),e&&m(e,0)},syncUI:function(){var b=this,c=b._tray.one(".tictac-att-thumb-cover"),d=c.one(".tictac-att-thumb-flow");b._slider=new a.Tictac.att.Slider({container:c,node:d,scrollMargin:0,imgWidth:150,imgMargin:10,slideCount:3}),b._slider.checkOverflow()},destructor:function(){var b=this;b._attachmentMenu&&b._attachmentMenu.destroy(),b._slider&&b._slider.destroy(),b._menuNodeSaveTo&&b._menuNodeSaveTo.remove(!0),b._menuNodeSaveAllTo&&b._menuNodeSaveAllTo.remove(!0),a.Array.each(b._events,function(a){a.detach()})},initializer:function(){var a=this;a.set("count",a.get("attachments").getCount()),a.set("viewableCount",a.get("attachments").getViewableArray().length),a.set("imageCount",a.get("attachments").getImageArray().length),a.set("size",a.get("attachments").getSize())},hide:function(){var a=this,b=a.get("boundingBox");b.addClass("hidden"),a.set("hidden",!0),a._uiUpdateTray()},show:function(a){var b=this,c=b.get("boundingBox");c.removeClass("hidden"),b.set("hidden",!1),a&&c.scrollIntoView()},_getRegisteredSaveMenus:function(b){b.length||(b=[b]);var c=[],d=a.Tictac.att.saveMenu;return a.each(d,function(d){var e,f,g,h=b.length;if(d.types){for(e=0;h>e;e++)if(b[e].get&&b[e].get("filetype")?(f=b[e].get("filetype"),g=g=b[e].data?b[e].data.type:b[e].type):b[e].filetype&&(f=b[e].filetype,g=b[e].type),-1!==a.Array.indexOf(d.types,f)||-1!==a.Array.indexOf(d.types,g))return void c.push(d)}else c.push(d)}),c},addAttachment:function(b){var c,d=this,e=d.get("attachments"),f=a.Tictac.att.rollups,g=b.getObject();e.add(b),b.isImage()?(c=d._tray.one(".tictac-att-thumb-cover .tictac-att-thumb-flow"),g.has_thumbnail=!0,d.set("imageCount",d.get("imageCount")+1)):c=d._tray.one(".tictac-att-files-cover .tictac-att-thumb-flow"),c&&c.append(f.attachment(g)),d._uiUpdateTray()},removeAttachment:function(a){var b,c=this,d=c.get("attachments");b=c._tray.one('.tictac-att-thumb-flow li[data-id="'+a+'"]'),d.get(a).isImage()&&c.set("imageCount",c.get("imageCount")-1),b.remove(),d.remove(a),c._uiUpdateTray()},_resizeThumbList:function(){var b,c=this;if(b=c._tray.one(".tictac-att-thumb-flow")){if(a.common.Utils.features.enabled("composev3"))return void b.addClass("composeV3");b.setStyle("width",(c.get("thumbSize")+c.get("thumbMargin"))*c.get("imageCount")+"px")}c._slider&&c._slider.checkOverflow()},_fixFilenameOverflow:function(){var b,c,d,e=this,f=e._tray.all(".tictac-att-thumb-cover ul.tictac-att-thumb-flow li");a.each(f,function(a){b=a.get("region").width,c=a.one(".basename").get("region").width,d=a.one(".fileextn").get("region").width,c+d>=b&&(a.one(".basename-cover").setStyle("width",b-d),a.one(".basename").setStyle("width",b-d+5))})},_getComposeSizeString:function(){var b=this,c=a.Tictac.base.utils,d=a.Tictac.att.strings.str_tictac_att_compose_header_size,e=a.Tictac.att.AttachmentTray,f=e.getPrettySize(b.get("size")),g=e.getPrettySize(b.get("composeMaxSize"));return c.subs(d,{size:f,max_size:g})},_getCountString:function(){var b,c=this.get("attachments"),d=c.getFileArray().length+c.getImageArray().length,e=a.Tictac.att.strings,f=a.Tictac.base.utils;return b=1===d?e.str_tictac_att_attachment_singular:f.subs(e.str_tictac_att_attachment_plural,"num",d)},_getViewableCountString:function(){var b,c=this.get("viewableCount"),d=a.Tictac.att.strings,e=a.Tictac.base.utils;return b=1===c?d.str_tictac_att_attachment_singular:e.subs(d.str_tictac_att_attachment_plural,"num",c)},_isRead:function(){return this.get("isRead")?!0:!1},_isCompose:function(){return this.get("isCompose")?!0:!1},_getBaseMarkup:function(){var b,d=this,e=a.Tictac.att.AttachmentTray,f=d.get("attachments"),g=a.common.Utils.features.enabled("docPreview"),h=g?f.getPreviewableArray().length:f.getFileArray().length+f.getImageArray().length;return b={tray_count:d._getCountString(),tray_size:e.getPrettySize(d.get("size")),hasDocPreview:g,is_read:d._isRead(),is_compose:d._isCompose(),is_hidden:d.get("hidden"),isRTL:c,att_thumbnails:g?f.getPreviewableArray():f.getImageArray(),files:g?[]:f.getFileArray(),is_single:1===h,show_tray:!d._isRead()||h>0,has_viewable:f.getViewableArray().length>0,viewable_count:d._getViewableCountString()}},_uiUpdateTray:function(){var b,c,d,e=this,f=a.Tictac.att.strings,g=a.Tictac.att.AttachmentTray,h=e.get("attachments"),i=h.getCount(),j=e._tray.one(".tictac-att-header-remove-all a"),k=1===i?"":f.str_tictac_att_file_remove_all,l=e._tray.one(".tictac-att-header-count");e.set("count",i),e.set("size",h.getSize()),1===i?(j&&j.addClass("hidden"),l.addClass("hidden")):(l.removeClass("hidden"),j&&(j.removeClass("hidden"),j.setHTML(k)),l.setHTML(e._getCountString())),e._resizeThumbList(),b=e._tray.all(".tictac-att-header-size"),b&&(e._isCompose()?b.setContent(e._getComposeSizeString()):b.setContent(g.getPrettySize(e.get("size")))),c=e._tray.one(".tictac-att-header-att"),c&&c.setContent(e._getCountString()),d=e._tray.one(".tictac-att-header-save-message"),d&&d.setHTML(1===e.get("count")?f.str_tictac_att_header_save_single:f.str_tictac_att_header_save_all)},_removeAll:function(a){return this.fire("removeall"),a.halt(),!1},_viewAll:function(a){return a.halt(),!1},_getErrorNode:function(){return this._tray.one(".tictac-att-header-error")},_showError:function(a){a?this._tray.addClass("att-error"):this._tray.removeClass("att-error")},_startSpinning:function(){this._tray.addClass("att-spinner")},_stopSpinning:function(a){this._tray.removeClass("att-spinner"),a&&this._uiUpdateTray()},_getArray:function(){return this.get("attachments").getArray(null,!0)},_getCollection:function(){return this.get("attachments")}}),a.mix(b.prototype,a.Tictac.att.AttachmentView),a.namespace("Tictac.att").AttachmentTray=b},"1.0.0",{requires:["widget","event-hover","handlebars-base","tictac-att-rollups","tictac-att-strings","tictac-base-utils","tictac-att-attachments","tictac-att-slider","tictac-att-attachment-menu","tictac-base-mailpreferences","tictac-att-attachmentview","mail-common-utils-features"]});YUI.add("tictac-att-attachments",function(a){"use strict";function b(){this.data={},this.count=0}function c(a){var b=this;b.data={},b.update(a),b.data.aid||(b.data.aid=d()),c.superclass.constructor.apply(b,arguments)}var d=function(){var a=0;return function(){return++a}}();b.prototype={add:function(a){return this.data[a.getId()]=a,this.count++,this},remove:function(a){return this.data.hasOwnProperty(a)?(delete this.data[a],this.count--,!0):!1},get:function(a){return this.data.hasOwnProperty(a)?this.data[a]:!1},getArray:function(a,b){var c=[];for(var d in this.data)this.data.hasOwnProperty(d)&&(b?c.push(this.data[d]):c.push(this.data[d].getObject(a)));return c},getFileArray:function(){var a,b=[];for(var c in this.data)if(this.data.hasOwnProperty(c)){if(a=this.data[c].getObject(),!a.viewable){b.push(a);continue}a.fullsize||b.push(a),a.downloadInfo=this.data[c].getObject({simple:!0})}return b},getImageArray:function(a){return this.getViewableArray(a,!0)},getPreviewableArray:function(a){return this.getViewableArray(a,!1)},getViewableArray:function(b,c){var d,e=[],f=0,g=0;for(var h in this.data)if(this.data.hasOwnProperty(h)){if(d=this.data[h].getObject(),a.Tictac.att.filter.isInlineImage(d))continue;if(!d.viewable)continue;if(c&&!d.fullsize)continue;d.downloadInfo=this.data[h].getObject({simple:!0}),e.push(d),void 0!==b&&b===this.data[h].getId()&&(f=g),g++}return void 0!==b?{attachments:e,position:f}:e},getSize:function(){var a,b=this,c=0;for(a in b.data)b.data.hasOwnProperty(a)&&(c+=b.data[a].getSize());return c},getCount:function(){return this.count}};var e=["jpg","jpeg","gif","png","bmp","tiff","tif","jif","jfif","jp2","jpx","j2k","j2c","pcd"];c.NAME="attachment",c.ATTRS={cancelable:{validator:a.Lang.isBoolean,value:!1},downloadable:{validator:a.Lang.isBoolean,value:!1},dropbox:{validator:a.Lang.isBoolean,value:!1},shareable:{validator:a.Lang.isBoolean,value:!1},editable:{validator:a.Lang.isBoolean,value:!1},removable:{validator:a.Lang.isBoolean,value:!1},retryable:{validator:a.Lang.isBoolean,value:!1},viewable:{validator:a.Lang.isBoolean,value:!1,getter:function(a){return a||!!this.get("thumbnail")}},scanning:{validator:a.Lang.isBoolean,value:!1},uploading:{validator:a.Lang.isBoolean,value:!1},savingToCloud:{validator:a.Lang.isBoolean,value:!1},filetype:{validator:a.Lang.isString,value:""},thumbnail:{validator:a.Lang.isString,value:""},error:{validator:a.Lang.isObject,value:null}},a.extend(c,a.Base,{getId:function(){return this.data.aid},setId:function(a){var b=this;return b.data.aid=a,b},update:function(a){var b,c=this;for(b in a)a.hasOwnProperty(b)&&(c.data[b]=a[b]);return c},getFileName:function(){var a=this;return a.data.hasOwnProperty("filename")?a.data.filename:""},getFilenameWithoutExtension:function(){var a=this;if(a.data.hasOwnProperty("filename")){var b=a.data.filename;return b.substr(0,b.lastIndexOf("."))||b}return""},getFileExtension:function(){var a=this;if(a.data.hasOwnProperty("filename")){var b=a.data.filename,c=b.lastIndexOf(".");return c>=0?b.substr(c):""}return""},getFileIconClass:function(){var b=this;return a.common.Utils.features.enabled("docPreview")&&!b.isImage()?a.Tictac.att.filter.getFileTypeIcon(b.get("filetype")):""},isCancelable:function(){return this.get("cancelable")},isDownloadable:function(){return this.get("downloadable")},isDropbox:function(){return this.get("dropbox")},isShareable:function(){return this.get("shareable")},isEditable:function(){return this.get("editable")},isRemovable:function(){return this.get("removable")},isRetryable:function(){return this.get("retryable")},isViewable:function(){return this.get("viewable")},isImage:function(){var b,c,d=this,f=d.get("filetype");return"image"===f?!0:(b=d.getFileName().toLowerCase(),c=b.substring(b.lastIndexOf(".")+1),a.Array.indexOf(e,c)>-1)},hasError:function(){var a=this.get("error");return!(!a||!a.message)},getNode:function(){var b=this,c=".tictac-att-thumb-flow ";return c+=".tictac-att-thumb",c+='[data-id="'+b.getId()+'"]',b._node||(b._node=a.one(c)),b._node||(c=".tictac-att-thumb-flow ",c+=".tictac-att-other",c+='[data-id="'+b.getId()+'"]',b._node=a.one(c)),b._node},updateProperty:function(a,b){var c=this;a&&("error"===a&&null===b&&(b={}),c.set(a,b),c._renderItem())},_renderItem:function(){var b,c,d=this,e=d.getNode(),f=d.get("error"),g=a.common.Utils.features.enabled("docPreview"),h=d.get("thumbnail"),i=h||d.isImage()?a.Tictac.att.rollups.attachment:a.Tictac.att.rollups.fileattachment;return g&&e?void(f&&f.cssClass?e.addClass("has-error"):e.removeClass("has-error")):void(e&&(b=a.Node.create(i(d.getObject())),e.get("parentNode").insert(b,e),e.remove(),d._node=null,h&&(c=new Image,c.onload=function(){b.setStyle("backgroundImage",'url("'+h+'")')},c.src=h)))},getObject:function(b){var c,d=this,e=d.get("error"),f=d.hasError(),g=d.isDropbox();return b&&b.simple?(c={mid:d.data.mid,fid:d.data.fid,pid:d.data.pid,aid:d.data.aid,downloadUrlV3:d.data.getAttachmentUrlV3},void 0!==d.data.tnefId&&(c.tnefid=""+d.data.tnefId),c):(c=d.data,c.filename=a.Tictac.base.utils.deentitize(c.filename),c.filetype=d.get("filetype"),c.thumbnail=d.get("thumbnail"),d.get("thumbnail")?(c.has_thumbnail=!0,c.filetype="image",c.overlay=!1):c.overlay=!0,c.filetype&&(c.has_filetype=!0),c.filesize=a.Tictac.att.AttachmentTray.getPrettySize(d.getSize()),c.simplefilesize=a.Tictac.att.AttachmentTray.getPrettySize(d.getSize(),!0),c.has_cancel=d.isCancelable(),c.has_view=d.isViewable(),c.has_edit=d.isEditable(),c.has_remove=d.isRemovable(),c.has_retry=d.isRetryable(),c.save_to_computer=d.isDownloadable(),c.save_to_dropbox=d.isShareable(),c.filename_without_extension=a.Tictac.base.utils.deentitize(d.getFilenameWithoutExtension()),c.file_extension=d.getFileExtension().substr(0,5),c.has_save_options=d.isDownloadable()||d.isShareable()||!f,c.has_error=f,c.is_dropbox=g,c.file_icon_class=d.getFileIconClass(),f?(c.error_message=e.message,c.error_class=e.cssClass,a.merge(c,e.menuSettings)):c)},getSize:function(){var a=this;return a.data.hasOwnProperty("size")?a.data.size:0}}),a.namespace("Tictac.att").Collection=b,a.namespace("Tictac.att").Attachment=c},"1.0.0",{requires:["base","tictac-att-attachment-tray","tictac-base-utils","tictac-att-filter"]});YUI.add("tictac-att-progressbar",function(a){"use strict";function b(){}b.prototype={render:function(b){var c=this;c.bar=a.Node.create('<span><span class="tt-progressbar-bar"></span></span>'),c.rail=a.Node.create('<div class="tt-progressbar-rail"></div>'),c.rail.append(c.bar),a.one(b).append(c.rail),c.width=c.rail.get("width"),c.set(0)},set:function(b){b=parseFloat(b),a.Lang.isNumber(b)&&this.bar.setStyle("width",Math.max(0,Math.min(100,b))+"%")},cleanup:function(){var a=this;a.bar.remove(!0),a.rail.remove(!0),a.bar=null,a.rail=null}},a.namespace("Tictac.widget").Progressbar=b},"1.0.0",{requires:["node"]});YUI.add("tictac-att-attachment-compose",function(a){"use strict";function b(){b.superclass.constructor.apply(this,arguments)}function c(){c.superclass.constructor.apply(this,arguments)}var d=a.Tictac.att;b.NAME="attachment",a.extend(b,d.Attachment,{activate:function(){var b=this,c=new a.Tictac.widget.Progressbar,d=this.getNode();c.render(b.getNode()),b.progressbar=c,d&&(d.addClass("tictac-att-uploading"),(d.one(".tictac-att-other-save-btn")||d.one(".tictac-att-thumb-save-options")).hide(),d.hasClass("tictac-att-other")&&d.one(".tictac-att-cancel-file-uploading").removeClass("hidden"))},setProgress:function(a){this.progressbar&&this.progressbar.set(a)},deactivate:function(){var a,b=this,c=this.getNode();b.progressbar&&(b.progressbar.cleanup(),b.progressbar=null),c&&(a=c.one(".tictac-att-other-save-btn")||c.one(".tictac-att-thumb-save-options"),a&&a.show(),c.removeClass("tictac-att-uploading"),c.hasClass("tictac-att-other")&&c.one(".tictac-att-cancel-file-uploading").addClass("hidden"))}}),d.AttachmentProgressbar=b,c.NAME="attachment",a.extend(c,d.Attachment,{activate:function(){this.getNode().addClass("tictac-att-uploading")},deactivate:function(){this.getNode().removeClass("tictac-att-uploading")}}),d.AttachmentSpinny=c},"1.0.0",{requires:["tictac-att-attachments","tictac-att-progressbar"]});YUI.add("tictac-att-attachment-error",function(a){"use strict";function b(a){var b={};return"download:virus_not_downloadable"===a&&(b={save_to_computer:!1,save_to_dropbox:!1,has_save_options:!1}),b}function c(a){var b="has-error";switch(a){case"tray:download_cleaned":case"tray:compose_warning":case"download:virus_detected_cleaned":case"download:password_protection":case"compose:virus_cleaned":case"compose:password_protection":case"compose:generic_warning":b="has-warning";break;case"tray:download_error":case"tray:compose_error":case"download:virus_not_downloadable":case"download:virus_scan_incomplete":case"download:retry_network_error":case"compose:virus_not_cleaned":case"compose:generic_error":b="has-error"}return b}function d(b,c){var d,e=a.Tictac.att.strings;switch(b){case"tray:download_cleaned":d=c&&c.num?"str_tictac_att_file_download_success_plural":"str_tictac_att_file_download_success_singular";break;case"tray:compose_error":d=c&&c.num&&1!==c.num?"str_tictac_att_compose_no_send_plural":"str_tictac_att_compose_no_send_singular";break;case"tray:compose_warning":d=c&&c.num&&1!==c.num?"str_tictac_att_compose_warning_plural":"str_tictac_att_compose_warning_singular";break;case"tray:download_error":d=c&&c.num&&1!==c.num?"str_tictac_att_file_download_fail_plural":"str_tictac_att_file_download_fail_singular";break;case"download:virus_not_downloadable":d=c&&c.virus_name?"str_tictac_att_download_virus_named_not_downloadable":"str_tictac_att_download_virus_not_downloadable";break;case"download:virus_scan_incomplete":d="str_tictac_att_download_virus_scan_incomplete";break;case"download:retry_network_error":d="str_tictac_att_download_retry_network_error";break;case"download:password_protection":d="str_tictac_att_download_password_protection";break;case"download:virus_detected_cleaned":d=c&&c.virus_name?"str_tictac_att_download_virus_named_detected_cleaned":"str_tictac_att_download_virus_detected_cleaned";break;case"compose:virus_cleaned":d=c&&c.virus_name?"str_tictac_att_compose_named_virus_cleaned":"str_tictac_att_compose_virus_cleaned";break;case"compose:virus_not_cleaned":d=c&&c.virus_name?"str_tictac_att_compose_named_virus_not_cleaned":"str_tictac_att_compose_virus_not_cleaned";break;case"compose:password_protection":d="str_tictac_att_compose_password_protected";break;case"compose:generic_error":d="str_tictac_att_compose_generic_error";break;case"compose:generic_warning":d="str_tictac_att_compose_generic_warning";break;default:d="str_tictac_att_file_download_fail_singular"}return e[d]?a.Tictac.base.utils.subs(e[d],c):null}a.namespace("Tictac.att").attError=function(a,e){return{message:d(a,e),cssClass:c(a),menuSettings:b(a)}}},"1.0.0",{requires:["tictac-base-utils","tictac-att-strings"]});YUI.add("tictac-att-downloader",function(a){"use strict";function b(b){return a.Array.map(b,function(a){return a.aid})}function c(a,b){var c,d=!1,e=!1;switch(a){case"download_av_internal_error":case"download_av_server_down":case"download_av_error":c="download:retry_network_error",d=!0;break;case"download_has_virus":case"download_has_virus_cant_clean":c="download:virus_not_downloadable",d=!0;break;case"download_not_scannable":c="download:password_protection",e=!0;break;case"download_cleaned":c="download:virus_detected_cleaned",e=!0;break;case"download_av_no_virus":break;default:d=!0,c="download:retry_network_error"}return{failed:d||e,error:d,warning:e,code:c,extras:{virus_name:b}}}function d(){var b=new Date,c=a.Tictac.att.strings.str_tictac_att_attachments;return c+="_"+b.getFullYear(),c+=b.getMonth()+1,c+=b.getDate()}function e(b,c,d){var e,f=d&&1===d.fullscan;return f&&(b+="&fullscan=1"),b=a.Tictac.base.mailIO.addReqId(b),e=document.createElement("iframe"),e.id="tictac-attachment-downloader",e.style.display="none",e.src=b,a.one("body").append(e),setTimeout(function(){e&&e.remove&&e.remove()},q),e}function f(b,c){function d(b,c){var f=b.downloadUrl.replace(/^https?:\/\/[\s\S]*yahoo\.com/,"")+"&giveurl=1";g+=1,a.io(f,{on:{success:function(c,d){var f,h,i=d.getResponseHeader("Content-Type");-1!==i.indexOf("application/json")?(f=a.Tictac.base.utils.parseJSON(d.responseText),h=f&&f.downloadUrl?f.downloadUrl:d.responseText):h=d.responseText,h?b.secureDownload={url:h}:(j=!0,b.secureDownload={error:c,res:d}),g-=1,e()},failure:function(a,f){return g-=1,c?(b.secureDownload={error:a,res:f},j=!0,void e()):void d(b,!0)}}})}function e(){for(var a=b.attachments;f>g&&h<a.length;)h+=1,d(a[h-1]);0===g&&h>=a.length&&c(j?"failed":"success",b)}var f=2,g=0,h=0,i=b.attachments,j=!1;r(i.length>0,"populateSecureDownloadURLs expected at least 1 att"),e()}function g(b,h,i,j,k){function l(c,d){var e,f,j,k;try{e=a.JSON.parse(d.response||d.responseText)}catch(l){return h("failed",{}),n.stat("download_error_json"),window.yui.fire("stat:feature_fail",{feature_group:"READ_ATTACH",message:"ATTACH_DOWNLOAD_FAILURE",visible:"yes",api:"GET_URL_JSON_PARSE"}),void a.fire("util:ymstats",{name:"download-tray-v2-fail",type:"fail_to_parse_vs_response"})}if(e&&e.error){if("Client.ClientRedirect.SessionIdReissue"===e.error.code&&!i)return f=e.error.detail.url,j=f.match(/[\&|\?]wssid=([^\&\#]+)/),k=j.length>1?j[1]:NeoConfig.wssid,NeoConfig.wssid=k,void g(b,h,!0);window.yui.fire("stat:webservice_fail",{feature_group:"READ_ATTACH",message:e.error.code,visible:"yes",api:"VirusScanAttachments"}),a.fire("util:ymstats",{name:"download-tray-v2-fail",type:e.error.code})}else a.fire("util:ymstats",{name:"download-tray-v2-fail",type:e.error.code}),window.yui.fire("stat:webservice_fail",{feature_group:"READ_ATTACH",message:"SERVER_ERROR_GENERAL",visible:"yes",api:"VirusScanAttachments"});n.stat("download_error_general",{status:e.error.code+": "+e.error.message}),h("failed",{})}function m(d,g){var i,l,m=a.JSON.parse(g.response||g.responseText).result,o=new Date,p={};l={errors:0,warnings:0},m.hasOwnProperty("downloadArchiveUrl")?i=m.downloadArchiveUrl:m.hasOwnProperty("attachInfoResult")&&m.attachInfoResult.length>0&&m.attachInfoResult[0].hasOwnProperty("downloadUrl")&&(i=m.attachInfoResult[0].downloadUrl),m&&m.attachInfoResult&&(p=a.Array.map(m.attachInfoResult,function(d,e){var f=c(d.errorString,d.virusFound?d.virusFound[0]:null);return f.error?(n.stat("download_success_error",{status:d.errorString}),window.yui.fire("stat:webservice_fail",{feature_group:"READ_ATTACH",message:f.code,visible:"yes",api:"VirusScanAttachments"})):(n.stat("download_success_success",{type:d.attachmentType+"/"+d.attachmentSubtype,size:Math.round(d.fileSize/1024)}),window.yui.fire("stat:feature_complete",{feature_group:"READ_ATTACH",message:"ATTACH_DOWNLOAD_SUCCESS"})),f.warning&&n.stat("download_success_warning",{status:d.errorString}),f.error?l.errors++:f.warning&&l.warnings++,a.merge(f,{aid:b[e].aid,fileName:d.fileName,downloadUrl:d.downloadUrl||""})}),a.mix(l,{attachments:p})),j&&i?(e(i,b.length,k),h("success",l),a.fire("util:ymstats",{name:"download-tray-v2-pre-success"}),n.stat("download_success",{count:m.attachInfoResult.length,time:o-t}),l.warnings>0&&n.stat("download_success_warnings",{count:m.attachInfoResult.length,status:l.warnings}),l.errors>0&&n.stat("download_success_errors",{count:m.attachInfoResult.length,status:l.errors})):(n.stat("download_success_nourl"),f(l,h))}var o,q=k&&k.appid,r=[window.location.protocol+"//",window.location.host,"/ws/mail/v2.0/jsonrpc?","appid="+(q||p||"YahooMailNeo"),"&m=VirusScanAttachments","&wssid="+NeoConfig.wssid,"&windowid="+NeoConfig.windowId,"&r="+(new Date).getTime()].join(""),s={method:"VirusScanAttachments",params:[{downloadInfo:b,archiveName:d(),archive:b.length>1?!0:!1}]},t=new Date;if(j=a.Lang.isUndefined(j)?!0:j,k)for(o in k)k.hasOwnProperty(o)&&"appid"!==o&&(r+="&"+o+"="+k[o]);a.Tictac.base.mailIO.send(r,{data:a.JSON.stringify(s),method:"POST",headers:{"Content-Type":"application/json"},on:{success:m,failure:l}}),window.yui.fire("stat:feature_invoke",{feature_group:"READ_ATTACH",message:"ATTACH_DOWNLOAD"})}function h(b){var c,d,e=a.JSON.parse(atob(b.data.replace(/_/g,"/").replace(/-/g,"+"))),f=e.error,g=a.Tictac.att.strings;c="EC-4999"===f.code&&f.validationErrors&&f.validationErrors.join("").indexOf("virus")>=0,d=c?g.str_tictac_att_download_virus_error:g.str_tictac_att_download_server_error,a.common.ui.NotificationV2.notify(d,{type:"error",close:!0,customClass:"single-inline"}),a.fire("util:ymstats",{name:"download-tray-v3-fail",type:c?"virus":"fetch"})}function i(b){var c,d,f,g=a.common.Utils.guid(),i=b[0],j=location.origin+"/neo/iframemsg?id="+g;d=window.setTimeout(function(){a.fire("util:ymstats",{name:"download-tray-v3-success"}),c&&c.detach()},q),c=a.on("iframe-message",function(a){g===a.id&&(clearTimeout(d),h(a))}),i.hasOwnProperty("downloadUrlV3")?(f=a.common.Utils.mergeQueryString(i.downloadUrlV3,{error:j}),e(f)):(clearTimeout(d),a.fire("util:ymstats",{name:"download-tray-v3-fail",type:"url-not-found"}))}function j(b,c,d,e){var f,g=b.get("attachments"),h=a.Tictac.att.attError;return"failed"===d?b.showError("tray:download_error",c.length):e.errors?b.showError("tray:download_error",e.errors):e.warnings&&b.showError("tray:download_cleaned",e.warnings),e.attachments?(a.Array.each(e.attachments,function(a){return g.get?(f=g.get(a.aid),void(a.failed&&a.code?f.updateProperty("error",h(a.code,a.extras)):f.hasError()&&f.updateProperty("error",{}))):!0}),!0):(a.Array.each(c,function(a){return g.get?(f=g.get(a.aid),void f.updateProperty("error",h("download:retry_network_error"))):!1}),!1)}function k(c,d,e){var f=b(d),h=a.common.Utils.features.enabled("UseDownloadUrlfrmGDM");a.fire("util:ymstats",{name:"download-tray-start"}),h&&1===d.length?(a.fire("util:ymstats",{name:"download-tray-v3-start"}),i(d)):(a.fire("util:ymstats",{name:"download-tray-v2-start"}),c.setStatus(f,"scanning"),g(d,function(a,b){c.clearStatus(f,"scanning"),j(c,d,a,b),e&&e()}))}function l(a,c,d,e,f){var h=b(c);a&&a.setStatus(h,"scanning"),g(c,function(b,e){return a?(a.clearStatus(h,"scanning"),void(f||void 0===f?j(a,c,b,e)?d&&d(b,e):a.showError("tray:download_error",c.length):d&&d(b,e))):void d(b,e)},!1,!1,e)}function m(a){a&&a.stat&&(n=a)}var n,o=a.common&&a.common.Utils,p=o&&o.settings&&o.settings.value("appid","YahooMailNeo")||"YahooMailNeo",q=2e4,r=a.Tictac.base.utils.verify;a.namespace("Tictac.att").downloader={download:k,getURLs:l,setStats:m,downloadAttachments:g}},"1.0.0",{requires:["array-extras","io","tictac-base-mail-io","node","tictac-att-strings","tictac-att-attachment-error","tictac-base-utils","mail-common-utils-settings","querystring-stringify-simple"]});YUI.add("tictac-attach-view",function(a){"use strict";function b(b,c,d){function e(a){return a.halt(),!1}var g=this;g.model=b,g.controller=c,g.rte=d.rte,g.stat=a.Tictac.attach.Controller.conf.stat,g.username=d.username?d.username:"The sender";var h=d.tray,i=d.rte.getDocRoot().ancestor(".inner");if(h)h.setAttribute("contentEditable","false");else if(j&&j.attachment_well){var k=j.attachment_well({});d.tray=h=a.Node.create(k)}i&&h&&i.append(h),g.tray=new a.Tictac.att.AttachmentTray({attachments:new a.Tictac.att.Collection,isCompose:!0,boundingBox:d.tray}),g.evtHandles=[g.tray.on("removeall",g.cmdRemoveAllAttachments,g),g.tray.on("norton",g.nortonClick,g),g.model.on("added",g.addAttachment,g),g.model.on("deleted",g.removeAttachment,g),g.model.on("updated",g.updateAttachment,g),g.model.on("failures",g.updateFailureText,g),g.model.on("emptied",g.updateAttachmentEmpty,g),g.model.after("quota",function(a){(a.violation.size||a.violation.count)&&g.onQuotaViolated(a.violation,a.isDialogHandled)}),g.tray.on("menu-item-selected",function(a){var b;a.attachment&&(b=a.attachment.getId(),"remove"===a.action?g.cmdRemoveAttachment(b):"download"===a.action?g.cmdDownloadAttachment(b):"save_dropbox"===a.action&&g.cmdSaveAttachmentToDropbox(b),"retry"===a.action&&a.attachment&&(this._attachmentMenu.allowSimClick(),g.cmdRetryAttachment(a.attachment.getId())))})];var l=0,m=[],n=d.tray;n&&(m.push(n.delegate("click",function(a){if(!a.target.ancestor(".tictac-att-thumb-save-options")){var b=new Date,c=b-l;c>1&&e(a),l=b}},".tictac-att-viewer")),m.push(n.delegate("key",function(a){13===a.keyCode&&a.shiftKey?e(a,!0):13===a.keyCode&&e(a)},"down:13",".tictac-att-thumb"))),d.dropbox&&f.hasTictacModule("tictac-dropbox")&&a.use("tictac-dropbox-cardhandler",function(a){g&&g.rte&&g.model&&g.username&&(g.cardHandler=new a.Tictac.dropbox.CardHandler(g.rte,g.model,g.username))})}function c(a){return a.isDropbox()?!1:e.filter(a)}function d(a,b){var c,d,e;a&&(a.setAttribute("tabindex",b),c=a.one("a.tictac-att-show-dd-icon"),d=a.one(".tictac-att-thumb-save-options"),e=a.one(".tictac-att-remove"),c&&c.setAttribute("tabindex",b),d&&d.setAttribute("tabindex",b),e&&e.setAttribute("tabindex",b))}var e=a.Tictac.att.filter,f=a.Tictac.base.utils,g=f.getVal,h=a.Tictac.attach.Utils.isSvrResponseWarning,i={ERROR_TITLE:"ERROR_TITLE",ERROR_SIZE:"ERROR_SIZE",ERROR_COUNT:"ERROR_COUNT",alert:function(){}},j=a.Tictac.attach.rollups,k=/[\w\W]+\.([^\.]+$)/;a.extend(b,a.Base,{updateFailureText:function(a){var b=this;return 0===a?void b.tray.hideError():void b.tray.showError(b.model.areAllWarningOrSuccess()?"tray:compose_warning":"tray:compose_error",a)},onQuotaViolated:function(a,b){var c,d=this;c=a.size?i.ERROR_SIZE:i.ERROR_COUNT,b||i.alert({hd:i.ERROR_TITLE,bd:c,restoreFocusNode:d.tray.get("boundingBox")}),d.model.delDownToQuota()},isDownloadable:function(a){return a.isUploadValid()&&!a.isDropbox()},addAttachment:function(b,d){var f,h=this,i=h.tray.get("boundingBox");if(!a.Tictac.att.filter.isInlineImage(b))return 0===h.model.count(c)?void h.tray.hide():void(c(b)&&(h.tray.show(),d&&!this._pendingScroll&&(this._pendingScroll=!0,setTimeout(function(){this._pendingScroll=!1,i.scrollIntoView()},0)),f=new a.Tictac.att["Attachment"+(b.hasProgress?"Progressbar":"Spinny")]({filename:b.filename,thumbnail:b.thumbnail,size:b.size}),f.setId(b.id),f.set("dropbox",b.dropbox?!0:!1),h.tray.addAttachment(f),b.isUploadDone()?(f.set("removable",!0),f.updateProperty("filetype",e.map(b.mimetype,b.filename.replace(k,"$1"),!1))):(f.updateProperty("cancelable",!0),f.activate(),h.tray.setStatus([b.id],"uploading")),h.isDownloadable(b)&&f.set("downloadable",!0),g(a,"Tictac.dropbox.controller")&&f.set("shareable",!0)))},updateAttachment:function(b){var d=this,e=d.tray.get("attachments"),f=e.get(b.id);f&&a.Lang.isNumber(b.size)&&f.update({size:b.size}),c(b)&&(b.hasProgress&&f.setProgress(b.progress),b.thumbnail&&f.updateProperty("thumbnail",b.thumbnail),f&&"success"===b.uploadState?d.successHandler(f,b):f&&"failed"===b.uploadState&&d.failureHandler(f,b))},successHandler:function(b,c){var f,g,i=this,j="compose:generic_warning",l=i.tray.get("boundingBox");switch(b.data.size=c.size,b.set("cancelable",!1),b.set("removable",!0),b.set("retryable",!1),b.updateProperty("error",{}),i.isDownloadable(c)&&b.set("downloadable",!0),c.reason){case"uploadAVNotScannable":j="compose:password_protection";break;case"uploadAVCleaned":j="compose:virus_cleaned"}b.updateProperty("error",h(c.reason)?a.Tictac.att.attError(j):{}),b.updateProperty("filetype",e.map(c.mimetype,c.filename.replace(k,"$1"))),b.deactivate(),i.tray.clearStatus([c.id],"uploading"),i.stat("view_upload_success"),f=l&&l.one('li[tabindex="0"]'),f&&d(f,-1),g=b.getNode(),g&&d(g,0)},failureHandler:function(b,c){var d=this,e="compose:generic_error";switch(c.reason){case"uploadAVCannotClean":case"uploadAVHasVirus":e="compose:virus_not_cleaned"}b.set("cancelable",!1),b.set("removable",!0),b.set("downloadable",!1),b.set("shareable",!1),a.UA.ie||b.set("retryable",!0),b.updateProperty("error",a.Tictac.att.attError(e)),b.deactivate(),d.tray.clearStatus([c.id],"uploading"),d.stat("view_upload_failure")},updateAttachmentEmpty:function(){this.tray.hide()},removeAttachment:function(a){var b,e,f,g,h=this,i=h.tray.get("boundingBox");c(a)&&(e=i.one("li[data-id="+a.id+"]"),b=e?e.previous("li")||e.next("li"):null,!b&&e&&(f=e.ancestor("div"),f.hasClass("tictac-att-thumb-cover")?(g=i.one(".tictac-att-files-cover"),b=g&&g.one("li")):f.hasClass("tictac-att-files-cover")&&(g=i.one(".tictac-att-thumb-cover"),b=g&&g.one("li:last-child"))),b&&d(b,0),h.tray.clearStatus([a.id],"uploading"),h.tray.removeAttachment(a.id))},cmdRemoveAllAttachments:function(){var a=this;a.controller.deleteAttachments(function(a){return!a.isDropbox()}),a.controller.saveDraft(),a.controller.trackClick("att_cmps_rmv")},cmdRemoveAttachment:function(a){var b=this;b.controller.trackClick("att_cmps_mnu_rmv"),b.controller.deleteAttachment(a),b.controller.saveDraft()},cmdRetryAttachment:function(a){this.controller.trackClick("att_cmps_mnu_rtry"),this.controller.retryAttachment(a)},cmdDownloadAttachment:function(b){var c=this,d=c.tray,e=a.Tictac.att.downloader;d.setStatus([b],"scanning"),c.controller.getDownloadInfo(b,function(a){a.aid=b,e.setStats({stat:c.stat}),e.download(d,[a])})},cmdSaveAttachmentToDropbox:function(b){var c=this,d=c.tray;c.controller.trackClick("att_save_to_dropbox"),c.stat("dropbox_saveto",{message:"compose"}),d.setStatus([b],"scanning"),c.controller.getDownloadInfo(b,function(e){e.aid=b,a.use("tictac-dropbox-controller",function(a){a.Tictac.dropbox.controller.saveTo(d,[e],{stat:c.stat})})})},nortonClick:function(){this.controller.trackClick("att_cmps_nrtn")},render:function(){this.tray.render()},cleanup:function(){var b=this;b.tray.destroy(),b.tray=null,b.controller=null,a.each(b.evtHandles,function(a){a.detach&&a.detach()}),delete b.evtHandles,b.cardHandler&&b.cardHandler.cleanup()}}),a.namespace("Tictac.attach").View=b,a.namespace("Tictac.attach.View").conf=i,a.namespace("tictac.attach").View=b,a.namespace("tictac.attach.View").conf=i},"1.0.0",{requires:["base-base","node","tictac-base-utils","tictac-attach-utils","tictac-att-attachment-tray","tictac-att-filter","tictac-att-attachment-compose","tictac-att-attachment-error","tictac-att-attachments","tictac-attach-rollups","tictac-att-downloader"]});YUI.add("tictac-attach-uploader-form",function(a){"use strict";function b(){return a.UA.ie?"IE"+a.UA.ie:a.UA.safari?"Safari"+a.UA.safari:a.UA.chrome?"Chrome"+a.UA.chrome:a.UA.gecko?"Firefox"+a.UA.gecko:"unknown"}function c(a){var b=this;if(!i.UPLOAD_URL_BASE)throw"You must configure UPLOAD_URL_BASE'";return b.type="FORM",b.selectFilesButton=a.selectFilesButton,b.instanceId=j++,b.fileMap={},b.fileCount=0,k[b.instanceId]=b,b.evtHandles=[],b}var d=['<form method="post" enctype="multipart/form-data" ','class="attachment-button-form"></form>'].join(""),e=['<input type="file" id="attachment-button-input" ','name="uploadfile" style="position: absolute; ',"top: 0; right: 0; z-index: 100; opacity: 0; ",'filter: alpha(opacity=0); display:block;">'].join(""),f=['<iframe id="FILE_ID" name="FILE_ID" ','style="display:none;"></iframe>'].join(""),g=["<script>window.onunload=function(){","parent.UploaderService.onIframeUpdate(",'"INSTANCE_ID", "FILE_ID");};',"</script>"].join(""),h=function(a,b){i.stat("form_tt_"+a,b)},i={IFRAME_USE_TIMEOUTS:!0,IFRAME_UPLOAD_TIMEOUT_MS:15e5,IFRAME_POLL_INTERVAL_MS:2e3,IFRAME_MAX_POLL_ATTEMPTS:15,REDIRECT_URL_BASE:document.location.protocol+"//"+document.location.host,UPLOAD_URL_BASE:"",BUILD_ID:0,stat:function(a,b){n("STAT: "+a+":"+b)},stopwatch:function(){n("STOPWATCH not conf'ed."),this.stop=function(){}}},j=0,k={},l=0,m=a.Tictac.base.utils,n=m.log,o=m.verify;window.UploaderService={onIframeUpdate:function(a,b){var c=k[a];c&&c.onIframeUpdate(b)},handlePostRedirectResponse:function(b){var c,d;b&&"?"===b.charAt(0)&&(b=b.substring(1)),d=a.QueryString.parse(b),n("postRedirectResponse parsed "+b,d),o(d.hasOwnProperty("instanceId")&&k[d.instanceId],"UploaderForm unmapped instanceId:"+d.instanceId),c=k[d.instanceId],c.onPostResponse(d)}},c.NAME="tictac-attach-uploader-form",a.mix(c.prototype,{cleanup:function(){var b=this;a.Array.each(b.evtHandles,function(a){a.detach()}),b.selectFilesButton.detachAll(),delete k[b.instanceId]},render:function(b){var c=a.Node.create(d),f=a.Node.create(e),g=this,h=g.evtHandles;b.append(c.append(g.selectFilesButton.append(f))),g.container=b,h=h.concat([f.on("change",g.onFileSelected,g),f.on("click",g.onAttachButtonClicked,g)])},simulateClick:function(){var a=this,b=a.container.one("#attachment-button-input");b._node.click()},startUpload:function(b){function c(){g.abandon(f,"Attachment_UploadNoResponse")}o(a.Lang.isArray(b.fileList)&&1===b.fileList.length,"startUpload got invalid evt.fileList");var d,e=b.currentTarget.ancestor("form"),f=b.fileList[0],g=this;g.fire("fileuploadstart",{file:f}),d=g.makeIframeId(f.id),f.iframe=g.injectIframe(f,d),e.set("target",d),e.set("action",g.makeUploadURL(f.id)),e._node.submit(),h("FormUploader",{message:"onFileSelect"}),f.stopwatch=new i.stopwatch("AttachmentUpload"),f.stopwatch.attType="form",i.IFRAME_USE_TIMEOUTS&&(f.timeout=setTimeout(c,i.IFRAME_UPLOAD_TIMEOUT_MS)),e._node.reset()},cancel:function(a){var b=this,c=b.fileMap[a];o(c,"uploaderForm can't cancel "+a),b.clearCallbacks(c),delete b.fileMap[c.id],c.iframe&&c.iframe.remove(!0),h("Attachment_UploadCancelled"),b.fire("uploadcancel",{file:c})}},!0),a.mix(c.prototype,{makeIframeId:function(a){return l+=1,a+"_"+l},onAttachButtonClicked:function(){this.fire("attachbuttonclick")},onFileSelected:function(a){var b=a.currentTarget,c={name:b.get("value")},d=this;c.name&&(c.id="FORM_FILE_"+d.fileCount,d.fileCount+=1,d.fileMap[c.id]=c,a.fileList=[c],d.fire("fileselect",a))},injectIframe:function(a,b){var c=this;o(c.container,"You forgot to call UploaderForm.render");var d=f.replace(/FILE_ID/g,b),e=c.container.appendChild(d),h=e._node,i=h.contentDocument||h.contentWindow.document;return i.open("text/html","replace"),i.write(g.replace("INSTANCE_ID",c.instanceId).replace("FILE_ID",a.id)),i.close(),e},onIframeUpdate:function(a){var b=this.fileMap[a];return b?(this.clearCallbacks(b),void(b.interval=setInterval(this.makeIframePoller(b),i.IFRAME_POLL_INTERVAL_MS))):void n("UploaderForm IframeLoad for unknown file")},clearCallbacks:function(a){a.timeout&&(clearTimeout(a.timeout),delete a.timeout),a.interval&&(clearInterval(a.interval),delete a.interval),a.evtIframeLoad&&(a.evtIframeLoad.detach(),delete a.evtIframeLoad)},makeIframePoller:function(c){function d(d){var e,g;try{e=d.pathname}catch(i){g="uploaderFormUploadServerHangUp_Error_"+i.message}return e?e:(g=g||"uploaderFormUploadServerHangUp",m+=1,m>2&&(f.abandon(c,g),h("AttachUploadIframeError",{message:a.UA.os+"-"+b()})),null)}function e(){var a=k&&k.location,b=d(a);return o+=1,o>=i.IFRAME_MAX_POLL_ATTEMPTS?void f.abandon(c,"Attachment_UploadTimeout"):b?-1!==b.indexOf("attach.php")?(n("UploaderForm iframe success for "+c.id),f.clearCallbacks(c),void(c.processed=!0)):void(a!==l&&-1===b.indexOf("ya/upload")&&f.abandon(c,"Attachment_UploadUnexpectedResponse")):void 0}var f=this,g=c.iframe._node,j=g.contentDocument||g.contentWindow.document,k=g.contentWindow||j,l=k.location,m=0,o=0;return e},abandon:function(a,b){var c=this;h("abandon",{message:b}),c.clearCallbacks(a),delete c.fileMap[a.id],a.iframe.remove(!0),c.fire("uploaderror",{file:a,reason:b})},makeUploadURL:function(a){var b,c=this;return b=[i.REDIRECT_URL_BASE,"/neo/php/attach.php?instanceId=",c.instanceId,"&bid=",i.BUILD_ID,"&fileId=",a].join(""),[i.UPLOAD_URL_BASE,"?resulturl=",encodeURIComponent(b)].join("")},onPostResponse:function(b){var c,d=this,e="uploadcomplete",f=a.Tictac.attach.Utils;o(b.fileId,"onPostResponse no file id"),n("onPostResponse",b),c=d.fileMap[b.fileId],c.iframe.remove(!0),delete d.fileMap[c.id],c.diskfilename=b.diskfilename,c.mimetype=b.mimetype,c.size=parseInt(b.filesize,10),e=f.isSvrResponseSuccess(b.errorcode)||f.isSvrResponseWarning(b.errorcode)?"uploadcomplete":"uploaderror",c.stopwatch&&(c.stopwatch.attSize=c.size,c.stopwatch.stop(),delete c.stopwatch),d.clearCallbacks(c),c.reason=b.errorcode,h("server_response",{message:c.reason}),d.fire(e,{file:c})}},!0),a.namespace("Tictac.attach").UploaderForm=c,a.namespace("Tictac.attach.UploaderForm").conf=i,a.namespace("tictac.attach").UploaderForm=c,a.namespace("tictac.attach.UploaderForm").conf=i,a.augment(c,a.EventTarget,!0,null,{prefix:"uploaderform"})},"1.0.0",{requires:["event-custom","querystring-parse-simple","tictac-base-utils","tictac-attach-utils"]});YUI.add("tictac-attach-controller",function(a){"use strict";function b(a){return parseInt(i(a,"size","0"),10)||0}function c(a,b,c,d){var e=this;e.uploader=a,e.model=b,e.switchUploaderType=c,e.composeView=d,e.getDownloadInfo=function(a,b){d.attGetDownloadInfo(a,b)},e.aidsByFids={},e.evtHandles=[],e.setUploader(a),d&&e.evtHandles.push(d.on("compose:getDisplayMessageResponse",function(a){a&&e._processGDM(a)}))}function d(b,c){var d;return a.Object.some(b.aidsByFids,function(a,b){return a===c?(d=b,!0):!1}),d}function e(a,b){return a.aidsByFids[b]}function f(a,b,c){return a.model.checkId(c)?!1:(j("aborting "+b+" on "+c),!0)}function g(a,b,c){function d(){b.thumbnail||a.model.set(b.id,"thumbnail",c),j(c)}var e=new Image;return e.src=c,e.complete?void d():(e.onload=d,void a.thumbnailRequests.push(e))}var h=a.Tictac.base.utils,i=h.getVal,j=h.log,k=h.verify,l=5,m=3e4,n=2e3,o={stat:function(){j("stat not conf'ed.")}},p=function(a,b){o.stat("controller_"+a,b)};c.prototype={setUploader:function(a){var b=this;b.uploader=a,b.evtHandles=b.evtHandles.concat([a.on("fileselect",b.fileselect,b),a.on("fileuploadstart",b.fileuploadstart,b),a.on("filedrop",b.filedrop,b),a.on("uploadprogress",b.uploadprogress,b),a.on("uploadcomplete",b.uploadcomplete,b),a.on("uploaderror",b.uploaderror,b),a.on("uploadcancel",b.uploadcancel,b),a.on("uploadfatalerror",b.uploadfatalerror,b),a.on("attachbuttonclick",b.attachButtonClick,b)]),b.thumbnailRequests=[]},uploadfatalerror:function(){var a=this;k("HTML5"===a.uploader.type,"controller only handles fatal errors for HTML5"),a.deleteAttachments(),a.switchUploaderType(!0),window.yui.fire("stat:feature_fail",{feature_group:"COMPOSE_ATTACH",message:"ATTACHCOMPUTER"})},attachButtonClick:function(){this.trackClick("cmps_attfl",{t1:"cmpsTb"})},startUpload:function(c,d,e){var f=this;a.Array.each(d,function(a){var c={filename:a.name,size:b(a),hasProgress:a.hasProgress};e?(c.dropbox={alf:!0},p("db_upload_start",{count:1,size:c.size}),window.yui.fire("stat:feature_invoke",{feature_group:"COMPOSE_ATTACH",message:"ATTACHDROPBOX"})):window.yui.fire("stat:feature_invoke",{feature_group:"COMPOSE_ATTACH",message:"ATTACHCOMPUTER"}),f.aidsByFids[a.id]=f.model.add(c,!0)}),f.model.commit(),f.uploader.startUpload(c,e)},fileselect:function(c){var d,f,g=this,h=g.model,k=c.fileList,l=0,m=0,n=i(a,"Tictac.dropbox.controller");return j("controller fileselect",k),l=a.Array.reduce(k,0,function(a,c){var d=b(c);return m=Math.max(m,d),a+d}),n&&n.dialogIfTooBig(m,k.length>1)?void 0:n&&!h.willFit(l)?(d=function(a){g.startUpload(c,k,a)},f=function(){a.Array.each(k,function(a){var b=e(g,a.id);b&&(g.deleteAttachment(b),j("deleted attachment "+b))})},void n.attachLargeFiles(k.length>1,h,g,d,f)):void(h.precheckQuota(k.length,l)||g.startUpload(c,k))},fileuploadstart:function(a){var b=a.file,c=this,d=e(c,b.id),g=c.model,h=g.get(d);f(c,"fileuploadstart",d)||(h.uploadStartTime||(h.uploadStartTime=(new Date).getTime()),c.model.setUploadState(d,{state:"started"}),j("controller fileuploadstart",b))},filedrop:function(a){this.trackClick("att_cmps_dnd_mlti",{ltxt:a.numberOfFiles})},uploadprogress:function(a){var b=a.file,c=this,d=e(c,b.id);f(c,"uploadprogress",d)||c.model.set(d,"progress",b.percentLoaded)},uploadcomplete:function(b){var c=b.file,d=this,g=d.model,i=e(d,c.id),k=g.get(i);if(k.isDropbox()?window.yui.fire("stat:feature_complete",{feature_group:"COMPOSE_ATTACH",message:"ATTACHDROPBOX_SUCCESS"}):window.yui.fire("stat:feature_complete",{feature_group:"COMPOSE_ATTACH",message:"ATTACHCOMPUTER_SUCCESS"}),!f(d,"uploadcomplete",i)){if(j("controller uploadcomplete",b),a.Lang.isNumber(c.size)){if("FORM"===d.uploader.type&&!g.willFit(c.size))return void d.handleFormSizeViolation(i);k.size=c.size}k.diskfilename=c.diskfilename,k.setMimeType(c.mimetype),k.retryCount>0&&p("controller_uploadretrysuccess"),k.isDropbox()&&c.dropboxLink&&(k.dropbox.link=c.dropboxLink,a.mix(k.dropbox,h.parseJSON(b.data)),p("db_upload_success",{count:1,size:c.size})),d.model.setUploadState(i,{state:"success",reason:c.reason}),!k.isDropbox()&&k.isImage()?d.updateThumbnailURLs():d.saveDraft()}},uploaderror:function(b){var c=b.file,d=this,f=e(d,c.id),g=d.model,h=g.get(f),i=d.uploader,k=(new Date).getTime()-h.uploadStartTime;return!h.isDropbox()&&b.transferFailed&&i.retryUpload&&(0===h.retryCount||m>k&&h.retryCount<l)?(h.retryCount++,void setTimeout(function(){i.retryUpload(c.id)},n)):(j("controller uploaderror",b),"HTML5"===i.type&&b.transferFailed&&p("uploaderror"),h.isDropbox()&&p("db_upload_failure",{count:1,size:c.size}),"FORM"===i.type&&"uploadFileSizeError"===c.reason?void d.handleFormSizeViolation(f):(a.Lang.isNumber(c.size)&&(h.size=c.size),g.setUploadState(f,{state:"failed",reason:c.reason}),void(h.isDropbox()?window.yui.fire("stat:webservice_fail",{feature_group:"COMPOSE_ATTACH",message:c.reason,visible:"yes",api:"DropboxAttachmentUpload"}):window.yui.fire("stat:webservice_fail",{feature_group:"COMPOSE_ATTACH",message:c.reason,visible:"yes",api:"AttachmentUpload"}))))},uploadcancel:function(a){var b=a.file,c=this,d=e(c,b.id);k(!c.model.checkId(d),"Unexpected uploadcancel: "+b.id),j("got uploadcancel")},cancelUploadsInProgress:function(){var b,c=this;a.Array.each(c.model.getAll(),function(a){b=d(c,a.id),b&&!a.isUploadDone()&&(j("cancelling upload: "+a.id+" (fid: "+b+")"),c.uploader.cancel(b),c.model.setUploadState(a.id,{state:"failed",reason:"cancelled"}))})},deleteAttachments:function(b){var c=this,d=0;return a.Array.each(this.model.getAll(!0),function(a){(!b||b(a))&&(c.deleteAttachment(a.id),d+=1)}),d},deleteAttachment:function(a){var b=this,c=this.model.get(a),e=d(b,a);b.model.del(a),e&&(c.isUploadDone()||b.uploader.cancel(e),delete b.aidsByFids[e])},retryAttachment:function(a){var b=this;"HTML5"===b.uploader.type&&(b.cancelUploadsInProgress(),b.switchUploaderType(!1)),b.deleteAttachment(a),b.uploader.simulateClick()},trackClick:function(){a.Tictac.attach.Utils.trackClick.apply(this,arguments)},cleanup:function(){var b=this;b.thumbnailTimer&&b.thumbnailTimer.cancel(),a.each(b.evtHandles,function(a){a.detach&&a.detach()}),delete b.evtHandles,a.each(b.thumbnailRequests,function(a){a.onload=null}),delete b.thumbnailRequests},handleFormSizeViolation:function(b){var c=this,e=c.model,f=i(a,"Tictac.dropbox.controller"),g=1,h=d(c,b);return delete c.aidsByFids[h],e.del(b),g+=c.deleteAttachments(function(a){return!a.isDropbox()&&!a.isUploadDone()}),f?void f.attachLargeFiles(g>1,e,c):void e.fireQuotaViolation({size:!0})},updateThumbnailURLs:function(){var b=this,c=3e3;if(!b.thumbnailTimer){if(b.awaitingGetMsgResponse)return void(b.thumbnailTimer=a.later(c,this,function(){b.thumbnailTimer=null,b.updateThumbnailURLs()}));b.awaitingGetMsgResponse=!0,b.saveDraft()}},saveDraft:function(){var a=this;a.composeView.attGetMsg(function(b){a._processGDM(b)},!0)},_processGDM:function(b){var c=this,d=b.attachments,e=c.model.getAll();c.awaitingGetMsgResponse=!1,b&&b.mid&&b.part&&(d&&a.Lang.isArray(d)&&a.Array.each(d,function(d){var f,h,i;for(f=0,h=e.length;h>f;f++)if(e[f].thumbnail&&d.thumbnailurl&&e[f].thumbnail===a.Lang.trim(d.thumbnailurl)||!e[f].thumbnail&&e[f].filename===a.Lang.trim(d.filename)&&e[f].size===d.size){i=e[f];break}i&&(d.thumbnailurl&&i.isUploadValid()&&!i.thumbnail&&g(c,i,d.thumbnailurl),i.original=i.original||{},i.original.mid=b.mid,i.original.partId=d.partId,i.original.fid="Draft",i.original.disposition=d.disposition,i.original.displayable=d.isDisplayable,i.original.tnef=d.tnefId||d.tnef)}),c.composeView&&c._updateInlineImages(b))},_updateInlineImages:function(b){var c,d,e,f,g,h,i=/http(s)?:\/\/[^\/ ]*\.yahoo\.com\/ya\/download\?[^\"\']*/g,j=/http(s)?:\/\/[^\/ ]*\.yahoo\.com\/ya\/download\?[^\"\']*/,k=this.composeView,l=[],m=[];if(b&&b.part&&k.cdo.get("isRichText")){for(c=NeoConfig.hasConv?k.baseNode:k.getRTEDocNode(),e=0,f=b.part.length;f>e;e++)if(b.part[e].text){d=b.part[e].text;break}if(d){for(g=i.exec(d);g;)l.push(g[0]),g=i.exec(d);h=c.all("img"),h.each(function(a){var b=a.get("src");j.test(b)&&m.push(a)}),m.length===l.length&&a.Array.each(m,function(a,b){a.set("src",l[b])})}}}},a.augment(c,a.EventTarget),a.namespace("Tictac.attach").Controller=c,a.namespace("Tictac.attach.Controller").conf=o,a.namespace("tictac.attach").Controller=c,a.namespace("tictac.attach.Controller").conf=o},"1.0.0",{requires:["tictac-attach-neo","tictac-attach-uploader-form","tictac-attach-model-attachments","tictac-attach-utils","tictac-base-stats","tictac-base-utils"]});/*
YUI 3.16.0 (build 3.16.0-ym17)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("file-html5",function(e,t){var n=e.Lang,r=e.bind,i=e.config.win,s=function(e){var t=null;s.isValidFile(e)?t=e:s.isValidFile(e.file)?t=e.file:t=!1,s.superclass.constructor.apply(this,arguments),t&&s.canUpload()&&(this.get("file")||this._set("file",t),this.get("name")||this._set("name",t.name||t.fileName),this.get("size")!=(t.size||t.fileSize)&&this._set("size",t.size||t.fileSize),this.get("type")||this._set("type",t.type),t.hasOwnProperty("lastModifiedDate")&&!this.get("dateModified")&&this._set("dateModified",t.lastModifiedDate))};e.extend(s,e.Base,{initializer:function(t){this.get("id")||this._set("id",e.guid("file"))},_uploadEventHandler:function(e){var t=this.get("xhr");switch(e.type){case"progress":this.fire("uploadprogress",{originEvent:e,bytesLoaded:e.loaded,bytesTotal:this.get("size"),percentLoaded:Math.min(100,Math.round(1e4*e.loaded/this.get("size"))/100)}),this._set("bytesUploaded",e.loaded);break;case"load":if(t.status>=200&&t.status<=299){this.fire("uploadcomplete",{originEvent:e,data:e.target.responseText});var n=t.upload,r=this.get("boundEventHandler");n.removeEventListener("progress",r),n.removeEventListener("error",r),n.removeEventListener("abort",r),t.removeEventListener("load",r),t.removeEventListener("error",r),t.removeEventListener("readystatechange",r),this._set("xhr",null)}else this.fire("uploaderror",{originEvent:e,data:t.responseText,status:t.status,statusText:t.statusText,source:"http"});break;case"error":this.fire("uploaderror",{originEvent:e,data:t.responseText,status:t.status,statusText:t.statusText,source:"io"});break;case"abort":this.fire("uploadcancel",{originEvent:e});break;case"readystatechange":this.fire("readystatechange",{readyState:e.target.readyState,originEvent:e})}},startUpload:function(t,n,i){this._set("bytesUploaded",0),this._set("xhr",new XMLHttpRequest),this._set("boundEventHandler",r(this._uploadEventHandler,this));var s=new FormData,o=i||"Filedata",u=this.get("xhr"),a=this.get("xhr").upload,f=this.get("boundEventHandler");e.each(n,function(e,t){s.append(t,e)}),s.append(o,this.get("file")),u.addEventListener("loadstart",f,!1),a.addEventListener("progress",f,!1),u.addEventListener("load",f,!1),u.addEventListener("error",f,!1),a.addEventListener("error",f,!1),a.addEventListener("abort",f,!1),u.addEventListener("abort",f,!1),u.addEventListener("loadend",f,!1),u.addEventListener("readystatechange",f,!1),u.open("POST",t,!0),u.withCredentials=this.get("xhrWithCredentials"),e.each(this.get("xhrHeaders"),function(e,t){u.setRequestHeader(t,e)}),u.send(s),this.fire("uploadstart",{xhr:u})},cancelUpload:function(){var e=this.get("xhr");e&&e.abort()}},{NAME:"file",TYPE:"html5",ATTRS:{id:{writeOnce:"initOnly",value:null},size:{writeOnce:"initOnly",value:0},name:{writeOnce:"initOnly",value:null},dateCreated:{writeOnce:"initOnly",value:null},dateModified:{writeOnce:"initOnly",value:null},bytesUploaded:{readOnly:!0,value:0},type:{writeOnce:"initOnly",value:null},file:{writeOnce:"initOnly",value:null},xhr:{readOnly:!0,value:null},xhrHeaders:{value:{}},xhrWithCredentials:{value:!0},boundEventHandler:{readOnly:!0,value:null}},isValidFile:function(e){return i&&i.File&&e instanceof File},canUpload:function(){return i&&i.FormData&&i.XMLHttpRequest}}),e.FileHTML5=s},"3.16.0",{requires:["base"]});
/*
YUI 3.16.0 (build 3.16.0-ym17)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("uploader-queue",function(e,t){var n=function(){this.queuedFiles=[],this.uploadRetries={},this.numberOfUploads=0,this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this.totalBytes=0,n.superclass.constructor.apply(this,arguments)};e.extend(n,e.Base,{_currentState:n.STOPPED,initializer:function(){},_uploadStartHandler:function(e){var t=e;t.file=e.target,t.originEvent=e,this.fire("uploadstart",t)},_uploadErrorHandler:function(e){var t=this.get("errorAction"),r=e,i,s;r.file=e.target,r.originEvent=e,this.numberOfUploads-=1,delete this.currentFiles[e.target.get("id")],this._detachFileEvents(e.target),e.target.cancelUpload(),t===n.STOP?this.pauseUpload():t===n.RESTART_ASAP?(i=e.target.get("id"),s=this.uploadRetries[i]||0,s<this.get("retryCount")&&(this.uploadRetries[i]=s+1,this.addToQueueTop(e.target)),this._startNextFile()):t===n.RESTART_AFTER&&(i=e.target.get("id"),s=this.uploadRetries[i]||0,s<this.get("retryCount")&&(this.uploadRetries[i]=s+1,this.addToQueueBottom(e.target)),this._startNextFile()),this.fire("uploaderror",r)},_startNextFile:function(){if(this.queuedFiles.length>0){var e=this.queuedFiles.shift(),t=e.get("id"),n=this.get("perFileParameters"),r=n.hasOwnProperty(t)?n[t]:n;this.currentUploadedByteValues[t]=0,e.on("uploadstart",this._uploadStartHandler,this),e.on("uploadprogress",this._uploadProgressHandler,this),e.on("uploadcomplete",this._uploadCompleteHandler,this),e.on("uploaderror",this._uploadErrorHandler,this),e.on("uploadcancel",this._uploadCancelHandler,this),e.set("xhrHeaders",this.get("uploadHeaders")),e.set("xhrWithCredentials",this.get("withCredentials")),e.startUpload(this.get("uploadURL"),r,this.get("fileFieldName")),this._registerUpload(e)}},_registerUpload:function(e){this.numberOfUploads+=1,this.currentFiles[e.get("id")]=e},_unregisterUpload:function(e){this.numberOfUploads>0&&(this.numberOfUploads-=1),delete this.currentFiles[e.get("id")],delete this.uploadRetries[e.get("id")],this._detachFileEvents(e)},_detachFileEvents:function(e){e.detach("uploadstart",this._uploadStartHandler),e.detach("uploadprogress",this._uploadProgressHandler),e.detach("uploadcomplete",this._uploadCompleteHandler),e.detach("uploaderror",this._uploadErrorHandler),e.detach("uploadcancel",this._uploadCancelHandler)},_uploadCompleteHandler:function(t){this._unregisterUpload(t.target),this.totalBytesUploaded+=t.target.get("size"),delete this.currentUploadedByteValues[t.target.get("id")],this.queuedFiles.length>0&&this._currentState===n.UPLOADING&&this._startNextFile();var r=t,i=this.totalBytesUploaded,s=Math.min(100,Math.round(1e4*i/this.totalBytes)/100);r.file=t.target,r.originEvent=t,e.each(this.currentUploadedByteValues,function(e){i+=e}),this.fire("totaluploadprogress",{bytesLoaded:i,bytesTotal:this.totalBytes,percentLoaded:s}),this.fire("uploadcomplete",r),this.queuedFiles.length===0&&this.numberOfUploads<=0&&(this.fire("alluploadscomplete"),this._currentState=n.STOPPED)},_uploadCancelHandler:function(e){var t=e;t.originEvent=e,t.file=e.target,this.fire("uploadcancel",t)},_uploadProgressHandler:function(t){this.currentUploadedByteValues[t.target.get("id")]=t.bytesLoaded;var n=t,r=this.totalBytesUploaded,i=Math.min(100,Math.round(1e4*r/this.totalBytes)/100);n.originEvent=t,n.file=t.target,this.fire("uploadprogress",n),e.each(this.currentUploadedByteValues,function(e){r+=e}),this.fire("totaluploadprogress",{bytesLoaded:r,bytesTotal:this.totalBytes,percentLoaded:i})},startUpload:function(){this.queuedFiles=this.get("fileList").slice(0),this.numberOfUploads=0,this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this._currentState=n.UPLOADING;while(this.numberOfUploads<this.get("simUploads")&&this.queuedFiles.length>0)this._startNextFile()},pauseUpload:function(){this._currentState=n.STOPPED},restartUpload:function(){this._currentState=n.UPLOADING;while(this.numberOfUploads<this.get("simUploads"))this._startNextFile()},forceReupload:function(e){var t=e.get("id");this.currentFiles.hasOwnProperty(t)&&(e.cancelUpload(),this._unregisterUpload(e),this.addToQueueTop(e),this._startNextFile())},addToQueueTop:function(e){this.queuedFiles.unshift(e)},addToQueueBottom:function(e){this.queuedFiles.push(e)},cancelUpload:function(e){var t,r,i;if(e){t=e.get("id");if(this.currentFiles[t])this.currentFiles[t].cancelUpload(),this._unregisterUpload(this.currentFiles[t]),this._currentState===n.UPLOADING&&this._startNextFile();else for(r=0,len=this.queuedFiles.length;r<len;r++)if(this.queuedFiles[r].get("id")===t){this.queuedFiles.splice(r,1);break}}else{for(i in this.currentFiles)this.currentFiles[i].cancelUpload(),this._unregisterUpload(this.currentFiles[i]);this.currentUploadedByteValues={},this.currentFiles={},this.totalBytesUploaded=0,this.fire("alluploadscancelled"),this._currentState=n.STOPPED}this.queuedFiles.length===0&&this.numberOfUploads<=0&&(this.fire("alluploadscomplete"),this._currentState=n.STOPPED)}},{CONTINUE:"continue",STOP:"stop",RESTART_ASAP:"restartasap",RESTART_AFTER:"restartafter",STOPPED:"stopped",UPLOADING:"uploading",NAME:"uploaderqueue",ATTRS:{simUploads:{value:2,validator:function(e){return e>=1&&e<=5}},errorAction:{value:"continue",validator:function(e){return e===n.CONTINUE||e===n.STOP||e===n.RESTART_ASAP||e===n.RESTART_AFTER}},bytesUploaded:{readOnly:!0,value:0},bytesTotal:{readOnly:!0,value:0},fileList:{value:[],lazyAdd:!1,setter:function(t){var n=t;return e.Array.each(n,function(e){this.totalBytes+=e.get("size")},this),t}},fileFieldName:{value:"Filedata"},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},perFileParameters:{value:{}},retryCount:{value:3}}}),e.namespace("Uploader"),e.Uploader.Queue=n},"3.16.0",{requires:["base"]});
/*
YUI 3.16.0 (build 3.16.0-ym17)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("uploader-html5",function(e,t){function i(){i.superclass.constructor.apply(this,arguments)}var n=e.Lang.sub,r=e.Uploader.Queue;e.UploaderHTML5=e.extend(i,e.Widget,{_fileInputField:null,_buttonBinding:null,queue:null,initializer:function(){this._fileInputField=null,this.queue=null,this._buttonBinding=null,this._fileList=[],this.publish("fileselect"),this.publish("uploadstart"),this.publish("fileuploadstart"),this.publish("uploadprogress"),this.publish("totaluploadprogress"),this.publish("uploadcomplete"),this.publish("alluploadscomplete"),this.publish("uploaderror"),this.publish("dragenter"),this.publish("dragover"),this.publish("dragleave"),this.publish("drop")},renderUI:function(){var t=this.get("contentBox"),n=this.get("selectFilesButton");n.setStyles({width:"100%",height:"100%"}),t.append(n),this._fileInputField=e.Node.create(i.HTML5FILEFIELD_TEMPLATE),t.append(this._fileInputField)},bindUI:function(){this._bindSelectButton(),this._setMultipleFiles(),this._setFileFilters(),this._bindDropArea(),this._triggerEnabled(),this.after("multipleFilesChange",this._setMultipleFiles,this),this.after("fileFiltersChange",this._setFileFilters,this),this.after("enabledChange",this._triggerEnabled,this),this.after("selectFilesButtonChange",this._bindSelectButton,this),this.after("dragAndDropAreaChange",this._bindDropArea,this),this.after("tabIndexChange",function(){this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},this),this._fileInputField.on("change",this._updateFileList,this),this._fileInputField.on("click",function(e){e.stopPropagation()},this),this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},_rebindFileField:function(){this._fileInputField.remove(!0),this._fileInputField=e.Node.create(i.HTML5FILEFIELD_TEMPLATE),this.get("contentBox").append(this._fileInputField),this._fileInputField.on("change",this._updateFileList,this),this._setMultipleFiles(),this._setFileFilters()},_bindDropArea:function(e){var t=e||{prevVal:null},n=this.get("dragAndDropArea");t.prevVal!==null&&(t.prevVal.detach("drop",this._ddEventHandler),t.prevVal.detach("dragenter",this._ddEventHandler),t.prevVal.detach("dragover",this._ddEventHandler),t.prevVal.detach("dragleave",this._ddEventHandler)),n!==null&&(n.on("drop",this._ddEventHandler,this),n.on("dragenter",this._ddEventHandler,this),n.on("dragover",this._ddEventHandler,this),n.on("dragleave",this._ddEventHandler,this))},_bindSelectButton:function(){this._buttonBinding=this.get("selectFilesButton").on("click",this.openFileSelectDialog,this)},_ddEventHandler:function(t){t.stopPropagation(),t.preventDefault();if(e.Array.indexOf(t._event.dataTransfer.types,"Files")>-1)switch(t.type){case"dragenter":this.fire("dragenter");break;case"dragover":this.fire("dragover");break;case"dragleave":this.fire("dragleave");break;case"drop":var n=t._event.dataTransfer.files,r=[],i=this.get("fileFilterFunction"),s;i?e.each(n,function(t){var n=new e.FileHTML5(t);i(n)&&r.push(n)}):e.each(n,function(t){r.push(new e.FileHTML5(t))}),r.length>0&&(s=this.get("fileList"),this.set("fileList",this.get("appendNewFiles")?s.concat(r):r),this.fire("fileselect",{fileList:r})),this.fire("drop",{fileList:r})}},_setButtonClass:function(e,t){t?this.get("selectFilesButton").addClass(this.get("buttonClassNames")[e]):this.get("selectFilesButton").removeClass(this.get("buttonClassNames")[e])},_setMultipleFiles:function(){this.get("multipleFiles")===!0?this._fileInputField.set("multiple","multiple"):this._fileInputField.set("multiple","")},_setFileFilters:function(){this.get("fileFilters").length>0?this._fileInputField.set("accept",this.get("fileFilters").join(",")):this._fileInputField.set("accept","")},_triggerEnabled:function(){this.get("enabled")&&this._buttonBinding===null?(this._bindSelectButton(),this._setButtonClass("disabled",!1),this.get("selectFilesButton").setAttribute("aria-disabled","false")):!this.get("enabled")&&this._buttonBinding&&(this._buttonBinding.detach(),this._buttonBinding=null,this._setButtonClass("disabled",!0),this.get("selectFilesButton").setAttribute("aria-disabled","true"))},_getFileList:function(){return this._fileList.concat()},_setFileList:function(e){return this._fileList=e.concat(),this._fileList.concat()},_updateFileList:function(t){var n=t.target.getDOMNode().files,r=[],i=this.get("fileFilterFunction"),s;i?e.each(n,function(t){var n=new e.FileHTML5(t);i(n)&&r.push(n)}):e.each(n,function(t){r.push(new e.FileHTML5(t))}),r.length>0&&(s=this.get("fileList"),this.set("fileList",this.get("appendNewFiles")?s.concat(r):r),this.fire("fileselect",{fileList:r})),this._rebindFileField()},_uploadEventHandler:function(e){switch(e.type){case"file:uploadstart":this.fire("fileuploadstart",e);break;case"file:uploadprogress":this.fire("uploadprogress",e);break;case"uploaderqueue:totaluploadprogress":this.fire("totaluploadprogress",e);break;case"file:uploadcomplete":this.fire("uploadcomplete",e);break;case"uploaderqueue:alluploadscomplete":this.queue=null,this.fire("alluploadscomplete",e);break;case"file:uploaderror":case"uploaderqueue:uploaderror":this.fire("uploaderror",e);break;case"file:uploadcancel":case"uploaderqueue:uploadcancel":this.fire("uploadcancel",e)}},openFileSelectDialog:function(){var e=this._fileInputField.getDOMNode();e.click&&e.click()},upload:function(t,n,r){var i=n||this.get("uploadURL"),s=r||this.get("postVarsPerFile"),o=t.get("id");s=s.hasOwnProperty(o)?s[o]:s,t instanceof e.FileHTML5&&(t.on("uploadstart",this._uploadEventHandler,this),t.on("uploadprogress",this._uploadEventHandler,this),t.on("uploadcomplete",this._uploadEventHandler,this),t.on("uploaderror",this._uploadEventHandler,this),t.on("uploadcancel",this._uploadEventHandler,this),t.startUpload(i,s,this.get("fileFieldName")))},uploadAll:function(e,t){this.uploadThese(this.get("fileList"),e,t)},uploadThese:function(t,n,i){if(!this.queue){var s=n||this.get("uploadURL"),o=i||this.get("postVarsPerFile");this.queue=new r({simUploads:this.get("simLimit"),errorAction:this.get("errorAction"
),fileFieldName:this.get("fileFieldName"),fileList:t,uploadURL:s,perFileParameters:o,retryCount:this.get("retryCount"),uploadHeaders:this.get("uploadHeaders"),withCredentials:this.get("withCredentials")}),this.queue.on("uploadstart",this._uploadEventHandler,this),this.queue.on("uploadprogress",this._uploadEventHandler,this),this.queue.on("totaluploadprogress",this._uploadEventHandler,this),this.queue.on("uploadcomplete",this._uploadEventHandler,this),this.queue.on("alluploadscomplete",this._uploadEventHandler,this),this.queue.on("uploadcancel",this._uploadEventHandler,this),this.queue.on("uploaderror",this._uploadEventHandler,this),this.queue.startUpload(),this.fire("uploadstart")}else this.queue._currentState===r.UPLOADING&&(this.queue.set("perFileParameters",this.get("postVarsPerFile")),e.each(t,function(e){this.queue.addToQueueBottom(e)},this))}},{HTML5FILEFIELD_TEMPLATE:"<input type='file' style='visibility:hidden; width:0px; height: 0px;'>",SELECT_FILES_BUTTON:'<button type="button" class="yui3-button" role="button" aria-label="{selectButtonLabel}" tabindex="{tabIndex}">{selectButtonLabel}</button>',TYPE:"html5",NAME:"uploader",ATTRS:{appendNewFiles:{value:!0},buttonClassNames:{value:{hover:"yui3-button-hover",active:"yui3-button-active",disabled:"yui3-button-disabled",focus:"yui3-button-selected"}},dragAndDropArea:{value:null,setter:function(t){return e.one(t)}},enabled:{value:!0},errorAction:{value:"continue",validator:function(e){return e===r.CONTINUE||e===r.STOP||e===r.RESTART_ASAP||e===r.RESTART_AFTER}},fileFilters:{value:[]},fileFilterFunction:{value:null},fileFieldName:{value:"Filedata"},fileList:{value:[],getter:"_getFileList",setter:"_setFileList"},multipleFiles:{value:!1},postVarsPerFile:{value:{}},selectButtonLabel:{value:"Select Files"},selectFilesButton:{valueFn:function(){return e.Node.create(n(e.UploaderHTML5.SELECT_FILES_BUTTON,{selectButtonLabel:this.get("selectButtonLabel"),tabIndex:this.get("tabIndex")}))}},simLimit:{value:2,validator:function(e){return e>=1&&e<=5}},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},retryCount:{value:3}}}),e.UploaderHTML5.Queue=r},"3.16.0",{requires:["widget","node-event-simulate","file-html5","uploader-queue"]});
YUI.add("tictac-attach-yuipatch",function(a){"use strict";a.Uploader.Queue.prototype.restartUpload=function(){for(this._currentState=a.Uploader.Queue.UPLOADING;this.numberOfUploads<this.get("simUploads")&&this.queuedFiles.length;)this._startNextFile()},a.FileHTML5.prototype._uploadEventHandler=function(a){var b=this.get("xhr");switch(a.type){case"progress":this.fire("uploadprogress",{originEvent:a,bytesLoaded:a.loaded,bytesTotal:this.get("size"),percentLoaded:Math.min(100,Math.round(1e4*a.loaded/this.get("size"))/100)}),this._set("bytesUploaded",a.loaded);break;case"load":if(b.status>=200&&b.status<=299){this.fire("uploadcomplete",{originEvent:a,data:a.target.responseText});var c=b.upload,d=this.get("boundEventHandler");c.removeEventListener("progress",d,!1),c.removeEventListener("error",d,!1),c.removeEventListener("abort",d,!1),b.removeEventListener("load",d,!1),b.removeEventListener("error",d,!1),b.removeEventListener("readystatechange",d,!1),this._set("xhr",null)}else this.fire("uploaderror",{originEvent:a,status:b.status,statusText:b.statusText,data:b.responseText,source:"http"});break;case"error":this.fire("uploaderror",{originEvent:a,status:b.status,statusText:b.statusText,source:"io"});break;case"abort":this.fire("uploadcancel",{originEvent:a});break;case"readystatechange":this.fire("readystatechange",{readyState:a.target.readyState,originEvent:a})}}},"1.0.0",{requires:["file-html5","uploader-queue"]});YUI.add("tictac-attach-customuploader-html5",function(a){"use strict";function b(){var c=this;b.superclass.constructor.apply(c,arguments),c.set("errorAction",a.Uploader.Queue.STOP)}b.NAME="tictac-attach-customuploader-html5",a.extend(b,a.UploaderHTML5,{cancelUpload:function(a){var b=this,c=b.queue;c.cancelUpload(a),c.queuedFiles.length||c.numberOfUploads||b.cleanUpQueue()},_uploadEventHandler:function(a){var c=this,d=this.queue;b.superclass._uploadEventHandler.apply(c,arguments),"uploaderqueue:uploaderror"!==a.type&&"file:uploaderror"!==a.type||d.queuedFiles.length||d.numberOfUploads||c.cleanUpQueue()},_ddEventHandler:function(c){var d=this,e=c._event.dataTransfer;"drop"===c.type&&a.Array.indexOf(e.types,"Files")>-1&&d.fire("customdrop",{numberOfFiles:e.files.length}),b.superclass._ddEventHandler.apply(d,arguments)},cleanUpQueue:function(){var a=this;a.queue.cancelUpload(),a.queue=null}}),a.namespace("Tictac.attach").CustomUploaderHTML5=b,a.namespace("tictac.attach").CustomUploaderHTML5=b},"1.0.0",{requires:["uploader-html5","tictac-attach-yuipatch"]});YUI.add("tictac-attach-strings",function(a){a.namespace("Tictac.attach").strings={str_attach_drag_here:"Drag and drop attachments here",str_attach_form_fallback_dialog_body:"We're having trouble attaching this file. Try attaching again.",str_attach_form_fallback_dialog_title:"Upload Error",str_attach_html5_attach_button:"Attach File [or Drag and Drop]",str_attach_opt_menu:"Attach from my computer",str_enhancr_card_preview_by:"Preview by {{img}}",str_enhancr_card_view_on:"View on {{link}}",str_link_preview_tutorial_subject:"Bringing Links to Life with Link Preview",last:null}},"1.0.0");YUI.add("tictac-attach-uploader-html5",function(a){"use strict";function b(a){var b;return window.DOMParser?b=(new window.DOMParser).parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)),b}function c(b){var c,d=this,e=a.Tictac.attach.strings;return a.mix(b,m.uploader,!0),c=new a.Tictac.attach.CustomUploaderHTML5(b),d.dropArea=b.dropArea,d.yuiImpl=c,d.type="HTML5",d.evtHandles=[],d.getCredRetry=0,d.credWaitTimer=null,d.dropArea.appendChild(a.Tictac.attach.rollups.dragdrop({drag_here:b.dragndropStr||e.str_attach_drag_here})),d.dropArea.setStyle("position","relative"),d.tictacDropAreaNode=d.dropArea.one(".tictac-attach-droparea"),d.tictacDropAreaNode.hide(),d.btnTooltip=b.btnTooltip||e.str_attach_html5_attach_button,c.set("uploadURL",m.UPLOAD_URL_BASE),c.set("dragAndDropArea",d.dropArea),d.evtHandles=d.evtHandles.concat([d.convert(c,"uploadcomplete",d.onUploadComplete),d.convert(c,"uploaderror",d.onUploadError),d.convert(c,"uploadprogress",d.onUploadProgress),d.dropArea.on(["dragenter","dragover"],d.onDragOverOrEnter,d),d.dropArea.on("drop",d.onDrop,d),c.on("customdrop",d.onCustomDrop,d),m.dropNode.on(["dragenter","dragover"],d.onDragOverOrEnter,d),d.convert(c,"fileselect",d.onRefire),d.convert(c,"fileuploadstart",d.onRefire),d.convert(c,"uploadcancel",d.onRefire),d.convert(c,"alluploadscomplete",d.onRefire),d.convert(c,"totaluploadprogress",d.onRefire),q.on("updateUploadURL",d.setCredential,d),q.on(["dragenter","dragover"],d.onDragOverOrEnter,d),q.on("drop",d.onDrop,d),c.get("selectFilesButton").on("click",function(a){a.halt(),a.target&&a.target.blur&&a.target.blur()})]),d.get=c.get,j(c.get("appendNewFiles"),"appendNewFiles has to be true or fileFromFid breaks"),m.UPLOAD_URL_BASE&&m.LAUNCH_PROTOCOL?void d.fetchCredential():void i("uploaderHtml5: only external svc uploads will work since UPLOAD_URL_BASE and LAUNCH_PROTOCOL not configured.")}function d(a){return a.id=a.get("id"),a.name=a.get("name"),a.hasProgress=!0,a.size=a.get("size"),a}function e(b){return b.fileList?b.fileList=a.Array.map(b.fileList,function(a){return new d(a)}):b.file&&(b.file=new d(b.file)),b}var f,g,h=a.Tictac.base.utils,i=h.log,j=h.verify,k=h.getVal,l=a.Tictac.attach.Neo.neoConfig,m={UPLOAD_URL_BASE:"",LAUNCH_PROTOCOL:"",dropNode:a.one("body"),rteContainer:a.one("body"),stat:function(){i("stat not conf'ed.")},stopwatch:function(){i("STOPWATCH not conf'ed."),this.stop=function(){}},simpleRelogin:function(){i("relogin!")},uploader:{multipleFiles:!0,simLimit:1}},n=10,o=1e3,p=n*o,q={},r=function(a,b){m.stat("html5_tt_"+a,b)};a.augment(q,a.EventTarget),c.NAME="tictac-attach-uploader-html5",c.isBrowserCapable=function(){return a.UA.chrome>=8||a.UA.gecko>=4||a.UA.safari>=536.25||a.UA.ie>=10},a.mix(c.prototype,{convert:function(a,b,c){var d=this;return a.on(b,function(a){c.call(d,new e(a),b)})},render:function(){var a,b=this;b.yuiImpl.render.apply(b.yuiImpl,arguments),a=b.yuiImpl.get("selectFilesButton"),a.setStyles({width:"",height:""}),a.setAttribute("title",b.btnTooltip),b.evtHandles.push(a.on("click",b.onAttachButtonClicked,b))},cleanup:function(){var b=this;a.Array.each(b.evtHandles,function(a){a.detach()}),b.evtHandles=null,b.yuiImpl.destroy(),b.yuiImpl=null},doUpload:function(b){var c=this,d=b.fileList,e=c.yuiImpl.get("postVarsPerFile");a.Array.each(d,function(a){e[a.get("id")]={filename:a.get("name"),filesize:a.get("size")}}),c.yuiImpl.get("uploadURL")===m.UPLOAD_URL_BASE&&r("no_cred",{message:l.neoguid}),i("uploadThese on ",d),r("onFileSelect"),c.yuiImpl.uploadThese(d,c.yuiImpl.get("uploadURL"),e)},doExternalUpload:function(b,c){var d,e=this,f=b.fileList,g=e.yuiImpl;g.queue=null,a.Array.each(f,function(a){d=a.startUpload,a.startUpload=function(b,e,f){c.configureUpload(a,function(e){b=e.url||b,f=e.fileFieldName||"file",a.set("xhrWithCredentials",e.xhrWithCredentials||!1),a.set("uploadSvc",c),d.call(a,b,e.postVars,f)})}}),i("doExternalUpload on ",f),g.uploadThese(f)},startUpload:function(a,b){var c=this;if(b)return void c.doExternalUpload(a,b);if(f){if((new Date).getTime()-g<6e5)return void c.doUpload(a);f=null,c.fetchCredential()}c.evtHandles.push(c.once("credentialSetSuccessful",c.doUpload,c,a)),c.credWaitTimer||(c.credWaitTimer=setTimeout(function(){c.getCredRetry=n,c.fire("uploadfatalerror")},p))},retryUpload:function(b){var c=this,d=c.yuiImpl.queue,e=c.fileFromId(b);r("retry",{message:l.neoguid}),d?(d.addToQueueTop(e),d._currentState=a.Uploader.Queue.UPLOADING,d._startNextFile()):c.yuiImpl.uploadThese([e])},cancel:function(b){var c,d=this,e=d.yuiImpl,f=e.queue;if(f)if(b){c=d.fileFromId(b);try{f.cancelUpload(c),r("Attachment_UploadCancelled")}catch(g){}}else a.Array.each(this.yuiImpl.get("fileList"),function(a){d.cancel(a)})},simulateClick:function(){var a=this,b=a.yuiImpl.get("selectFilesButton");b._node.click()}},!0),a.mix(c.prototype,{setCredVal:function(a){f=a,g=(new Date).getTime()},setCredential:function(){var a=[m.UPLOAD_URL_BASE,"&",f].join("");this.yuiImpl.set("uploadURL",a),this.yuiImpl.queue&&this.yuiImpl.queue.set("uploadURL",a)},fetchCredential:function(){function b(a,b){if(d.yuiImpl){if(b=b.response||b.responseText,f=h.parseJSON(b),f=k(f,"Response.cred"),!f)return r("CredentialSetFailedCallback",{message:l.neoguid}),r("CredFetchSuccessData",{message:(b+"").substr(0,27)}),void(d.getCredRetry<n&&setTimeout(function(){d.fetchCredential(),d.getCredRetry++},o));clearTimeout(d.credWaitTimer),d.credWaitTimer=null,d.setCredential(),d.fire("credentialSetSuccessful"),g=(new Date).getTime(),r("CredentialSetSuccessful",{message:l.neoguid}),d.getCredRetry&&r("CredentialSetSuccessful_retry"),d.getCredRetry=0}}function c(b,c){d.yuiImpl&&(r("CredentialSetFailed",{message:c.status+"_"+c.statusText+"_"+l.neoguid}),d.getCredRetry>=n||setTimeout(function(){302===c.status?(a.once("net:reloginSuccessful",function(){d.fetchCredential()}),m.simpleRelogin()):d.fetchCredential(),d.getCredRetry++},o))}var d=this,e=[m.LAUNCH_PROTOCOL,document.location.host,"/ya/upload_get_cred?r=",(new Date).getTime().toString(36)].join("");return f?void d.setCredential():void a.io(e,{on:{success:b,failure:c}})},fileFromId:function(b){var c=a.Array.find(this.yuiImpl.get("fileList"),function(a){return a.id===b});return j(c,"No file found with id: "+b),c},onAttachButtonClicked:function(){this.fire("attachbuttonclick")},onCustomDrop:function(a){this.fire("filedrop",a)},onDrop:function(){var a=this;a.tictacDropAreaNode&&a.tictacDropAreaNode.hide()},onDragOverOrEnter:function(b){var c=this,d=b._event.dataTransfer,e=c.tictacDropAreaNode;return!(-1!==a.Array.indexOf(d.types,"Files")||d.types.contains&&d.types.contains("application/x-moz-file")),e&&(e.show(),c.dropAreaTimer&&(clearTimeout(c.dropAreaTimer),c.dropAreaTimer=null),c.dropAreaTimer=setTimeout(function(){e.hide()},100)),!0},fileToSvc:function(b){var c=this,d=a.Tictac.attach.Utils,e=b.get("uploadSvc");return e?e:{parseServerResponse:c.parseServerResponse,isSvrResponseSuccess:d.isSvrResponseSuccess,isSvrResponseWarning:d.isSvrResponseWarning}},onUploadComplete:function(a){var b=this,c=a.file,d=b.fileToSvc(c);d.parseServerResponse(c,a.data),d.isSvrResponseSuccess(c.reason)||d.isSvrResponseWarning(c.reason)?a.type="uploadcomplete":a.type="uploaderror",i("uploaderHTML5 firing uploadcomplete: "+c.reason),r("success",{message:c.reason}),b.fire(a.type,a)},onUploadError:function(a){var b,c,d=this,e=a.file,f=this.yuiImpl,g=f.queue,h=d.fileToSvc(e);h.parseServerResponse(e,a.data),a.transferFailed=!0,g.queuedFiles.length&&g.restartUpload(),"io"===a.source?r("failure_uploaderror_io",{message:l.neoguid}):(c=(a.data+"").match(/<Error>([0-9A-Za-z]*?)<\/Error>/),b=c?c[1]:"parseerror_"+a.status+"_"+a.statusText,r("failure",{messsage:b})),e.get("isDropbox")&&r("db_upload_try_failure"),e.fire("uploaderror",a)},onUploadProgress:function(a){a.file.percentLoaded=a.percentLoaded,this.fire("uploadprogress",a)},onRefire:function(a,b){b||(b=a.type.substring(a.type.indexOf(":")+1)),this.fire(b,a)},parseServerResponse:function(c,d){var e,f;return c.reason="unknown",e=b(d),d=e.firstChild,d.getElementsByTagName||(d=e.childNodes[1]),(f=d.getElementsByTagName("attachment")[0])?void a.Array.each(f.childNodes,function(a){var b,d,e={id:"diskfilename",type:"mimetype",name:"name",size:"size",code:"reason"};b=a.nodeName,d=a.text||a.textContent,e[b]&&(c[e[b]]=d,"size"===b&&(c.size=parseInt(c.size,10)))}):(c.reason=d.getElementsByTagName("Error")[0],void(c.reason&&(c.reason=c.reason.text)))}}),a.augment(c,a.EventTarget,!0,null,{prefix:"Uploaderhtml5"}),a.namespace("Tictac.attach").UploaderHTML5=c,a.Tictac.attach.UploaderHTML5.conf=m,a.namespace("tictac.attach").UploaderHTML5=c,a.namespace("tictac.attach.UploaderHTML5").conf=m},"1.0.0",{requires:["array-extras","event-custom","io","tictac-attach-customuploader-html5","tictac-attach-neo","tictac-attach-rollups","tictac-attach-strings","tictac-attach-utils","tictac-base-utils"]});YUI.add("tictac-attach-main",function(a){"use strict";function b(){return NeoConfig.autolinkEnabled}function c(a){var b=this,c=b.getPreferredUploaderClassName(),d=function(){b.switchUploaderType.apply(b,arguments)};return b.evtHandles=[],j(f.UploaderHTML5.conf,f.Stats.makeStatConf()),j(f.UploaderForm.conf,f.Stats.makeStatConf()),j(f.Controller.conf,f.Stats.makeStatConf()),b.btnNode=a.attach,b.btnContainer=a.attachContainer,b.dropArea=a.dropArea,b.btnAttachCloud=b.configDropbox(a.dropbox),a.flickr&&(b.btnAttachFlickr=b.configFlickr(a.flickr,a.rte,a.username)),b.model=new f.model.Attachments,b.uploader=b.createUploader(c),b.controller=new f.Controller(b.uploader,b.model,d,a.composeView),b.view=new f.View(b.model,b.controller,a),b.uploader.render(a.attachContainer),b.view.render(),b.stat=f.Controller.conf.stat,b.attachMenuSelector=a.attachMenuSelector,b.btnAttachOption=b.configAttachOpt(a.attachOption),a.composeView&&b.evtHandles.push(a.composeView.on("compose:saveSuccess",function(a){a.mid&&b.model.updateMid(a.mid)})),b.configAutolink(a),b}var d,e,f=a.Tictac.attach,g=a.Tictac.base.utils,h=g.getVal,i=f.strings,j=f.Utils.configure,k=!1,l=g.log;c.prototype={configAutolink:function(a){var c,d=this,e={};b()&&(d._rte=a.rte,d._rte.plug(f.enhancr.AutolinkPlugin),c=a.composeView.cdo.get("origin"),d._rte.after("isRichChange",function(a){d._rte.rte.autolink.set("linkingEnabled",a.newVal)}),d._rte.rte.autolink.set("linkingEnabled",d._rte.get("isRich")),d.evtHandles.push(a.composeView.on("renderComplete",function(){d._rte.rte.fire("renderComplete"),d.onRenderComplete()}),a.composeView.cdo.on("sending",function(){d.onMessageSent(a.composeView.cdo.get("origin"))})),e.isNew=!c.action,e.isDraft="Draft"===c.fid,e.isReply=!(e.isNew||e.isDraft),d._rte.rte.on("cardAdded",function(){a.composeView._setDirty()}),d._rte.rte.set("toolbarNode",a.composeView.baseNode.one(".bottomToolbar")),d._rte.plug(f.enhancr.CardPlugin,e),d.evtHandles.push(a.composeView.on("closeChange",function(){d._rte.rte.cards.destroySpinner()})))},onMessageSent:function(b){var c=["reply_sender","reply_all","forward"];this.hadCardsInOriginal&&-1!==a.Array.indexOf(c,b.action)&&this.stat("enhancr_fwd_or_reply",{message:b.action})},onRenderComplete:function(){var a=this,b=this._rte.rte.frame.get("container"),c="div[class*='link-enhancr-attachment'][id*='enhancrCard_']";a.hadCardsInOriginal=!!b.one(c)},configDropbox:function(b){var c,e=this;return b&&g.hasTictacModule("tictac-dropbox")&&a.use("tictac-dropbox-controller",function(a){c=b.one("a").on("click",function(){a.Tictac.dropbox.controller.attachFrom(e.model)}),e.evtHandles.push(c),d=h(a,"Tictac.dropbox.strings"),b.one("a").set("text",d.str_share_from_db),c=a.on("compose:dropbox:chooser",function(){a.Tictac.dropbox.controller.attachFrom(e.model)}),e.evtHandles.push(c),a.fire("compose:dropbox:ready")}),b},configFlickr:function(b,c,d){var f,i=this;return b&&g.hasTictacModule("tictac-flickr-controller")&&a.use("tictac-flickr-controller",function(a){f=b.one("a").on("click",function(){a.Tictac.flickr.Controller.shareFrom(c,d)}),i.evtHandles.push(f),e=h(a,"Tictac.flickr.strings"),b.one("a").set("text",e.str_share_from_flickr)}),b},configAttachOpt:function(b){var c,d,e,f=this;return b&&(c=b.one("a").once("click",function(){e=a.one(f.attachMenuSelector),d=e.on("menuSelected",function(){f.uploader.simulateClick()}),f.evtHandles.push(d)}),f.evtHandles.push(c),b.one("a").set("text",i.str_attach_opt_menu)),b},cleanup:function(){var b=this;b.btnNode.remove(!0),b.btnContainer.remove(!0),b.uploader.cleanup(),b.controller.cleanup(),b.view.cleanup(),b.model.cleanup(),a.each(b.evtHandles,function(a){a.detach&&a.detach()})},getPreferredUploaderClassName:function(){var a=f.UploaderHTML5.isBrowserCapable();return!k&&a?"HTML5":"Form"},createUploader:function(a){return new f["Uploader"+a]({dropArea:this.dropArea,selectFilesButton:this.btnNode.cloneNode(!0)})},switchUploaderType:function(a){function b(){l("switching uploader type to "+d),c.uploader.cleanup(),c.btnContainer.all("*").each(function(a){a.remove(!0)}),"Form"===d&&(c.forceFormUploader=!0),c.uploader=c.createUploader(d),c.controller.setUploader(c.uploader),c.uploader.render(c.btnContainer),c.stat("ToggleFormActivated")}var c=this,d="HTML5"===c.uploader.type?"Form":"HTML5";return a?f.Neo.alert(i.str_attach_form_fallback_dialog_title,i.str_attach_form_fallback_dialog_body,b):b()}},j(f.UploaderHTML5.conf,f.Neo.makeHTML5UploaderConf()),a.namespace("Tictac.attach").AttachmentComposer=c,a.namespace("tictac.attach").AttachmentComposer=c,a.augment(c,a.EventTarget,!0,null,{prefix:"attachmentcomposer"})},"1.0.0",{requires:["event-custom","tictac-att-filter","tictac-attach-enhancr-autolink","tictac-attach-enhancr-card","tictac-attach-neo","tictac-attach-stats","tictac-attach-model-attachments","tictac-attach-view","tictac-attach-controller","tictac-attach-uploader-form","tictac-attach-uploader-html5","tictac-attach-strings","tictac-attach-utils","tictac-base-utils","tictac-base-mailpreferences"]});YUI.add("mail-ui-composeview-compose-loader",function(e){var t=function(e){this.context=e.context||{},this.workspace=e.workspace||null,this.is_tab_deactive=e.force||!1,this.tabs=e.tabs||null,this.strings=e.strings||{},this.openAsDraft=e.openAsDraft||!1,this.composeDeps=["_shared_module_toolbar_compose","_shared_module_compose_message_header_fresh","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_color_picker","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_offscreen_bin_compose_menu_spell_langs","_shared_module_compose_reply","mail-ui-authorview-v3"]};t.prototype.addModule=function(e){this.composeDeps.push(e)},t.prototype.removeModule=function(e){var t=this.composeDeps.indexOf(e);t>-1&&this.composeDeps.splice(t,1)},t.prototype.load=function(){var t=this,n=new e.common.Utils.Stopwatch("Compose","start"),r=[].concat(t.composeDeps);t.stopwatch=n,e.fire("Y.mail.ui.Workspace:composeMessage:start"),t.prefetch_message(),r.push(e.bind(this.show_compose,t)),e.fire("load-load-address-book-contacts"),n.start(1,"moduleLoad"),e.use.apply(e,r)},t.prototype.prefetch_message=function(){var t=this,n=this.context.draf;if(n&&!n.get("passive")){var r=t.context.oMsg,i=t.context.fid,s=new e.mail.Services.MessageService({stopwatch:t.stopwatch,cacheKey:"ComposeOrigin"});s.get(r.mid,i)}},t.prototype.show_compose=function(){var t=this,n,r=t.strings.str_tabs_compose_fresh,i=t.context.action,s=t.context.widget,o=t.stopwatch;o.start(1,"initView"),window.UploaderService=window.UploaderService||e.mail.UploaderService;if(t.canSwitchToComposeview(t.context))return;n=new e.mail.ui.AuthorViewConv,o.action=i,t.context.stopwatch=o,t.context&&t.context.calCompose&&(t.context.cbfn=function(t,n){e.use("mail-services-calservice",function(e){e.Mail.Services.calService.setCalDraft(t,n)})}),n.initCompose(t.context,t.openAsDraft),t.context.oMsg&&t.context.oMsg.header&&(r=e.common.Utils.escapeHtml(e.common.Utils.unescapeHtml(t.context.oMsg.header.subject))),n.set("title",r);if(s)t.prepare_tab_for_compose(n,s,i);else{var u=t.composify_tab(n);if(!u)return}n.bindComposeView(),e.common.Utils.log({m:"composeView bound to the tab with which it is housed"}),t.show_compose_end(n)},t.prototype.prepare_tab_for_compose=function(t,n,r){var i=this,s=n&&n.msgPane,o=n.tab||i.tabs.getActiveTab(),u=r==="reply_all"||r==="reply_sender"||r==="forward",a=!i.context.hasMsgList&&u&&s&&NeoConfig.send_confirm_nav_enabled;if(a){var f=i.context.oMsg&&i.context.oMsg.header&&i.context.oMsg.header.subject;t.backToMessageTab=function(r){var i=function(){f?o.set("title",f):o.set("title",null),o.set("canDeactivate",-1),o.once("widgetChange",function(t){o.set("canDeactivate",1),e.fire("bindContentWidget",{cw:t.newVal,tab:o})}),t.after("closeChange",function(){o.set("widget",n)}),o.removeChild(t)};r==="next"||r==="prev"?e.use("mail-ui-messagelist-base","mail-ui-messagepane-next-prev",function(){s&&s.stepMail(r,i,0,0,1)}):i()}}o.set("title",t.get("title")),o.once("widgetChange",function(t){t.prevVal.after("closeChange",function(e){e.newVal&&o.removeChild(t.prevVal)}),t.newVal.after("closeChange",function(e){e.newVal&&o.set("close",1)}),e.fire("bindContentWidget",{cw:t.newVal,tab:o})}),o.set("hideToolbar",!0),o.set("widget",t)},t.prototype.composify_tab=function(e){var t=this,n=t.stopwatch,r,i=t.workspace.addContentWidget({s_label:e.get("title"),widget:e,forcePane:!1,noToolbar:!0,sync:!0,isRemovable:!0,noScroll:t.context.noScroll});return i?(i.detach("closeHalted"),i.on("closeHalted",function(e){e.halt(!0)}),r=e.view,r.once("renderComplete",function(){n.stop()}),!0):!1},t.prototype.show_compose_end=function(t){var n=this;e.fire("Y.mail.ui.Workspace:composeMessage:complete"),n.context.callFromLaunch&&!NeoConfig.noDarla&&e.common.Utils.loadDarlaAndExecute(function(e){e.fire("darlaEvent",{action:NeoConfig.low_bandwidth?"launch_compose_low":NeoConfig.isSSL?"launch_compose_ssl":"launch_compose"})},!1),t.on("closeChange",function(){e.fire("Nav:ComposeClosed")})},t.prototype.create_conv_compose_view=function(t,n,r,i,s){var o=new e.mail.Controller.ComposeController(r,s,t,i,n);return o.bindComposeView(),o},t.prototype.canSwitchToComposeview=function(t){var n=e.mail.Tabs,r=function(e){return e.type==="author"&&e.view&&e.view.draft&&e.view.draft.mid===t.oMsg.mid},i;if(t.oMsg){i=n.getTab(r);if(i)return n.switchToTab(i),!0}return!1},window.sessionStorage!==undefined&&sessionStorage.setItem("MTTC",Math.round(Neo.performance.now())),NeoGV.composeLoaderReady=Date.now(),e.namespace("mail.ui.Compose").ComposeLoader=t,e.fire("mail-ui-composeview-compose-loader:loaded")},"1.0.0",{requires:["mail-platform","common-utils","common-utils-stats","mail-services-message-service","tictac-attach-main"]});
YUI.add("common-ui-lozengeDD",function(B){B.namespace("common.ui");var H=B.common.Utils;var F=function(J){var K=this;K.inputUl=null;K.insertBefore=null;K.dummyElement=null;K.targetNode=null;K.selectMultipleLozenges=false;K.composeView=J.composeView,K.composeHeader=J.composeView.baseNode.one(".compose-header");K.firstMove=true;K.allInputBoxes=K.composeHeader.all("div div.ac-input");K.clonedLozenge=null;K.wasHighlighted=false;K.dd=new B.mail.DD({start:K.start,end:K.end,move:K.move,scope:K,node:K.composeHeader,dragSelector:J.dragSelector});H.setSelect(this.composeHeader,false);};var A=function(K){this.init(K);var J=this.getTargetNode(K);if(J){K.dd.proxy.setXY([-100,-100]);this.dummyElement.setStyle("opacity",0);}};var D=function(N){var O=this,M=O.getTargetNode(N),K=N.dd.proxy,J;var L=function(R,P){var Q=O.insertBefore;if(K.inRegion(P)){O.inputUl=P.one("ul");O.allInputBoxes.removeClass("focus");P.addClass("focus");Q=null;J=O.inputUl.all("li");J.each(function(S){if(O.clonedLozenge.inRegion(S)){if(!Q){Q=S;}}});if(!Q){Q=J.item(J.size()-1);}Q.insert(O.dummyElement,Q);}else{if(P.hasClass("focus")){P.removeClass("focus");O.inputUl=null;}}O.insertBefore=Q;};if(K){if(O.firstMove){O.firstMove=false;M.setStyle("display","none");O.composeHeader.all(".hLozenge").each(function(P){P.removeClass("focus");});}K.setStyle("top",N.pageY);K.setStyle("left",N.pageX);K.setXY([N.pageX,N.pageY]);if(K.inRegion(O.composeHeader)){O.allInputBoxes.each(function(P){L(N,P);});}}};var E=function(L){var M=this,K=this.getTargetNode(L),J=M.insertBefore;if(K){L.dd.proxy.remove().destroy(true);if(M.inputUl&&J){K.remove();M.inputUl.get("parentNode").removeClass("focus");if(!this.selectMultipleLozenges){J.insert(K,J);}else{K.each(function(N){J.insert(N,J);N.removeClass("focus");});}M.composeView.dirty=true;}else{if(this.wasHighlighted){K.addClass("focus");}}M.dummyElement.remove().destroy(true);M.dummyElement=null;K.setStyle("display","inline-block");K.removeAttribute("style");L.dd.proxy=null;M.targetNode=null;M.selectedLozenges=false;M.firstMove=true;M.insertBefore=null;L.notDragging=false;M.wasHighlighted=false;M.selectMultipleLozenges=false;}};var C=function(){return this.targetNode||null;};var I=function(L){var P=this,K,J=0,O;var N=function(){M(L);if(P.targetNode){var Q=P.targetNode.cloneNode(true);Q.replaceClass("hLozenge","dd-hLozengeBox");Q.one("input").remove();L.dd.proxy=B.Node.create('<div style="position:absolute"></div>');L.dd.proxy.appendChild(Q);P.clonedLozenge=Q;P.dummyElement=P.targetNode.cloneNode(true);}};var M=function(R){var S,Q=R.target;S=(B.Node.getDOMNode(Q)).nodeName;if(S==="LI"&&Q.hasClass("hLozenge")){P.targetNode=Q;}else{P.targetNode=Q.ancestor("li.hLozenge");}return P.targetNode;};K=L.target.ancestor("ul");if(!K){P.targetNode=null;}else{if(L.target.hasClass("lozenge-edit")){P.targetNode=null;L.notDragging=true;}else{if(K.one("li.focus")){O=M(L);P.targetNode=K.all("li.focus");J=P.targetNode.size();if(J===1||!O.hasClass("focus")){if(O.hasClass("focus")){P.wasHighlighted=true;}N();}else{P.wasHighlighted=true;L.dd.proxy=B.Node.create('<div style="z-index: 999" class="contactDragProxy"><span></span><b class="counter">'+J+"</b></div>");P.clonedLozenge=L.dd.proxy;if(!P.dummyElement){P.dummyElement=P.targetNode.item(0).cloneNode(true);}P.selectMultipleLozenges=true;}}else{N();}}}if(L.dd.proxy){B.one("body").append(L.dd.proxy);}};var G=function(){this.dd.destroy();};F.prototype={destroy:G,start:A,end:E,move:D,getTargetNode:C,init:I};B.common.ui.lozengeDD=F;},"1.0.0",{requires:["common-ui-dd","common-utils"]});